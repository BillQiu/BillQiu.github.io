[{"title":"Prettier your project","url":"http://billqiu.github.io/2019/04/22/prettier/","content":"<h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><blockquote>\n<p>Prettier is an opinionated code formatter.</p>\n</blockquote>\n<p>从官网的介绍中我们可以看到，首先 Prettier 的定位是一个<strong>代码格式化</strong>工具，并且比较任性（opinionated）。它移除了<strong>几乎所有[1]</strong>原始格式，来确保所有输出的代码符合一致。</p>\n<p>就最初的设计目标来说，Prettier 面向的范围主要还是 Web 端的一些开发语言，如：</p>\n<ul>\n<li><a href=\"https://facebook.github.io/jsx/\" target=\"_blank\" rel=\"noopener\">JSX</a> </li>\n<li>CSS, <a href=\"http://lesscss.org/\" target=\"_blank\" rel=\"noopener\">Less</a> , and <a href=\"http://sass-lang.com/\" target=\"_blank\" rel=\"noopener\">SCSS</a> </li>\n<li><a href=\"http://graphql.org/\" target=\"_blank\" rel=\"noopener\">GraphQL</a> </li>\n<li>等…<br>不过作为一款代码格式化工具，Prettier 通过开放了插件（Beta）的能力，来对不同语言提供支持。</li>\n</ul>\n<h2 id=\"为什么要用\"><a href=\"#为什么要用\" class=\"headerlink\" title=\"为什么要用\"></a>为什么要用</h2><p>对于代码风格的圣战，没有一天真正停止过：</p>\n<ul>\n<li>Tab V.S. space</li>\n<li>single V.S. double quote</li>\n<li>Semicolons</li>\n<li>…<br>就个人角度来说，这些争论有意义吗？我觉得是有的，因为不仅体现了一个程序员对细节的追求，还锻炼了探索、深挖、求真的能力。但是就团队的角度来说，我觉得这些争论是没有意义的，个人代码的风格大相径庭，从 ESlint 的规则数量就可以明显地看出这一点。如果从个人代码风格的角度出发，制定一套适用于团队层面的规范，讨论到最后，很难有一个统一的结果。<br>所以，为了统一团队代码风格，确实需要任性（opinionated），才能真正落地。</li>\n</ul>\n<h3 id=\"对新人友好\"><a href=\"#对新人友好\" class=\"headerlink\" title=\"对新人友好\"></a>对新人友好</h3><p>当有新人进入一个团队时，他不仅需要熟悉业务流程，兼顾遗留代码，如果在开发时还被一系列的<strong>格式化</strong>代码规则磕磕绊绊，是非常不友好的一件事。而通过配置 Prettier，按下一个按键就可以直接将代码格式化，不需要为了适配各种规则手动修改，能将更多精力放在代码质量层面。</p>\n<h3 id=\"易于适应\"><a href=\"#易于适应\" class=\"headerlink\" title=\"易于适应\"></a>易于适应</h3><p>除了一些非常有争议的风格作为配置项，Prettier 内置的规则经过了多次修改讨论，对于大多数开发者来说，是比较容易接受的。</p>\n<h3 id=\"关于未来\"><a href=\"#关于未来\" class=\"headerlink\" title=\"关于未来\"></a>关于未来</h3><p>我们引入一个新工具，肯定希望它是稳步上升的，如果用到一半就被废弃，后续的解耦成本就会成为一个新的问题。<br>所以一个工具的未来如何一个非常重要的考量点：</p>\n<ul>\n<li>作为一个 Facebook 出品的工具，其雄厚的技术实力肯定是我们不容小觑的。</li>\n<li>在 GitHub 上的 star 数，是老大哥 ESlint 的三倍之多，说明关注这个项目的人非常多。</li>\n<li>再看项目的更新进度，基本每 1 - 2 天就会有新的提交，这个迭代速度说明更新以及问题解决的响应非常快。</li>\n<li>还有 npm 上的下载量，达到了 400 万次 / 周，说明真正在使用的人也非常多。<br>从以上种种看出，这个项目的未来是充满光明的。</li>\n</ul>\n<h2 id=\"与-Eslint\"><a href=\"#与-Eslint\" class=\"headerlink\" title=\"与 Eslint\"></a>与 Eslint</h2><h3 id=\"比较\"><a href=\"#比较\" class=\"headerlink\" title=\"比较\"></a>比较</h3><p>每当提到 Prettier，ESlint 一定是一个绕不过去坎。甚至有人觉得两者是冲突的，是包含与被包含的关系。但是在我看来，他们只是存在某些功能上的重合，硬要从这个角度来说，顶多也是存在交集的关系。</p>\n<p>要搞清楚两者的关系，可以先从定义上解读它们之间的区别：</p>\n<ul>\n<li>Prettier 的定位是一个代码格式化工具（code formatter），其侧重点在于格式化（format），其目的是让你的代码变得更好看（prettier），可读（readable）。</li>\n<li>ESlint 的定位一个校验工具（linting utility），其侧重点在于校验，其目的是让代码更一致和避免 bug。<blockquote>\n<p>ESLint is a tool for identifying and reporting on patterns found in ECMAScript/JavaScript code, with the goal of making code more consistent and avoiding bugs.</p>\n</blockquote>\n</li>\n</ul>\n<p>简单来看，它们相同的地方主要有以下几点：</p>\n<ol>\n<li>都期望能够减少甚至避免产生 bug。</li>\n<li>都期望统一代码风格。</li>\n<li>都具备格式化代码的功能。</li>\n</ol>\n<h4 id=\"统一代码风格\"><a href=\"#统一代码风格\" class=\"headerlink\" title=\"统一代码风格\"></a>统一代码风格</h4><p>ESlint 规则成千上万，主要可以分为两大类：</p>\n<ol>\n<li>格式化代码规则（Formatting rules）：如  <a href=\"http://eslint.org/docs/rules/max-len\" target=\"_blank\" rel=\"noopener\">max-len</a> , <a href=\"http://eslint.org/docs/rules/no-mixed-spaces-and-tabs\" target=\"_blank\" rel=\"noopener\">no-mixed-spaces-and-tabs</a> , <a href=\"http://eslint.org/docs/rules/keyword-spacing\" target=\"_blank\" rel=\"noopener\">keyword-spacing</a> , <a href=\"http://eslint.org/docs/rules/comma-style\" target=\"_blank\" rel=\"noopener\">comma-style</a> …</li>\n<li>代码质量规则（Code-quality rules）：如  <a href=\"http://eslint.org/docs/rules/no-unused-vars\" target=\"_blank\" rel=\"noopener\">no-unused-vars</a> , <a href=\"http://eslint.org/docs/rules/no-extra-bind\" target=\"_blank\" rel=\"noopener\">no-extra-bind</a> , <a href=\"http://eslint.org/docs/rules/no-implicit-globals\" target=\"_blank\" rel=\"noopener\">no-implicit-globals</a> , <a href=\"http://eslint.org/docs/rules/prefer-promise-reject-errors\" target=\"_blank\" rel=\"noopener\">prefer-promise-reject-errors</a> …</li>\n</ol>\n<p>理想情况下，如果 ESlint 规则设置的足够细致，基本能保证两个不同的开发者——采用相同的技术方案——在代码风格上 90% 的一致性。<br>但是对于 Prettier 来说，它工作的领域仅限于第一类——格式化代码，也就是说即使存在严重影响代码质量（Code-quality）的问题——比如<a href=\"https://eslint.org/docs/rules/for-direction\" target=\"_blank\" rel=\"noopener\">死循环</a>——Prettier 不会做出任何反应。原因将会在下文中做出（Rationale）说明。</p>\n<h4 id=\"格式化代码\"><a href=\"#格式化代码\" class=\"headerlink\" title=\"格式化代码\"></a>格式化代码</h4><p>ESlint 本身是一个代码校验工具，但是也提供了格式化代码的功能，通过添加 <code>--fix</code> 参数，可以将代码格式成符合自定义规则的样子。<br>Prettier 作为专业的格式化工具，内部自建了一套关于代码风格的规则，且这些规则无法被修改，除了暴露出的 19 个的配置项。这么做的目的，就是为了停止对各种个性化风格优劣的争论，从而将讨论的重点转移到这 19 个配置项中。</p>\n<h3 id=\"集成\"><a href=\"#集成\" class=\"headerlink\" title=\"集成\"></a>集成</h3><p>在我们的日常开发过程中，已经习惯了使用 ESlint 来保障代码质量与统一风格。如果再加上 Prettier 作为代码格式化的工具，就可以起到如虎添翼的效果。但是因为 Prettier 内建的规则可能和 ESlint 的规则产生冲突，所以需要通过配置插件来解决这些问题。</p>\n<ul>\n<li>Eslint 检验自定义规则的同时，还能支持 Prettier 的规则；</li>\n<li>我们希望 Prettier 格式化后的代码是符合 Eslint 规则的，但是因为 Prettier 内建规则是无法修改的，所以当两种的规则冲突时，需要以 Prettier 的规则为主。</li>\n</ul>\n<p>通过下面的步骤可以达到上述条件所描述的：</p>\n<ol>\n<li><p>安装依赖</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yarn add --dev eslint-config-prettier eslint-plugin-prettier</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>修改 ESlint 配置</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// .eslintrc.json</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"extends\"</span>: [<span class=\"string\">\"plugin:prettier/recommended\"</span>]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>如果在项目中使用 Prettier，我们当然不希望每次都要手动去执行格式化的命令，通过定制 <code>pre-commit</code> 钩子，可以达到自动格式化的效果，详见<a href=\"https://prettier.io/docs/en/precommit.html\" target=\"_blank\" rel=\"noopener\">文档</a>。<br>我个人最常用的是 <code>pretty-quick</code>，开箱即用。配置好后，每次将文件提交到 git 暂存区（stage）之前，都会自动对所有文件做格式化。这样一来，只要开发者按照规范 [2] 的流程走，就避免了代码格式不一致问题。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yarn add pretty-quick husky --dev</span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// package.json</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"husky\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"hooks\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"pre-commit\"</span>: <span class=\"string\">\"pretty-quick --staged\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>除了通过使用 git hooks 的方式来格式化代码，也可以在编写代码的过程中，直接对其进行格式化。以 VSCode 为例：</p>\n<ol>\n<li>需要安装  <a href=\"https://github.com/prettier/prettier-vscode\" target=\"_blank\" rel=\"noopener\">prettier-vscode</a> 插件。</li>\n<li>自定义格式化配置<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"editor.formatOnSave\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"editor.formatOnType\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"editor.formatOnPaste\"</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>这一步也可以通过 <a href=\"https://marketplace.visualstudio.com/items?itemName=tombonnike.vscode-status-bar-format-toggle\" target=\"_blank\" rel=\"noopener\">Formatting Toggle</a> 插件来实现。</p>\n<h2 id=\"设计原则\"><a href=\"#设计原则\" class=\"headerlink\" title=\"设计原则\"></a>设计原则</h2><h3 id=\"正确性（Correctness）\"><a href=\"#正确性（Correctness）\" class=\"headerlink\" title=\"正确性（Correctness）\"></a>正确性（Correctness）</h3><p>第一原则。作为一个代码格式化工具，如果想要让别人用的放心，在保证格式化代码后不会出现 bug 的同时，也必不能对原代码做任何入侵。这就是上文中提到的，即使出现了 bug，Prettier 也不会做出反应，<strong>仅</strong>关注如何更好地代码的原因。<code>eslint --fix</code> 则不同，它会去格式化那些违反规则的代码：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">return</span> <span class=\"string\">''</span> + value;</span><br><span class=\"line\"><span class=\"comment\">// after eslint --fix</span></span><br><span class=\"line\"><span class=\"keyword\">return</span> <span class=\"string\">`<span class=\"subst\">$&#123;value&#125;</span>`</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123; <span class=\"attr\">color</span>: color &#125; </span><br><span class=\"line\"><span class=\"comment\">// after eslint --fix</span></span><br><span class=\"line\">&#123; color &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> a = &#123;&#125;</span><br><span class=\"line\"><span class=\"comment\">// after eslint --fix</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> a = &#123;&#125;</span><br></pre></td></tr></table></figure></p>\n<p>保证正确性的另一个方面，就是能够提前预知格式化后可能会产生的 bug。看下面一个例子：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// semi.js</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (shouldAddLines) &#123;</span><br><span class=\"line\">  [<span class=\"number\">-1</span>, <span class=\"number\">1</span>].forEach(<span class=\"function\"><span class=\"params\">delta</span> =&gt;</span> addLine(delta * <span class=\"number\">20</span>))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>通过 <code>prettier semi.js --no-semi</code>命令对上述代码格式化，最后得到的结果是这样的：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (shouldAddLines) &#123;</span><br><span class=\"line\">  ;[<span class=\"number\">-1</span>, <span class=\"number\">1</span>].forEach(<span class=\"function\"><span class=\"params\">delta</span> =&gt;</span> addLine(delta * <span class=\"number\">20</span>))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>看上去似乎不符合规则，其实这么做事为了避免下述情况：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"keyword\">if</span> (shouldAddLines) &#123;</span><br><span class=\"line\">+  <span class=\"built_in\">console</span>.log(<span class=\"string\">'Do we even get here??'</span>)</span><br><span class=\"line\">   [<span class=\"number\">-1</span>, <span class=\"number\">1</span>].forEach(<span class=\"function\"><span class=\"params\">delta</span> =&gt;</span> addLine(delta * <span class=\"number\">20</span>))</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// after fomate </span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (shouldAddLines) &#123;</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">'Do we even get here??'</span>)[<span class=\"number\">-1</span>, <span class=\"number\">1</span>].forEach(<span class=\"function\"><span class=\"params\">delta</span> =&gt;</span> addLine(delta * <span class=\"number\">20</span>))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>通过上面的例子，说明了 Prettier 并非通过一刀切的方式对代码进行格式化，还会考虑格式化后的代码，在具体的应用场景中会如何。</p>\n<h3 id=\"易读性\"><a href=\"#易读性\" class=\"headerlink\" title=\"易读性\"></a>易读性</h3><p>在我们日常开发的过程中，经常会遇到一些涉及性能的问题。解法很多，但是我一般会选择更加容易让人看懂的那种。也就是说在一般情况下，为了代码的可维护性是可以牺牲一部分性能的。<br><strong>格式化代码不是目的，目的是为了让代码更加易读</strong>。可以通过以下几个列子看出 Prettier 是如何遵守这一规则的：</p>\n<ol>\n<li>多行对象<br>对象的书写方式一般由以下两种：短对象可以写在一行里，而一些长对象或者类 CSS 对象我们习惯多行书写。<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// single-line</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> user = &#123; <span class=\"attr\">name</span>: <span class=\"string\">\"John Doe\"</span>, <span class=\"attr\">age</span>: <span class=\"number\">18</span> &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// multi-line</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> css = &#123;</span><br><span class=\"line\">\tfontSize: <span class=\"number\">12</span>,</span><br><span class=\"line\">\tcolor: <span class=\"string\">\"red\"</span>,</span><br><span class=\"line\">\tpadding: <span class=\"number\">100</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>但是如果仅仅通过长短来格式化，就无法针对不同类型的对象做格式化处理，Prettier 也考虑到了这一点，可以通过下面的方式来自己选想要的格式化结果。<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// before</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> use = &#123; <span class=\"attr\">name</span>: <span class=\"string\">\"John Doe\"</span>,</span><br><span class=\"line\">\tage: <span class=\"number\">18</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">// after</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> user = &#123; <span class=\"attr\">name</span>: <span class=\"string\">\"John Doe\"</span>, <span class=\"attr\">age</span>: <span class=\"number\">18</span> &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ---</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// before</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> use = &#123;</span><br><span class=\"line\">\tname: <span class=\"string\">\"John Doe\"</span>,</span><br><span class=\"line\">\tage: <span class=\"number\">18</span> &#125;;</span><br><span class=\"line\"><span class=\"comment\">// after</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> user = &#123;</span><br><span class=\"line\">  name: <span class=\"string\">\"John Doe\"</span>,</span><br><span class=\"line\">  age: <span class=\"number\">18</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure></p>\n<ol start=\"2\">\n<li><p>测试方法<br>在一些测试方法中，可能必有比较长的描述说明，导致长度（Print Width）超过了既定值。但是 Prettier 并不会去做强制换行处理，因为这样做是没有意义的，只会降低可读性。</p>\n</li>\n<li><p>易加难减<br>到目前位置，Prettier 的配置规则仅仅只有 19 条，虽然添加一个规则不是什么难事，但是如果要将规则删除，就存在很大的问题了。你可以试想下如果将来某一天 Prettier 的一条规则被删除了，会发生什么？以 <a href=\"https://prettier.io/docs/en/options.html#bracket-spacing\" target=\"_blank\" rel=\"noopener\">bracket-spacing</a>为例：<br>在删除之前，无论我的配置是 true or false，格式化话后的对象都是遵循一定规则的：</p>\n<ul>\n<li><code>true</code>   - Example: <code>{ foo: bar }</code>.</li>\n<li><code>false</code> - Example: <code>{foo: bar}</code>.<br>但是如果规则被删除，不复存在了，你的代码中可能会存在 <code>{foo: bar, }</code> 这样的结果，这是大家都不愿意看到的。就拿 PR 来说，我在代码比对的过程中看到的这个属于格式上的不统一，在我引入了 Prettier 之后，这个问题理应是不会存在的，渐渐大家就会失去对这个工具的信任。</li>\n</ul>\n</li>\n</ol>\n<p>为什么要举 bracket-spacing 这个例子哪，因为这是一个<a href=\"https://github.com/prettier/prettier/issues/715#issuecomment-281096495\" target=\"_blank\" rel=\"noopener\">连 Prettier 的作者也不知道为什么会存在的配置规则</a>，但是它现在依旧存在着。</p>\n<h2 id=\"尾声\"><a href=\"#尾声\" class=\"headerlink\" title=\"尾声\"></a>尾声</h2><p>最后，借用我偶像 Dan 对 Prettier 的一段<a href=\"https://github.com/prettier/prettier/issues/40\" target=\"_blank\" rel=\"noopener\">描述</a>来结尾：</p>\n<blockquote>\n<p>I just wanted to take a moment to say there are some of us who actually appreciate tools with limited scope that don’t attempt to solve everybody’s use case, and instead do a specific thing well.</p>\n</blockquote>\n<h2 id=\"说明\"><a href=\"#说明\" class=\"headerlink\" title=\"说明\"></a>说明</h2><ul>\n<li>[1]  不格式化的某些情况下的 empty lines 以及 multi-line object</li>\n</ul>\n<ul>\n<li>[2] 之所以强调规范一词，是因为笔者曾经遇到过，有开发者因为代码校验无法通过，通过直接删除 node_modules，使 git 钩子无效化的方式强制推送代码。</li>\n</ul>\n","categories":[],"tags":["prettier","web","code-format"]},{"title":"AntD 圣诞节彩蛋事件","url":"http://billqiu.github.io/2018/12/25/christmas-egg/","content":"<p><em>此文仅代表个人立场，利益不相关。</em></p>\n<h2 id=\"回顾\"><a href=\"#回顾\" class=\"headerlink\" title=\"回顾\"></a>回顾</h2><p>今早一到公司，就发现群里有人说 antd 组件的样式变了，所有的<code>Button</code>组件都被加上了雪花，接着就看到 GitHub 上的 <a href=\"https://github.com/ant-design/ant-design/issues/13098\" target=\"_blank\" rel=\"noopener\">issue</a>，几乎所有前端相关的群都在讨论这件事。<br>而 antd 的维护者<a href=\"https://github.com/afc163\" target=\"_blank\" rel=\"noopener\">偏右</a>似乎还没有意识到这件事的严重性，竟然做了以下回复：</p>\n<blockquote>\n<p>早就做好了被骂的准备。<br>这么一来，国人开发者一下子全炸锅了，直接把 GitHub 变成了百度贴吧。不乏一些段子手为了博取人们的眼球，哗众取宠地说道自己的工作都丢了，还有人直接上升到人格的层面进行人身攻击。<br>在中午11点左右，官方发布了新版移除了彩蛋。<br>后续偏右<a href=\"https://zhuanlan.zhihu.com/p/53214213\" target=\"_blank\" rel=\"noopener\">发文</a>告知这一行为完全是自己的原因，承认了错误。玉伯也<a href=\"https://www.zhihu.com/question/306858501/answer/559312342\" target=\"_blank\" rel=\"noopener\">发文</a>表明了这一行为确实欠妥。<br>可网络喷子和段子手直到现在依旧看热闹不嫌事大，在 <a href=\"https://github.com/ant-design/ant-design/commit/d648b822a6b2789a783c7ad685a122466f6c083c#comments\" target=\"_blank\" rel=\"noopener\">commit</a>里还要冷嘲热讽，甚至扬言要把作者开除。</p>\n</blockquote>\n<h2 id=\"直抒胸臆\"><a href=\"#直抒胸臆\" class=\"headerlink\" title=\"直抒胸臆\"></a>直抒胸臆</h2><p>直到目前为止——除了官方——蚂蚁的同学基本都没有发声，应该是内部统一了口径，不许对这件事发表言论，防止事态扩大。作为一个局外人，我倒是有很多想说的。特别是对那些无脑的喷子，拿来用的的时候<em>真香</em>，遇到组件库 BUG 的时候求人家解决还描述不清楚问题所在。最后看热闹不嫌事大，抓着人家一个错误不肯放手。</p>\n<p>我不想说 antd 团队对国内的 react 技术栈发展做了多大的贡献，有多少人是因为组件库而选择了 react 技术栈，你们会说我贡献大就可以“乱搞”了吗；<br>我不想说 antd 的设计理念让中后台界面好用了多少倍，提升了多少效率，你们会说好看能当饭吃；<br>我不想说 antd API 的设计，让前端工程师学到会了如何设计一个优雅的，渐进的接口，你们会说文档还不是照样看不懂；<br>antd 背后的 <a href=\"https://github.com/benjycui/bisheng\" target=\"_blank\" rel=\"noopener\">bisheng</a>， <a href=\"https://github.com/ant-design/babel-plugin-import\" target=\"_blank\" rel=\"noopener\">babel-plugin-import</a>，代码组织方式等等，反正说了你们也不会懂。</p>\n<p>之前我也遇到过类似的事，和一帮啥也不会的第三方公司合作开发项目，就因为我在 commit 里写了个 F**K，就把我投诉了，我的第一反应是这 TM 你也管，有这时间怎么不好好学学代码怎么写，两层对象怎么解析。但是后来还是乖乖地改了，深究确实是我的问题。</p>\n<p>最后，想说一句 AntD 团队虽然有错，但是绝不应该承受如此骂名和诋毁！</p>\n","categories":[],"tags":["react","antd","personal"]},{"title":"react 中的浅比较","url":"http://billqiu.github.io/2018/12/11/shallow-equal/","content":"<p>浅比较（shadow comparison）是 react 中经常会提到的一个概念，比如我们使用<code>PureComponent</code>时，组件通过改变<code>shouldComponentUpdate</code>生命周期，自动检测<code>props</code>和 state 是否发生变化来决定是否重渲染。在这个过程中，对<code>props</code>和<code>state</code>就执行了浅相对（shallowEqual）判断。</p>\n<p>重点在于如何理解“浅”字，通过阅读<a href=\"https://github.com/facebook/fbjs/blob/master/packages/fbjs/src/core/shallowEqual.js#L39-L67\" target=\"_blank\" rel=\"noopener\">源码</a>可以得出一个确切的结论。</p>\n<p>如何通过浅比较 A, B 得出是否相等：</p>\n<ol>\n<li><p>通过 <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is\" target=\"_blank\" rel=\"noopener\">Object.is()</a> 方法比较值 A, B 是否相等，如果相等，返回<code>true</code>。</p>\n<p>比较结果详见 <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Equality_comparisons_and_sameness\" target=\"_blank\" rel=\"noopener\">MDN</a>。考虑兼容性，react 使用了 Polyfill 。</p>\n</li>\n<li><p>如果 A, B 中有个任何一个为<code>null</code>或者数据类型不是<code>object</code>，直接返回<code>false</code>。</p>\n<p>Object.is 方法用于对<strong>基本数据类型</strong>做一个精确的比较，如果发生误判，仅可能是 object 类型。但如果其中一个不是 object，就不可能相等了。</p>\n</li>\n<li><p>如果 A, B 包含的顶层键值对数量不同，直接返回<code>false</code>。</p>\n</li>\n<li><p>将 A, B 中的键值对一一对比，如果 B 存在 A 没有的键或者相同键对应的值不同，就返回<code>false</code>。</p>\n</li>\n<li><p>使用反证法，通过所有不相等判断之后，只能是相等的，返回<code>true</code>。</p>\n</li>\n</ol>\n<p>源码其实很简答就能看明白，重点是对浅比较这个过程有了一个更清晰的了解。就拿<code>PureComponent</code>来说，之前我广义上的理解是：如果更新一个对象或数组，可能会发生一些渲染上的问题。现在可以清楚表达为：不能通过直接修改之前的引用值，而需要通过重新声明一个变量的方式（<code>Array.prototype.concat(), Object.assign()</code>），才能触发重渲染。</p>\n","categories":[],"tags":["react"]},{"title":"浅析 React Fiber","url":"http://billqiu.github.io/2018/11/12/react-fiber/","content":"<h2 id=\"引言\"><a href=\"#引言\" class=\"headerlink\" title=\"引言\"></a>引言</h2><p>在 react 进入大家视野之初，<a href=\"https://reactjs.org/docs/faq-internals.html\" target=\"_blank\" rel=\"noopener\">Virtual DOM</a>（VDOM）的概念让人眼前一亮，在操作真正的 DOM 之前，先通过 VDOM 前后对比得出需要更新的部分，再去操作真实的 DOM，减少了浏览器多次操作 DOM 的成本。这一过程，官方起名 reconciliation，可翻译为<code>协调算法</code>。但是 react 发展到今日，随着前端应用的量级越来越大，reconciliation 已经日显疲惫，React Fiber 应运而出。React Fiber 是对 React 核心算法的重写，由 React 团队历时两年多完成。</p>\n<h2 id=\"动机\"><a href=\"#动机\" class=\"headerlink\" title=\"动机\"></a>动机</h2><p>当时被大家拍手叫好的 VDOM，为什么今日会略显疲态，这还要从它的工作原理说起。在 react 发布之初，设想未来的 UI 渲染会是异步的，从 <code>setState()</code> 的设计和 react 内部的事务机制可以看出这点。在 react@16 以前的版本，reconciler（现被称为 stack reconciler ）采用自顶向下递归，从根组件或 <code>setState()</code> 后的组件开始，更新整个子树。如果组件树不大不会有问题，但是当组件树越来越大，递归遍历的成本就越高，持续占用主线程，这样主线程上的布局、动画等周期性任务以及交互响应就无法立即得到处理，造成顿卡的视觉效果。</p>\n<p>理论上人眼最高能识别的帧数不超过 30 帧，电影的帧数大多固定在 24，浏览器最优的帧率是 60，即16.5ms 左右渲染一次。 浏览器正常的工作流程应该是这样的，运算 -&gt; 渲染 -&gt; 运算 -&gt; 渲染 -&gt; 运算 -&gt; 渲染 … </p>\n<p><img src=\"/assets/blogImg/page1.png\" alt=\"img\"></p>\n<p>但是当 JS 执行时间过长，就变成了这个样子，FPS（每秒显示帧数）下降造成视觉上的顿卡。 </p>\n<p><img src=\"/assets/blogImg/page2.png\" alt=\"img\"></p>\n<p>那么这个问题如何解决，这就是 fiber reconciler 要做的事了。简而言之可以看下图，将要执行的 JS 做拆分，保证不会阻塞主线程（Main thread）即可。 </p>\n<p><img src=\"/assets/blogImg/page3.png\" alt=\"img\"></p>\n<h2 id=\"工作原理\"><a href=\"#工作原理\" class=\"headerlink\" title=\"工作原理\"></a>工作原理</h2><p>将同步任务拆分大家都能理解，但在拆分之前我们面临以下几个问题：</p>\n<ul>\n<li>拆什么？</li>\n<li>如何拆？</li>\n<li>拆分后的执行顺序如何？</li>\n</ul>\n<h3 id=\"拆什么\"><a href=\"#拆什么\" class=\"headerlink\" title=\"拆什么\"></a>拆什么</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># React@15</span><br><span class=\"line\">DOM 真实DOM节点</span><br><span class=\"line\">-------</span><br><span class=\"line\">Instances React 维护的 VDOM tree node</span><br><span class=\"line\">-------</span><br><span class=\"line\">Elements 描述 UI 长什么样子（type, props）</span><br></pre></td></tr></table></figure>\n<p>在 react@15 中，更新主要分为两个步骤完成： 1. diff diff 的实际工作是对比 prevInstance 和 nextInstance 的状态，找出差异及其对应的 VDOM change。diff 本质上是一些计算（遍历、比较），是可拆分的（算一半待会儿接着算）。 2. patch 将 diff 算法计算出来的差异队列更新到真实的 DOM 节点上。React 并不是计算出一个差异就执行一次 patch，而是计算出全部的差异并放入差异队列后，再一次性的去执行 patch 方法完成真实的DOM更新。</p>\n<p>最后的 patch 阶段更新，是一连串的 DOM 操作，虽然可以根据 diff 后得到的 change list 做拆分，但是意义不大，不仅会导致内部维护的  DOM 状态和实际的不一致，也会影响体验，所以应该做的是对 diff 阶段进行拆分。从下图是 ReactDOM 渲染 10000 个子组件的过程。可以看到，在 diff 执行阶段主线程一直被占用，无法进行其他任何操作 I/O 操作，直到运行完成。</p>\n<p><img src=\"/assets/blogImg/stack.png\" alt=\"img\"></p>\n<h3 id=\"怎么拆\"><a href=\"#怎么拆\" class=\"headerlink\" title=\"怎么拆\"></a>怎么拆</h3><p>由此引出了 React Fiber 的解决方案，以一个 fiber 为单位来进行拆分，fiber tree 是根据 VDOM tree 构造出来的，树形结构完全一致，只是包含的信息不同。以下是 fiber tree 节点的部分结构：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    alternate: Fiber|null, // 在fiber更新时克隆出的镜像fiber，对fiber的修改会标记在这个fiber上</span><br><span class=\"line\">    nextEffect: Fiber | null, // 单链表结构，方便遍历 Fiber Tree 上有副作用的节点</span><br><span class=\"line\">    pendingWorkPriority: PriorityLevel, // 标记子树上待更新任务的优先级</span><br><span class=\"line\"></span><br><span class=\"line\">\tstateNode: any, // 管理 instance 自身的特性</span><br><span class=\"line\">    return: Fiber|null, // 指向 Fiber Tree 中的父节点</span><br><span class=\"line\">    child: Fiber|null, // 指向第一个子节点</span><br><span class=\"line\">    sibling: Fiber|null, // 指向兄弟节点</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Fiber 依次通过 return、child 及 sibling 的顺序对 ReactElement 做处理，将之前简单的树结构，变成了基于单链表的树结构，维护了更多的节点关系。</p>\n<p><img src=\"/assets/blogImg/fiber-node.jpeg\" alt=\"img\"></p>\n<h3 id=\"执行顺序\"><a href=\"#执行顺序\" class=\"headerlink\" title=\"执行顺序\"></a>执行顺序</h3><p>Stack 在执行时是以一个 tree 为单位处理；Fiber 则是以一个 fiber 的单位执行。Stack 只能同步的执行；Fiber 则可以针对该 Fiber 做调度处理。也就是说，假设现在有个 Fiber 其单链表（Linked List）结构为 A → B → C，当 A 执行到 B 被中断的话，可以之后再次执行 B → C，这对 Stack 的同步处理结构来说是很难做到的。</p>\n<p>在 React Fiber 执行的过程中，主要分为两个阶段（phase）：</p>\n<ol>\n<li>render / reconciliation (interruptible)</li>\n<li>commit (not interruptible)</li>\n</ol>\n<p>第一个阶段主要工作是自顶向下构建一颗完整的 Fiber Tree， 在 rerender 的过程中，根据之前生成的树，构建名为 workInProgress 的 Fiber Tree 用于更新操作。</p>\n<p><img src=\"/assets/blogImg/click.png\" width=\"100\"></p>\n<p><img src=\"/assets/blogImg/dom.png\" width=\"300\"></p>\n<p>假设我有上图所示的 DOM 结构需要渲染，第一次 render 的时候会生成下图所示的 Fiber Tree：</p>\n<p><img src=\"/assets/blogImg/fiber-tree.png\" width=\"300\"></p>\n<p>因为我需要对 Item 里面的数值做平方运算，于是我点击了 Button，react 根据之前生成的 Fiber Tree 开始构建workInProgress Tree。在构建的过程中，以一个 fiber 节点为单位自顶向下对比，如果发现根节点没有发生改变，根据其 child 指针，把 List 节点复制到 workinprogress Tree 中。 每处理完一个 fiber 节点，react 都会检查当前时间片是否够用，如果发现当前时间片不够用了，就是会标记下一个要处理的任务优先级，根据优先级来决定下一个时间片要处理什么任务。</p>\n<blockquote>\n<p>requestIdleCallback 会让一个低优先级的任务在空闲期被调用，而 requestAnimationFrame 会让一个高优先级的任务在下一个栈帧被调用，从而保证了主线程按照优先级执行 fiber 单元。 优先级顺序为：文本框输入 &gt; 本次调度结束需完成的任务 &gt; 动画过渡 &gt; 交互反馈 &gt; 数据更新 &gt; 不会显示但以防将来会显示的任务。</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">module.exports = &#123;  </span><br><span class=\"line\">  // heigh level</span><br><span class=\"line\">  NoWork: 0, // No work is pending.</span><br><span class=\"line\">  SynchronousPriority: 1, // For controlled text inputs. </span><br><span class=\"line\">  TaskPriority: 2, // Completes at the end of the current tick.</span><br><span class=\"line\">  AnimationPriority: 3, // Needs to complete before the next frame.</span><br><span class=\"line\">  </span><br><span class=\"line\">  // low level</span><br><span class=\"line\">  HighPriority: 4, // Interaction that needs to complete pretty soon to feel responsive.</span><br><span class=\"line\">  LowPriority: 5, // Data fetching, or result from updating stores.</span><br><span class=\"line\">  OffscreenPriority: 6, // Won&apos;t be visible but do the work in case it becomes visible.</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p>在平方运算这一过程中，react 通过依次对比 fiber 节点发现 List，Item2，Item3 发生了变化，就会在对应生成的 workInProgress Tree 中打一个 Tag，并且推送到 effect list 中。</p>\n<p><img src=\"/assets/blogImg/compare-tree.png\" width=\"500\"></p>\n<p><img src=\"/assets/blogImg/effect-list.png\" width=\"500\"></p>\n<p>当 reconciliation 结束后，根节点的 effect list 里记录了包括 DOM change 在内的所有 side effect，在第二阶段（commit）执行更新操作，这样一个流程就算结束了。</p>\n<p>在这个示例中，详细的比对流程并没有细讲，推荐观看 <a href=\"https://www.youtube.com/watch?v=ZCuYPiUIONs\" target=\"_blank\" rel=\"noopener\">Lin Clark</a> 去年 react conf 中的演讲，非常浅显易懂，本文中示例也来自这个演讲。</p>\n<h2 id=\"畅想未来\"><a href=\"#畅想未来\" class=\"headerlink\" title=\"畅想未来\"></a>畅想未来</h2><ul>\n<li>异步渲染 今年在冰岛举行的 JS Conf，Dan 提到了异步渲染的概念，异步渲染不是说一个个加载组件，而是说在以异步的方式加载的同时给人以同步流程的体验，在老设备上，通过牺牲一些加载时间来获得一种流畅的体验。其实在 React@16 版本中，异步渲染默认是关闭的，虽然可以通过 hack 的方式实现非同步，但是因为没有写测试，还是会有 BUG 存在。</li>\n<li>生命周期大换血 在 react@16 版本中，虽然依旧支持之前的生命周期函数，但是官方已经说明在下个版本中会将废弃其中的部分，这么做的原因，主要是 reconciliation 的重写导致。在 render/reconciliation 的过程中，因为存在优先级和时间片的概念，一个任务很可能执行到一半就被其他优先级更高的任务所替代，或者因为时间原因而被终止。当再次执行这个任务时，是从头开始执行一遍，就会导致组件的某些 <code>will</code> 生命周期可能被多次调用而影响性能。react 团队给了我们很长一段时间来处理这个问题，官方也提供了很多参考<a href=\"https://reactjs.org/blog/2018/03/27/update-on-async-rendering.html\" target=\"_blank\" rel=\"noopener\">案例</a>，可以平滑过渡到下个版本。</li>\n</ul>\n<p>react@16 与其说是一个分水岭，不如说是一个过渡，做的很多工作都是在给用户打预防针，告诉你接下来该怎么做，react@17才会是掀起风浪的那一个。reconciliation 的重写给 react 的未来带来太多的可能，包括最近社区讨论的如火如荼的 Hooks，其实也是 Fiber 带来一种可能性。在后续的版本中，个人以为写法上会有不小的改变，主要是为了更加优秀的性能服务；还有就是将一些社区产生的方案做优化，让写法更加人性化（HOC 中的 refs 以及 context 传递），以及对常见的问题给出官方的解决方案（异步数据处理）等等。除了优点，当然也会带来些问题。随着版本的迭代，react 中的概念越来越多，新手学习的曲线只怕是会越来越陡峭。</p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>在处理大型应用时，react 的表现不尽人意。主要原因在于计算耗时太长，导致主线程一直被占用，无法处理其他任务。react 团队为了解决这个问题，提出了 Fiber reconciliation 的方案来代替之前的 Stack reconciliation。Fiber 相较于 Stack，采用了异步的方式将之前同步执行的计算过程做拆分，使得主线程不会一直处于被占用的状态，可以有时间去处理其他任务，比如 I/O 操作，交互反馈等。</p>\n<h2 id=\"参考文献\"><a href=\"#参考文献\" class=\"headerlink\" title=\"参考文献\"></a>参考文献</h2><ul>\n<li><a href=\"https://www.zhihu.com/question/49496872\" target=\"_blank\" rel=\"noopener\">如何理解 React Fiber 架构？ - 知乎</a></li>\n<li><a href=\"https://juejin.im/post/5ab7b3a2f265da2378403e57\" target=\"_blank\" rel=\"noopener\">React Fiber - 掘金</a></li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/47407398\" target=\"_blank\" rel=\"noopener\">图解浏览器的基本工作原理 - 知乎</a></li>\n<li><a href=\"http://zxc0328.github.io/2017/09/28/react-16-source/\" target=\"_blank\" rel=\"noopener\">React 16 Fiber源码速览 | Zindex’s blog</a></li>\n<li><a href=\"https://medium.com/@_cybai/%E7%BF%BB%E8%AD%AF-react-fiber-%E7%8F%BE%E7%8B%80%E7%A2%BA%E8%AA%8D-fd3808072279\" target=\"_blank\" rel=\"noopener\">翻譯 React Fiber 現狀確認 – CYB – Medium</a></li>\n<li><a href=\"http://www.ayqy.net/blog/dive-into-react-fiber/\" target=\"_blank\" rel=\"noopener\">完全理解React Fiber | 黯羽轻扬</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=ZCuYPiUIONs\" target=\"_blank\" rel=\"noopener\">A Cartoon Intro to Fiber</a></li>\n<li><a href=\"https://github.com/xieyu/blog/blob/master/React/from-jsx-to-dom.md\" target=\"_blank\" rel=\"noopener\">blog/from-jsx-to-dom.md at master · xieyu/blog · GitHub</a></li>\n<li><a href=\"https://reactjs.org/blog/2018/03/01/sneak-peek-beyond-react-16.html\" target=\"_blank\" rel=\"noopener\">Sneak Peek: Beyond React 16</a></li>\n</ul>\n","categories":[],"tags":["react","js","react-fiber"]},{"title":"Git 内幕（一）","url":"http://billqiu.github.io/2018/09/07/git-from-the-inside-out/","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>git 是一种程序员几乎每天都会用到的工具，给我们代码管理带去了极大的方便。以往的 git 介绍，多是介绍git 的高级命令，如<code>git rebse</code>、<code>git cherry-picker</code>、<code>git bisect</code>等，少有看到剖析git 内部原理的。原因也很简单，即使对 git 的原理不甚了解，也并不会影响我们熟练使用 git。但是很多事我们不光要知其然，更要知其所以然，方能举一反三。</p>\n<h2 id=\"概念\"><a href=\"#概念\" class=\"headerlink\" title=\"概念\"></a>概念</h2><p>在介绍 git 的原理之前，先介绍几个基本概念和会用到的命令，以便大家在阅读文章时能更加轻松地理解。</p>\n<ul>\n<li>BLOB (binary large object)：二进制大对象，是一个可以存储二进制文件的容器。</li>\n<li>three git status：<ol>\n<li>Untracked：文件还未被<code>git add</code>，对应工作区（Working Directory）。</li>\n<li>Staged：<code>git add</code> 后所处的状态， 对应暂存区（Stage）。</li>\n<li>Committed：<code>git committe</code>后所处的状态，对应版本库（Commit History）。</li>\n</ol>\n</li>\n<li><code>git cat-file</code>：查看 git 对象的瑞士军刀，能转译二进制文件为可读文件。</li>\n<li><code>git hash-object -w filename</code>：查看到 git 已存储的数据</li>\n<li><code>hexdump -C filename</code>：查看二进制文件的十六进制编码</li>\n</ul>\n<h2 id=\"git-内幕\"><a href=\"#git-内幕\" class=\"headerlink\" title=\".git 内幕\"></a>.git 内幕</h2><p>当你在一个新目录或已有目录内执行 <code>git init</code> 时，git 会创建一个 .git 目录，几乎所有 git 存储和操作的内容都位于该目录下。记得在刚接触 git 时，因为对 <code>stage</code>、<code>branch</code> 等概念不够了解，还做出过备份整个项目的蠢事。其实如果真要做备份，备份当前的 .git 文件即可。</p>\n<p>下图为刚初始化的 .git 的目录结构（不同版本的 git 会有所不同），几乎所有的 git 操作和存储都位于该目录下。本次真要介绍四个核心文件或目录：HEAD 及 index 文件，objects 及 refs 目录。<br><img src=\"http://img.souche.com/f2e/2b49ad6927521745890bea4b0313be3a.png\" style=\"height: 400px\"></p>\n<p>简而言之，git 从核心上来看不过是简单地存储键值对（key-value）。它允许插入任意类型的内容，并会返回一个键值，通过该键值可以在任何时候再取出该内容。</p>\n<h2 id=\"git-add\"><a href=\"#git-add\" class=\"headerlink\" title=\"git add\"></a>git add</h2><p>先抛出一个问题：<a href=\"https://git.wiki.kernel.org/index.php/GitFaq#Can_I_add_empty_directories.3F\" target=\"_blank\" rel=\"noopener\">一个空的文件夹是否能添加到 git 项目中</a>？很多人可能都知道答案，但是为什么呐？通过对 <code>git add</code> 背后原理的解析，相信你可以得出一个确切的答案。</p>\n<ol>\n<li>初始化</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> mkdir alpha &amp;&amp; <span class=\"built_in\">cd</span> alpha</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git init</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> mkdir data</span></span><br></pre></td></tr></table></figure>\n<p>通过执行上面的命令，我们创建了一个名为 <code>alpha</code> 的文件夹，并且将其初始化为一个 git 项目，再新建一个 <code>data</code>  空文件夹。通过执行 <code>git add data</code> 命令希望把 <code>data</code> 空文件夹添加到暂存区中，发现执行后并没有发生任何变化，执行 <code>git status</code> 查看仓库的状态，抛出这样一段提示：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git status</span></span><br><span class=\"line\">On branch master</span><br><span class=\"line\">No commits yet</span><br><span class=\"line\">nothing to commit (create/copy files and use \"git add\" to track)</span><br></pre></td></tr></table></figure>\n<p>如果在 <code>data</code> 文件夹内再新建一个空文件夹又会如何呐，发现还是没有任何变化。这样就得出了开头那个问题的答案，空的文件夹是无法添加到 git 项目中的。再查看一下 <code>.git</code> 目录，也没有发生任何变化。</p>\n<ol>\n<li>添加文件夹到暂存区</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> <span class=\"built_in\">echo</span> <span class=\"string\">'a'</span> &gt; data/letter.txt</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git status</span></span><br><span class=\"line\">Untracked files:</span><br><span class=\"line\">  (use \"git add &lt;file&gt;...\" to include in what will be committed)</span><br><span class=\"line\"></span><br><span class=\"line\">\tdata/</span><br><span class=\"line\"></span><br><span class=\"line\">nothing added to commit but untracked files present (use \"git add\" to track)</span><br></pre></td></tr></table></figure>\n<p>在 <code>data</code> 目录下新建一个名为 <code>letter.text</code> 的文件，写入 <code>a</code>。发现仓库的状态发生了变化，但是 <code>.git</code> 目录并没有发生变化，说明在工作区的操作并不会产生 git  历史记录。<br>执行 <code>git add data</code> 命令，发现 <code>.git</code> 目录终于发生变化了。 分别多了 <code>index</code> 文件和 <code>objects/78/...</code>文件。<br><img src=\"http://img.souche.com/f2e/60ea80780510852942ea35d5b24006e9.png\" style=\"height: 400px\"></p>\n<p>之前说过，git 的存储其实是以键值对的形式存在的。<code>index</code>是一个列表，每一行维护一个文件名到 BLOB 哈希值的映射。<code>objects</code> 目录下存放的就是 value，这个BLOB文件包含了<code>data/letter.txt</code> 文件压缩后的内容，并以内容的哈希值作为文件名。哈希是一段算法，它将给定内容转换为更小的，且能唯一确定原内容的值。<br>我曾经尝试直接打开这些文件，但是打开都是一串乱码。可以通过十六进制编码的方式打开这些文件，但是毕竟不是机器，想要看明白还是有一些难度的🤣。<br><img src=\"http://img.souche.com/f2e/4cdf9a1851138b937978f231a0367bcd.png\"></p>\n<p><img src=\"http://img.souche.com/f2e/d6c97363f6810afc85c0575f14ad10bc.png\"></p>\n<p>幸好 git 提供了一把瑞士军刀（<code>git cat-file</code>）给我们使用，可以将数据内容取回。<br>打印出 <code>data/letter.txt</code> 中的内容为 <code>a</code>。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git cat-file -p 78981922613b2afb6025042ff6bd878ac1994e85</span></span><br><span class=\"line\">a</span><br></pre></td></tr></table></figure>\n<p>至于 <code>git/index</code> 中的内容，可以通过 <code>git ls-file</code> 查看。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git ls-file --stage</span></span><br><span class=\"line\">100644 78981922613b2afb6025042ff6bd878ac1994e85 0\tdata/letter.txt</span><br></pre></td></tr></table></figure>\n<p>正如之前所说的，<code>index</code> 文件存放的是一个列表，记录了哈希值对应的文件。<code>7898</code> 这个 BLOB 文件存储的是 <code>data/letter.txt</code> 中的内容。<code>objects</code>目录下的结点是不可变的。这意味着它的内容可以编辑，但不能删除。添加的文件内容和创建的提交都保存在 <code>objects</code> 目录下。（注：<code>git prune</code> 删除所有不能被ref访问到的对象，执行此命令可能会丢失数据。）</p>\n<h2 id=\"git-commit\"><a href=\"#git-commit\" class=\"headerlink\" title=\"git commit\"></a>git commit</h2><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git commit -m <span class=\"string\">'a1'</span></span></span><br><span class=\"line\">[master (root-commit) b83b660] a1</span><br><span class=\"line\"> 1 file changed, 1 insertion(+)</span><br><span class=\"line\"> create mode 100644 data/letter.txt</span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git status</span></span><br><span class=\"line\">On branch master</span><br><span class=\"line\">nothing to commit, working tree clean</span><br></pre></td></tr></table></figure>\n<p>执行 <code>git commit</code> 命令后，文件被保存到了版本库中，仓库处于 <code>clean</code>  的状态。再看看 <code>.git</code> 目录，发现多了 <code>logs</code> 目录和 <code>objects</code> 下的三个文件。<br><img src=\"http://img.souche.com/f2e/3c70827c8b4cae05f478c198b226338b.png\" style=\"height: 400px\"></p>\n<p>提交命令其实包含了三个步骤：</p>\n<ol>\n<li>创建提交版本对应文件的 tree 对象<br>什么是 tree 对象，tree 对象可以存储文件名，同时也允许存储一组文件。一个单独的 tree 对象包含一条或多条 tree 记录，每一条记录含有一个指向 BLOB 或子 tree 对象的哈希值。<br>创建新提交后，对应data目录的tree对象如下：记录了 <code>data/letter.txt</code> 文件的所有信息，我们可以使用这些信息来恢复 <code>data/letter.txt</code> 文件。空格分隔的第一部分表示该文件的权限，表明是一个普通文件；第二部分表示该记录对应的是一个 BLOB 对象，第三部分是该BLOB 的哈希值，第四部分记录了文件名。</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git cat-file -p e908cfc6e086c91a073c55a6882adebfc9c4520c</span></span><br><span class=\"line\"></span><br><span class=\"line\">100644 blob 78981922613b2afb6025042ff6bd878ac1994e85\tletter.txt</span><br></pre></td></tr></table></figure>\n<p>用图示表式即为：<code>data</code>目录对应的 tree 对象指向对应<code>data/letter.txt</code><br><img src=\"http://img.souche.com/f2e/a8ad7fae09f810a882177f8654cb6084.png\" style=\"height: 200px\"></p>\n<p>那么问题来了，data 并非根目录，文件的指向肯定是从根目录开始。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git cat-file -p master^&#123;tree&#125;</span></span><br><span class=\"line\">040000 tree e908cfc6e086c91a073c55a6882adebfc9c4520c\tdata</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git cat-file -p 9745002f161a1be75bf65f869ab16743da2a6fda</span></span><br><span class=\"line\"></span><br><span class=\"line\">040000 tree e908cfc6e086c91a073c55a6882adebfc9c4520c\tdata</span><br></pre></td></tr></table></figure>\n<p><code>master^{tree}</code> 表示 master （当前）分支上最新提交指向的 tree 对象。从给出的结果中可以看到根目录（root）指向了 <code>data</code> 目录，图示如下：<br><img src=\"http://img.souche.com/f2e/b537540955ff6466f15529bb846326d3.png\" style=\"height: 300px\"></p>\n<ol>\n<li>创建一个提交对象<br>我们在提交时输入了 <code>commit message</code> 等信息，这些信息自然也存放在<code>objects</code> 目录下：</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git cat-file -p b83b66096fb5b5225ec0c5741f45d334ceb94046</span><br><span class=\"line\"></span><br><span class=\"line\">tree 9745002f161a1be75bf65f869ab16743da2a6fda</span><br><span class=\"line\">author Bill Qiu &lt;fanglaiq@gmail.com&gt; 1536220281 +0800</span><br><span class=\"line\">committer Bill Qiu &lt;fanglaiq@gmail.com&gt; 1536220281 +0800</span><br><span class=\"line\">a1</span><br></pre></td></tr></table></figure>\n<p>第一行指向一个tree对象。通过这里的哈希值，我们可以找到对应工作区根目录（即 alpha 目录）的 tree 对象，最后一行是提交信息。<br><img src=\"http://img.souche.com/f2e/b537540955ff6466f15529bb846326d3.png\" style=\"height: 400px\"></p>\n<ol>\n<li>将当前分支指向新提交<br>到了这里还存在最后一个问题，分支。 git 怎么知道现在的提交应该指向哪个分支？答案在 <code>HEAD</code> 文件中：<code>ref: refs/heads/master</code>。HEAD 指向 master，master 就是我们当前分支。因为是第一个提交，代表master引用的文件还不存在。git 会自动创建 <code>.git/refs/heads/master</code> ，并写入提交对象的哈希值：<code>b83b66096fb5b5225ec0c5741f45d334ceb94046</code>。<br><img src=\"http://img.souche.com/f2e/bea53a7f80fc1acb2663a6262768a9fb.png\" style=\"height: 400px\"></li>\n</ol>\n<p>最后，所有 BLOB 文件所存储的信息都通过 tree 对象串联了起来，就好比 <code>key-value</code> 的形式。</p>\n<p>再来回答下开头提出的问题吧，一个空的文件夹是否能添加到 git 项目中？<br>答：不可以。因为 git 使用的索引机制，是以文件为最小单位存储内容，跟踪变化的。<br>那么怎么做才可以使这个文件夹存在呐？通常\u0010的做法是在里面新建一个名为 <code>.gitkeep</code> 的文件。</p>\n<h2 id=\"参考链接\"><a href=\"#参考链接\" class=\"headerlink\" title=\"参考链接\"></a>参考链接</h2><ul>\n<li><a href=\"https://git-scm.com/book/zh/v1/Git-%E5%86%85%E9%83%A8%E5%8E%9F%E7%90%86\" target=\"_blank\" rel=\"noopener\">Git - Git 内部原理</a></li>\n<li><a href=\"https://codewords.recurse.com/issues/two/git-from-the-inside-out\" target=\"_blank\" rel=\"noopener\">Git from the inside out</a></li>\n<li><a href=\"https://git.wiki.kernel.org/index.php/GitFaq#Can_I_add_empty_directories.3F\" target=\"_blank\" rel=\"noopener\">Git FAQ - Git SCM Wiki</a></li>\n</ul>\n","categories":[],"tags":["git"]},{"title":"路","url":"http://billqiu.github.io/2018/06/21/road/","content":"<p>一直对路没有什么太深刻的理解，顶多也就是停留在路名上而已。可能这条叫中山路，那条叫紫金港路。有些路是以地理位置命名的，而有些路则是被某知名企业冠名。直到今天，突然走到了一条我常走、非常熟悉的路的尽头，愈发感觉自己对路有了一个新的认识。</p>\n<p>几乎每天都会从这条路上溜过，骑车居多，有时也会走走。这条路和另一条主干线交叉，我们公司就在旁边，所以他给我的映像，总是车来车往，没有一刻的停歇。今天骑着车回家，在将要拐离这条路的时候，突然有个向前的念头，来来往往了那么多次，想知道前方是什么样子。我本以为我会骑很久，会与很多车辆交汇，还低头看了看电量是否充足，要是骑到一半没电就真的要扛回去了。但是我差不多就往前骑了不过一百米，就渐微给了我一种走进乡间小路的感觉，猛然间，我看到了路的尽头。这太不可思议了，不应该是这样的，这和我想象的完全不一样，我不愿意放弃，沿着路的尽头往右拐了进去。这里几乎是一片漆黑，没有什么路灯，只能借着旁边小餐馆漏出的一点灯光来看清道路。我打开了手机的闪光灯，好让我自己看的更清楚一些。旁边都是一些没有被拆迁的老式居民楼，在黑暗中并肩走着一对回家的小情侣，还没等我将周围看得更清楚一些，已经到了尽头，我只好原路折返。</p>\n<p>这又让我想起了我对路的另一个认知的转变。在我住的小区门口，一出门就是一条叫西坝路的马路，刚来的时候，还常常被我念成是西贝路（真是白字先生，字读半边）。在我的潜意识里，总认为路是笔直的，而西坝路再往前走就是一个直角的拐弯，所以我就理所当然的以为那是另一条路了，那个拐角就应该算是西坝路的尽头了。这条路也是有够短的——这是我对西坝路的第一印象。后来有一天，我在附近散步，突然看见了一个路标，上面竟然写着西坝路。我很疑惑，难道两条路还可以重名不成，而且隔得应该也不是很远啊。我就顺着“西坝路”一直走，周围完全是陌生的环境，但是大体的方向感我还是有的，走着走着，也印证了我的想法，果然只有一条“西坝路”。我沿着西坝路，走回了家。后来我在地图上查了查，原来路是可以拐弯的——虽然我明明是知道这点的——拐弯后的仍是西坝路。</p>\n<p>喧嚣的大路，不管你以为他多有长，也终归有个尽头，遂归于宁静；眼前的小路你以为已经走到了尽头，谁知拐了个弯，还有一大半没有走完，走着走着，说不定就回到了熟悉的起点。有些路，可能并没有想象中那么长远，戛然而止的宁静让你心悸，其实路边的风景早已在向你宣示你所将要面对的。惯性思维会让我们错失很多幻想过的美好，这时你再踩油门，可能已是逆水行舟。</p>\n","categories":[],"tags":["article","road"]},{"title":"Vue 真的比 React 上手简单吗?","url":"http://billqiu.github.io/2018/04/12/react-vs-vue/","content":"<blockquote>\n<p>  本文源自我在知乎的一个回答：</p>\n<p>  <a href=\"https://www.zhihu.com/question/271908748/answer/365118404\" target=\"_blank\" rel=\"noopener\">Vue 真的比 React 上手简单吗?</a></p>\n</blockquote>\n<p>在我接触 Vue 之前，完全没有用过其他 mvvm 框架，理解一点模块化的概念，用过 sea.js。当时入坑前端时间不长，js 的基础相对较差，就是这样的背景下我进入公司开始用 Vue 写业务。</p>\n<ol>\n<li><p>完善的中文文档</p>\n<p>对于一个入门的小白来说，这点很重要。作为一个有素质的开发，我更愿意去官网看文档，而 react 的官方文档是英文的，这对我后续使用 react 提升了不小的门槛。</p>\n<p>​</p>\n</li>\n<li><p>API 设计</p>\n<p>在 Vue 的文档中，提供了很多易用的 API ，比如说<code>vue-if</code>、<code>vue-for</code>、<code>vue-show</code>等等。一个萝卜一个坑，对开发者来说，”坑”已经在那边了，就等你把萝卜塞进去就可以了。而 react 不一样，react 更强调的是一种灵活性，通过在 jsx 中直接写 js 来达到我想要的渲染效果。对于刚入门的同学，js 基础可能没那么扎实，所以 Vue 的 API 提供了很大的帮助。</p>\n<p>​</p>\n</li>\n<li><p>设计理念</p>\n<p>我当初在写 Vue 的时候，对组件化的开发模式理解比较浅，所以在做项目时，一个页面直接都写在一个<code>.vue</code>文件中，用的还是之前 jQuery 时代的开发思想。但是这样做其实关系也不大，就是开发效率可能比较低下。</p>\n<p>Vue 是一个典型的 mvvm 框架，数据的变化会直接反映在视图上，这对一个新手来说是很舒服的，我直接把数据变了，我的目的就达到了，至于其他的事：比如“组件之间通信”、“生命周期”等老生常谈的问题暂时可以不考虑。其实我当初入门写了半年时间的 Vue，也不太清楚 Vue 的生命周期具体是怎么样的。</p>\n<p>而 react 不同，react 更强调的是一种组件化开发的概念。所有页面都是组件的组合，好的组件需要符合『高内聚，低耦合』的设计理念。其中最基础的触发视图更新的方法<code>setState</code>也有不小的坑，最为人津津乐道的就是它是一个异步的过程。Twitter 上还为此打过一场口水战，有人提议不要使用<code>setState</code>，而使用 redux 等单向数据流的概念，使每一个更新步骤都是可追踪的。这对于新手来说，无疑又是一道坎。在开发 react 的过程中，对生命周期的掌握程度也是一大问题。举个最简单的例子，我向一个子组件传递一个新的 props，但是却没有触发视图的更新，其实就是因为用了 stateful components，但是没有写<code>componentWillReceiveProps</code>生命周期。</p>\n<p>这些都是刚开始使用 react 时会遇到的问题，而我用 Vue 就不会。</p>\n<p>​</p>\n</li>\n<li><p>概念的堆砌</p>\n<p>在 react 中，你会接触到很多“专业术语”。<code>HOC</code>、<code>stateless</code>、<code>render props</code>。其实这也是我很喜欢的 react 的一个原因，它提出的一些设计理念，让我感觉到他很先进，当然，他确实也很先进。经常会有人提出一些有意思的概念和方案， <code>css in js</code>、<code>flux</code> etc…</p>\n</li>\n</ol>\n<p>也许因为自己 react 写的比较多，在我眼里，react 的生态是明显要优于 Vue 的，当然，这对小白开发者来说，其实影响不大，但是越到后来，一个框架的生态决定了其上限，还是一个很需要考量的因素。</p>\n<p>最后再说几句，我是在写了大半年 Vue 后转的 react，但是当时感觉上手 react 的难易程度，还是明显要高于刚写 Vue 的时候的。</p>\n","categories":[],"tags":["react","vue"]},{"title":"Awesome npx","url":"http://billqiu.github.io/2018/03/26/awesome-npx/","content":"<h2 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h2><p>在<code>gayhub</code>闲逛时，不知怎么突然想看看<code>create-react-app</code>（以下简称 create）的源码，来到项目<a href=\"https://github.com/facebook/create-react-app\" target=\"_blank\" rel=\"noopener\">主页</a>，无意中瞄到<code>README.md</code>好像发生了一点小小的变化。</p>\n<blockquote>\n<p><code>npx create-react-app my-app</code></p>\n</blockquote>\n<p>这个 npx 是什么鬼，突然想起来前几天好像也在一些 npm 的工具包上看到过这个玩意儿，但是没有注意。既然今天又碰到了，那就好好把玩一下，毕竟<code>create</code>也用到了它，应该是个值得一用的好东西。看了下项目的修改记录，大约是在两个月前加入使用<code>npx</code>的，这也从侧面说明<code>npx</code>已基本趋于稳定，可以大胆的使用了。</p>\n<h2 id=\"简述\"><a href=\"#简述\" class=\"headerlink\" title=\"简述\"></a>简述</h2><p>上网简单查阅了下资料，原来 npx 是跟随 <a href=\"mailto:npm@5.2.0\" target=\"_blank\" rel=\"noopener\">npm@5.2.0</a> 发布的，使用5.2.0版本之后的 npm，会自动帮你安上 npx，这么大的推广力度，很难不引起关注啊，之前咋没发现呐？或许是因为好久都没有升级 npm 版本的缘故吧。毕竟本地的 node 版本，不久以前才从 6.x 升级到的 8.x。对于我们这些前端开发人员来说，稳定是最重要的，基本也没有什么切换 node 版本的需求。</p>\n<p>以下的总结，基本都是这篇 Medium 上的<a href=\"https://medium.com/@maybekatz/introducing-npx-an-npm-package-runner-55f7d4bd282b\" target=\"_blank\" rel=\"noopener\">文章</a>搬过来的，英语基础不错的同学，可以尝试直接阅读原文。</p>\n<h2 id=\"npx-带来了什么\"><a href=\"#npx-带来了什么\" class=\"headerlink\" title=\"npx 带来了什么\"></a>npx 带来了什么</h2><h3 id=\"直接使用项目下的工具包\"><a href=\"#直接使用项目下的工具包\" class=\"headerlink\" title=\"直接使用项目下的工具包\"></a>直接使用项目下的工具包</h3><p>以前我们使用<code>create-react-app</code> 初始化一个项目，大致需要以下步骤：</p>\n<pre><code>1. `$ npm i create-react-app -g`\n2. `$ cd project-directory`\n3. `$ create-react-app my-app`\n</code></pre><p>如果我们使用 npx，并且刚好在想要创建项目的目录下，一行命令就可以搞定：<br><code>npx create-react-app my-project</code><br>npx 帮我们做了什么事呐？</p>\n<pre><code>1. 在当前目录下寻找是否存在 create 包\n2. 如果没有找到，则会去根目录下寻找是否全局安装过 create\n3. 如果还没有找到，就会下载并使用最新版本的 create ，然后初始化项目，完成后，不会有任何多余依赖的残留\n</code></pre><p>相比于之前的使用方式，npx 带给我们的便处是显而易见的。对于 create 这种我们使用频率并不高的工具，其实安装在全局下的必要性并不大。下一次使用的时候，说不定就之前已经迭代好几个版本了。对于 mac 用户来说，容量寸土寸金，而 node_modules 的大小却是不容小觑的。</p>\n<h3 id=\"直接运行远端脚本\"><a href=\"#直接运行远端脚本\" class=\"headerlink\" title=\"直接运行远端脚本\"></a>直接运行远端脚本</h3><p><a href=\"https://gist.github.com/\" target=\"_blank\" rel=\"noopener\">gist</a> 在日常开发中使用还是比较广泛的，没有程序员愿意一次又一次的写重复写代码。如果我们想执行放在 gist 上的一段 node 脚本，直接用 npx  一行命令即可搞定。<br><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> npx https://gist.github.com/zkat/4bc19503fe9e9309e2bfaa2c58074d32</span><br><span class=\"line\">npx: installed 1 in 5.217s</span><br><span class=\"line\">yay gist</span><br></pre></td></tr></table></figure></p>\n<p>需要注意的是，出于安全性考虑，请先通读 gits 上的代码是安全的，再执行命令，就像你要执行一段<code>.sh</code>脚本一样小心。</p>\n<h3 id=\"作为一个工具包的开发者\"><a href=\"#作为一个工具包的开发者\" class=\"headerlink\" title=\"作为一个工具包的开发者\"></a>作为一个工具包的开发者</h3><p>我可以直接在<code>README.md</code>中写上<code>$ npx my-tool</code>，让用户使用我开发工具，这个使用体验可以说是相当舒爽的。<br>你可以直接体验一些有意思的工具包，happy-birthday，benny-hill，workin-hard，cowsay， yo， create-react-app， npm-check等，详见<a href=\"https://github.com/js-n/awesome-npx\" target=\"_blank\" rel=\"noopener\">awesome-npx 🕶</a>。<br>也许你担心放在 <code>snpm</code>上的工具无法使用，其实大可放心，用<code>nrm</code>等工具指定下源即可完美下载使用。或者麻烦一点就这样写：<code>npx --registry=http://registry.npm.souche-inc.com @souche-f2e/sad-cli -h</code>，指定 registry 即可。</p>\n<h3 id=\"shell-auto-fallback\"><a href=\"#shell-auto-fallback\" class=\"headerlink\" title=\"shell auto-fallback\"></a>shell auto-fallback</h3><p>这个不知道翻译合适，就先不翻译了🤔。<br>其作用就是让我们<strong>方便地</strong>使用不同版本的依赖包，比如我本地安装的是 <a href=\"mailto:babel@6.x\" target=\"_blank\" rel=\"noopener\">babel@6.x</a>，但是我想使用 <a href=\"mailto:babel@5.x\" target=\"_blank\" rel=\"noopener\">babel@5.x</a> 看看执行效果，直接执行<code>babel@5 filename.js</code>即可。<br><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> bebel@5 -V</span><br><span class=\"line\">babel@5 not found. Trying with npx...</span><br><span class=\"line\">5.8.38 (babel-core 5.8.38)</span><br></pre></td></tr></table></figure></p>\n<p>当然想只用这个功能，还是需要做一些配置的：<br>将对应的代码添加到对应的文件中即可， <code>~/.bashrc, ~/.zshrc, ~/.config/fish/config.fish</code>。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">For bash@&gt;=4:</span><br><span class=\"line\">$ source &lt;(npx --shell-auto-fallback bash)</span><br><span class=\"line\"></span><br><span class=\"line\">For zsh:</span><br><span class=\"line\">$ source &lt;(npx --shell-auto-fallback zsh)</span><br><span class=\"line\"></span><br><span class=\"line\">For fish:</span><br><span class=\"line\">$ source (npx --shell-auto-fallback fish | psub)</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"参考链接\"><a href=\"#参考链接\" class=\"headerlink\" title=\"参考链接\"></a>参考链接</h2><ul>\n<li><a href=\"https://medium.com/@maybekatz/introducing-npx-an-npm-package-runner-55f7d4bd282b\" target=\"_blank\" rel=\"noopener\">Introducing npx: an npm package runner – Kat Marchán – Medium</a></li>\n</ul>\n<p>自由转载-非商用-非衍生-保持署名<a href=\"https://link.juejin.im/?target=https%3A%2F%2Fcreativecommons.org%2Flicenses%2Fby-nc-nd%2F3.0%2Fdeed.zh\" target=\"_blank\" rel=\"noopener\">（创意共享3.0许可证）</a></p>\n","categories":[],"tags":["npx"]},{"title":"babel-polyfill VS babel-runtime","url":"http://billqiu.github.io/2018/02/28/babel-polyfill-vs-babel-runtime/","content":"<p><img src=\"http://img.souche.com/f2e/b52b1660f95dc4849402e60c79befcdb.png\"></p>\n<h2 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h2><p>在项目迭代过程中，因为有兼容 IE 的需求，根据文档使用<code>babel-polyfill</code>和<code>babel-runtime</code>两个插件解决问题。但是对于二者之间的恩怨情仇，却不甚了解，便打算细细探究一番。</p>\n<h2 id=\"关于-Babel\"><a href=\"#关于-Babel\" class=\"headerlink\" title=\"关于 Babel\"></a>关于 Babel</h2><p>如果我们没有配置一些规则，Babel 默认只转换新的 JavaScript 句法（syntax），而不转换新的 API，比如 Iterator、Generator、Set、Maps、Proxy、Reflect、Symbol、Promise 等全局对象，以及一些定义在全局对象上的方法（比如 Object.assign ）都不会转码。<br>所以，当这样的代码出现时：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> key = <span class=\"string\">'babel'</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> obj = &#123;</span><br><span class=\"line\">    [key]: <span class=\"string\">'foo'</span>,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>Babel 默认会编译成下面的代码<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">_defineProperty</span>(<span class=\"params\">obj, key, value</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (key <span class=\"keyword\">in</span> obj) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">Object</span>.defineProperty(obj, key, &#123; <span class=\"attr\">value</span>: value, <span class=\"attr\">enumerable</span>: <span class=\"literal\">true</span>, <span class=\"attr\">configurable</span>: <span class=\"literal\">true</span>, <span class=\"attr\">writable</span>: <span class=\"literal\">true</span> &#125;);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        obj[key] = value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> obj;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> key = <span class=\"string\">'babel'</span>;</span><br><span class=\"line\"><span class=\"keyword\">var</span> obj = _defineProperty(&#123;&#125;, key, <span class=\"built_in\">Object</span>.assign(&#123;&#125;, &#123; <span class=\"attr\">key</span>: <span class=\"string\">'foo'</span> &#125;));</span><br></pre></td></tr></table></figure></p>\n<p>我们可以看到代码中多了一个名为<code>_defineProperty</code>的帮助函数，但是这个帮助函数仅仅在当前模块中生效，因此其他模块中如果用到了同样的语法，编译后就会出现大量的重复代码。</p>\n<h2 id=\"babel-polyfill\"><a href=\"#babel-polyfill\" class=\"headerlink\" title=\"babel-polyfill\"></a>babel-polyfill</h2><p>原理是当运行环境中并没有实现的一些方法，babel-polyfill 会给其做兼容。<br>但是这样做也有一个缺点，就是会污染全局变量，而且项目打包以后体积会增大很多，因为把整个依赖包也搭了进去。所以并不推荐在一些方法类库中去使用。</p>\n<h3 id=\"用法\"><a href=\"#用法\" class=\"headerlink\" title=\"用法\"></a>用法</h3><pre><code>1. `npm install --save babel-polyfill`\n2. 在应用的入口引用，以确保它能够最先加载：\n`import &quot;babel-polyfill&quot;;` 或者\n`require(&quot;babel-polyfill&quot;);`\n</code></pre><h2 id=\"babel-runtime\"><a href=\"#babel-runtime\" class=\"headerlink\" title=\"babel-runtime\"></a>babel-runtime</h2><p>为了不污染全局对象和内置的对象原型，但是又想体验使用新鲜语法的快感。就可以配合使用<code>babel-runtime</code>和<code>babel-plugin-transform-runtime</code>。<br>比如当前运行环境不支持<code>promise</code>，可以通过引入<code>babel-runtime/core-js/promise</code>来获取<code>promise</code>，<br>或者通过<code>babel-plugin-transform-runtime</code>自动重写你的<code>promise</code>。也许有人会奇怪，为什么会有两个<code>runtime</code>插件，其实是有历史原因的：刚开始开始只有<code>babel-runtime</code>插件，但是用起来很不方便，在代码中直接引入<code>helper</code> 函数，意味着不能共享，造成最终打包出来的文件里有很多重复的<code>helper</code>代码。所以，<code>Babel</code>又开发了<code>babel-plugin-transform-runtime</code>，这个模块会将我们的代码重写，如将<code>Promise</code>重写成<code>_Promise</code>（只是打比方），然后引入<code>_Promise helper</code>函数。这样就避免了重复打包代码和手动引入模块的痛苦。</p>\n<h3 id=\"用法-1\"><a href=\"#用法-1\" class=\"headerlink\" title=\"用法\"></a>用法</h3><pre><code>1. `npm install --save-dev babel-plugin-transform-runtime`\n2. `npm install --save babel-runtime`\n3. 写入 `.babelrc`\n</code></pre><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"plugins\"</span>: [<span class=\"string\">\"transform-runtime\"</span>]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>启用插件<code>babel-plugin-transform-runtime</code>后，<code>Babel</code>就会使用<code>babel-runtime</code>下的工具函数，转译代码如下：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">'use strict'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> _defineProperty2 = <span class=\"built_in\">require</span>(<span class=\"string\">'babel-runtime/helpers/defineProperty'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> _defineProperty3 = _interopRequireDefault(_defineProperty2);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">_interopRequireDefault</span>(<span class=\"params\">obj</span>) </span>&#123; <span class=\"keyword\">return</span> obj &amp;&amp; obj.__esModule ? obj : &#123; <span class=\"attr\">default</span>: obj &#125;; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> key = <span class=\"string\">'babel'</span>;</span><br><span class=\"line\"><span class=\"keyword\">var</span> obj = (<span class=\"number\">0</span>, _defineProperty3.default)(&#123;&#125;, key, <span class=\"string\">'foo'</span>);</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"不足\"><a href=\"#不足\" class=\"headerlink\" title=\"不足\"></a>不足</h3><p><code>babel-runtime</code> 不能转码实例方法，比如这样的代码：<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">'!!!'</span>.repeat(<span class=\"number\">3</span>);</span><br><span class=\"line\"><span class=\"string\">'hello'</span>.includes(<span class=\"string\">'h'</span>);</span><br></pre></td></tr></table></figure></p>\n<p>这只能通过 babel-polyfill 来转码，因为 babel-polyfill 是直接在原型链上增加方法。</p>\n<h2 id=\"And-more\"><a href=\"#And-more\" class=\"headerlink\" title=\"And more\"></a>And more</h2><p>随着历史进程的发展，新一代的 <a href=\"https://github.com/babel/babel/tree/master/packages/babel-preset-env\" target=\"_blank\" rel=\"noopener\">babel-prenset-env</a> 很强大，了解一下😜</p>\n<h2 id=\"参考链接\"><a href=\"#参考链接\" class=\"headerlink\" title=\"参考链接\"></a>参考链接</h2><ul>\n<li><a href=\"https://blog.zfanw.com/babel-js/#x3-babel-runtime\" target=\"_blank\" rel=\"noopener\">babel 教程</a></li>\n<li><a href=\"https://github.com/brunoyang/blog/issues/20\" target=\"_blank\" rel=\"noopener\">Babel 全家桶 · Issue #20 · brunoyang/blog · GitHub</a></li>\n<li><a href=\"https://babeljs.io/docs/plugins/transform-runtime/\" target=\"_blank\" rel=\"noopener\">Runtime transform · Babel</a></li>\n<li><a href=\"https://babeljs.io/docs/usage/polyfill/#usage-in-node--browserify--webpack\" target=\"_blank\" rel=\"noopener\">Polyfill · Babel</a></li>\n</ul>\n<p>自由转载-非商用-非衍生-保持署名（<a href=\"https://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh\" target=\"_blank\" rel=\"noopener\">创意共享3.0许可证</a>）</p>\n","categories":[],"tags":["Babel"]},{"title":"谈谈 react 中的 key","url":"http://billqiu.github.io/2018/01/25/key-in-react/","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p><img src=\"http://img.souche.com/f2e/cf0f9218d8effa21cf4d291a77db6c7c.jpg\" alt=\"key-warn\"></p>\n<p>如果你用过 react，并且曾经尝试遍历数组来渲染一个组件，就应该遇到过上面的提示。因为提示的等级为 <strong>Warning</strong>，而非 Error，所以很多开发同学可能就不会去在意，包括我自己。在前几天开发一个需要动态渲染的组件时，才发现的了 key 的妙用，也因此打算研究下 key 到底是干什么用的。</p>\n<h2 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h2><blockquote>\n<p>  Keys help React identify which items have changed, are added, or are removed. Keys should be given to the elements inside the array to give the elements a <strong>stable</strong> identity.</p>\n</blockquote>\n<p>key 是用来帮助 react 识别哪些内容被更改、添加或者删除。key 需要写在用数组渲染出来的元素内部，并且需要赋予其一个<strong>稳定</strong>的值。稳定在这里很重要，因为如果 key 值发生了变更，react 则会触发 UI 的重渲染。这是一个非常有用的特性。</p>\n<h3 id=\"key-的唯一性\"><a href=\"#key-的唯一性\" class=\"headerlink\" title=\"key 的唯一性\"></a>key 的唯一性</h3><p>在相邻的元素间，key 值必须是唯一的，如果出现了相同的 key，同样会抛出一个 Warning，告诉相邻组件间有重复的 key 值。并且只会渲染第一个重复 key 值中的元素，因为 react 会认为后续拥有相同 key 的都是同一个组件。</p>\n<h3 id=\"key-值不可读\"><a href=\"#key-值不可读\" class=\"headerlink\" title=\"key 值不可读\"></a>key 值不可读</h3><p>虽然我们在组件上定义了 key，但是在其子组件中，我们并没有办法拿到 key 的值，因为 key 仅仅是给 react 内部使用的。如果我们需要使用到 key 值，可以通过其他方式传入，比如将 key 值赋给 id 等。</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">arr.map(<span class=\"function\"><span class=\"params\">item</span> =&gt;</span> &lt;Component key=&#123;item.id&#125; id=&#123;item.id&#125; /&gt;)</span><br></pre></td></tr></table></figure>\n<h2 id=\"反模式\"><a href=\"#反模式\" class=\"headerlink\" title=\"反模式\"></a>反模式</h2><p>很多时候，我们可能并没有在遍历数组渲染组件的时候写上 key 的习惯，因为除了控制台报到一个 Warning，并不会有任何影响。因为赋 key 值这一步 react 帮我们做了，默认使用的是遍历过程中的 index 值。</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> arr = [<span class=\"string\">'first'</span>, <span class=\"string\">'second'</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// list1 和 list2 是等价的</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> list1 = arr.map(<span class=\"function\"><span class=\"params\">item</span> =&gt;</span> &lt;p&gt;&#123;item&#125;&lt;<span class=\"regexp\">/p&gt;);</span></span><br><span class=\"line\"><span class=\"regexp\">const list2 = arr.map((item, index) =&gt; &lt;p key=&#123;index&#125;&gt;&#123;item&#125;&lt;/</span>p&gt;);</span><br></pre></td></tr></table></figure>\n<p> 在上面的例子中，如果数组发生了变化，我们需要在数组的末尾插入一个元素 <code>arr.push(&#39;third&#39;)</code>，react 经过 diff 后就会发现 ：key 值为0和1的元素并没有发生如何变化，所以 react 会认为， 最后需要在 UI 上发生变更，仅仅是插入一个 key 值为2的新元素。</p>\n<p>但是如果我们在数组的开头插入了一个新元素<code>arr.unshift(&#39;zero&#39;)</code>，react 经过 diff 后就会发现每一个元素的 key 值都发生了变化，也是就说每个元素都要重新渲染一次，虽然从结果来看，仅仅是在开头添加了一个元素而已。如果负责渲染的数组数据量较大的话，则会对性能造成较大的影响。与 react 使用的启发式算法是相悖的。</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- before --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span> <span class=\"attr\">key</span>=<span class=\"string\">\"0\"</span>&gt;</span>first<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span> <span class=\"attr\">key</span>=<span class=\"string\">\"1\"</span>&gt;</span>second<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- after --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span> <span class=\"attr\">key</span>=<span class=\"string\">\"0\"</span>&gt;</span>zero<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span> <span class=\"attr\">key</span>=<span class=\"string\">\"1\"</span>&gt;</span>first<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span> <span class=\"attr\">key</span>=<span class=\"string\">\"2\"</span>&gt;</span>second<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>因此，推荐的做法是每个兄弟元素都加上一个稳定唯一的 key 值。</p>\n<h2 id=\"应用\"><a href=\"#应用\" class=\"headerlink\" title=\"应用\"></a>应用</h2><p>主要应用在 <strong>dynamic stateful components</strong>中，也就是需要动态渲染的子组件。</p>\n<p>下图是一个名为 <code>Filters</code>的组件，内部由一个个<code>condition</code>子组件组成，由 <code>defaultValue</code>负责初始化渲染。<code>defaultValue</code>的值可由组件生成，可以通过 <code>onChange</code>事件获取，默认不传为空数组。通过将之前保存好的值回传给组件，即可渲染需要的 <code>Filters</code>。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> defalutValue = [&#123;</span><br><span class=\"line\">  id: <span class=\"number\">1515134128441</span>,</span><br><span class=\"line\">  tag: <span class=\"string\">'mobile'</span>,\t<span class=\"comment\">// 手机号 决定最后需要使用的 input 输入框</span></span><br><span class=\"line\">  flag: [</span><br><span class=\"line\">    <span class=\"string\">'身份标签'</span>,</span><br><span class=\"line\">    <span class=\"string\">`&#123;\"code\":\"location_province_code\",\"valueType\":\"area_province\"&#125;`</span></span><br><span class=\"line\">  ],                <span class=\"comment\">// 决定第一级 级联选框 的默认值</span></span><br><span class=\"line\">  operator: <span class=\"string\">\"neq\"</span>,  <span class=\"comment\">// 操作符</span></span><br><span class=\"line\">  target: <span class=\"string\">\"00001\"</span>   <span class=\"comment\">// input 输入框的值</span></span><br><span class=\"line\">&#125;, &#123;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">&#125;]</span><br></pre></td></tr></table></figure>\n<p><img src=\"http://img.souche.com/f2e/88f2b0b7f99e637d275b49c4addd1c38.jpg\"></p>\n<p>这里遇到的问题是，<code>condition</code> 子组件的内部已经比较复杂了，需要处理多种情况：</p>\n<ol>\n<li>默认值的渲染</li>\n<li>不同筛选条件要对应不同的赋值符以及条件框</li>\n<li>按照级联的逻辑，父级的变更需要判断子级的状态是否需要改变</li>\n</ol>\n<p>在上述情况中，如果<code>condition</code>要实现接收不同的默认值来展示不同的效果，则需要写一系列复杂的 <code>componentWillReceiveProps</code>生命周期。而且不能保证代码的可读性以及维护性，是一个很可怕的事情。</p>\n<p>但是，如果你在用 <code>defaultValue</code>渲染每个 <code>Condition</code> 的时候，给它加一个唯一稳定的 key 值，就可以完美解决这个问题。我在实现的过程中，用了当前时间戳作为<code>Condition</code>的 key 值，保证其唯一稳定性。在删除、增加标签都能确保正确渲染。如果没有 key 值也没有写<code>componentWillReceiveProps</code>生命周期，在删除的时候就会发生渲染错误。</p>\n<p>简而言之，改变 key 值来重渲染组件是一种——相较于复杂<code>componentWillReceiveProps</code>生命周期——十分低成本的方式。</p>\n<h2 id=\"参考链接\"><a href=\"#参考链接\" class=\"headerlink\" title=\"参考链接\"></a>参考链接</h2><ul>\n<li><a href=\"https://juejin.im/post/59abb01c518825243f1b6dad\" target=\"_blank\" rel=\"noopener\">[React技术内幕] key带来了什么</a></li>\n<li><a href=\"https://reactjs.org/docs/lists-and-keys.html\" target=\"_blank\" rel=\"noopener\">List and Keys</a></li>\n</ul>\n","categories":[],"tags":["react","js","key"]},{"title":"解决在 IOS 上 使用 Charles 抓取 HTTPS 请求失败的问题","url":"http://billqiu.github.io/2017/12/13/charles-failed-to-get-https-request/","content":"<h2 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h2><p>在看了一大堆教程，配置好 Charles 和 iPhone 后，还是无法解析 HTTPS 请求。证书，ip 地址，端口号，白名单，字符编码，能做的都做了，还是没有一点头绪。</p>\n<p>其实这个问题的解决方案很简单，但是网上搜了很多，都找不到一篇合适的中文教程，所以在这里给各位想在 iPhone 上，用 Charles 抓取并解析 HTTPS 请求的同学指一条明路。</p>\n<p>在 IOS 10.3 版本之后，新增了一条安全策略。单单在 iPhone 上安装 Charles 证书是不够的，因为安装证书之后，默认是关闭，需要通过以下路径打开才可以捕获并解析 HTTPS 请求：</p>\n<blockquote>\n<p>Settings &gt; General &gt; About &gt; Certificate Trust Settings &gt; Toggle the cert to on.<br>设置 &gt; 通用 &gt; 关于 &gt; 证书信任设置 &gt; 启用证书</p>\n</blockquote>\n<p>对，就是这么简单，至于如何使用 Charles 在 iPhone 上抓包，网上教程有很多，这里就不在展开了。</p>\n<h2 id=\"参考链接\"><a href=\"#参考链接\" class=\"headerlink\" title=\"参考链接\"></a>参考链接</h2><p><a href=\"https://stackoverflow.com/questions/43462511/charles-failed-to-get-https-requests\" target=\"_blank\" rel=\"noopener\">Charles failed to get https requests</a></p>\n","categories":[],"tags":["charles"]},{"title":"JavaScript 中的浅拷贝与深拷贝","url":"http://billqiu.github.io/2017/11/05/shallow-clone-vs-deep-clone-in-js/","content":"<ul>\n<li><h3 id=\"cloneDeep-value\"><a href=\"#cloneDeep-value\" class=\"headerlink\" title=\"_.cloneDeep(value)\"></a><code>_.cloneDeep(value)</code></h3></li>\n<li><p>object.nodeType</p>\n</li>\n</ul>\n","categories":[],"tags":["js","cocy"]},{"title":"在 react 组件中使用 debounce 函数","url":"http://billqiu.github.io/2017/10/15/how-to-debounce-in-react/","content":"<h2 id=\"什么是-debounce\"><a href=\"#什么是-debounce\" class=\"headerlink\" title=\"什么是 debounce\"></a>什么是 debounce</h2><p><strong>debounce</strong>，中文翻译为防抖。与之相对应的还有一个概念 <strong>throttle</strong> —— 节流。两者用来控制某个函数在一定时间内执行多少次的技巧，相似却又不同。</p>\n<p>关于两者的对比以及使用场景，可以阅读这篇<a href=\"https://css-tricks.com/debouncing-throttling-explained-examples/\" target=\"_blank\" rel=\"noopener\">文章</a>来加深了解。本文主要讲述的，是如果在 <code>react components</code> 中，使用 <code>debounce</code> 函数来防止回调事件的多次触发，从而提升代码效率。</p>\n<h2 id=\"应用\"><a href=\"#应用\" class=\"headerlink\" title=\"应用\"></a>应用</h2><p>在一个 <code>input</code> 输入框中，给其绑定了一个 <code>onChange</code> 事件，每次输入后，都会触发一个回调函数。因为我们想要的只是用户输入的最后结果，所以除了用户输入完成后触发的回调函数，其他都是冗余的。因此，需要对绑定的回调函数做 <code>debounce</code> 处理。</p>\n<p>关于  <code>debounce</code> 函数，有很多实现版本，这里选用了 <code>loadsh.debounce</code>。虽然函数实现原理很简单，但是用于生产环境的代码，还是建议使用成熟的第三方库。</p>\n<p>我们的第一反应，一般都是直接将回调函数用 <code>debounce</code> 包裹起来达到想要的效果。</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> react, &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">'react'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; debounce &#125; <span class=\"keyword\">from</span> <span class=\"string\">'lodash.debounce'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Debounce</span> <span class=\"keyword\">extends</span> <span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  printChange(e) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'value :: '</span>, e.target.value);</span><br><span class=\"line\">    <span class=\"comment\">// call ajax</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (</span><br><span class=\"line\">      &lt;div&gt;</span><br><span class=\"line\">        &lt;input onChange=&#123;debounce(<span class=\"keyword\">this</span>.printChange, <span class=\"number\">500</span>)&#125; /&gt;</span><br><span class=\"line\">      &lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    );</span></span><br><span class=\"line\"><span class=\"regexp\">  &#125;</span></span><br><span class=\"line\"><span class=\"regexp\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>但是这么做之后，浏览器就会报异常： <code>Uncaught TypeError: Cannot read property &#39;value&#39; of null</code>。为什么会这样？这里就涉及到了 <code>react</code> 事件系统 中的一个概念：合成事件。</p>\n<h3 id=\"合成事件（SyntheticEvent）\"><a href=\"#合成事件（SyntheticEvent）\" class=\"headerlink\" title=\"合成事件（SyntheticEvent）\"></a>合成事件（SyntheticEvent）</h3><p>事件处理程序通过 合成事件（SyntheticEvent）的实例传递，<code>SyntheticEvent</code> 是浏览器原生事件跨浏览器的封装。<code>SyntheticEvent</code> 和浏览器原生事件一样有 <code>stopPropagation()</code>、<code>preventDefault()</code> 接口，而且这些接口夸浏览器兼容。</p>\n<h3 id=\"事件池（Event-Pooling）\"><a href=\"#事件池（Event-Pooling）\" class=\"headerlink\" title=\"事件池（Event Pooling）\"></a>事件池（Event Pooling）</h3><p><code>SyntheticEvent</code> 是池化的. 这意味着 <code>SyntheticEvent</code> 对象将会被重用，并且所有的属性都会在事件回调被调用后被    nullified。 这是因为性能的原因。 因此,你不能异步的访问事件。</p>\n<p>通过了解事件系统，也就不难理解为什么会报错了。因为经过 <code>debounce</code> 包装后的回调函数，变成了一个异步事件，在池化后被 nullified 了。</p>\n<p>那么怎样才能解决这个问题？</p>\n<p>通过在回调事件顶部加上 <code>e.persist()</code> 就可以从池中移除合成事件，并允许对事件的引用保留。</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> react, &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">'react'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; debounce &#125; <span class=\"keyword\">from</span> <span class=\"string\">'lodash.debounce'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Debounce</span> <span class=\"keyword\">extends</span> <span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  printChange(e) &#123;</span><br><span class=\"line\">    e.persist();</span><br><span class=\"line\">    debounce(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"built_in\">console</span>.log(<span class=\"string\">'value :: '</span>, e.target.value);</span><br><span class=\"line\">      <span class=\"comment\">// call ajax</span></span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (</span><br><span class=\"line\">      &lt;div&gt;</span><br><span class=\"line\">        &lt;input onChange=&#123;<span class=\"keyword\">this</span>.printChange&#125; /&gt;</span><br><span class=\"line\">      &lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    );</span></span><br><span class=\"line\"><span class=\"regexp\">  &#125;</span></span><br><span class=\"line\"><span class=\"regexp\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>这样做之后报错问题虽然解决了，但是会发现 <code>debounce</code> 的函数并没有被执行。因此，还需要对回调函数进行优化。</p>\n<p>把需要异步执行的回调函数抽离出来封装，并且在组件初始化话的时候就将其 <code>debounce</code> 化，就可以得到我们想要的效果。</p>\n<figure class=\"highlight jsx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> react, &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">'react'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; debounce &#125; <span class=\"keyword\">from</span> <span class=\"string\">'lodash.debounce'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Debounce</span> <span class=\"keyword\">extends</span> <span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  construtor() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">super</span>();</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.callAjax = debounce(<span class=\"keyword\">this</span>.callAjax, <span class=\"number\">300</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">  callAjax = <span class=\"function\">(<span class=\"params\">value</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'value :: '</span>, value);</span><br><span class=\"line\">    <span class=\"comment\">// call ajax</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  printChange(e) &#123;</span><br><span class=\"line\">    e.persist();</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.callAjax(e.target.value);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (</span><br><span class=\"line\">      &lt;div&gt;</span><br><span class=\"line\">        &lt;input onChange=&#123;<span class=\"keyword\">this</span>.printChange&#125; /&gt;</span><br><span class=\"line\">      &lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    );</span></span><br><span class=\"line\"><span class=\"regexp\">  &#125;</span></span><br><span class=\"line\"><span class=\"regexp\">&#125;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"参考文章\"><a href=\"#参考文章\" class=\"headerlink\" title=\"参考文章\"></a>参考文章</h2><ul>\n<li><a href=\"https://github.com/hanzichi/underscore-analysis/issues/20\" target=\"_blank\" rel=\"noopener\">JavaScript 函数节流和函数去抖应用场景辨析 · Issue #20 · hanzichi/underscore-analysis · GitHub</a></li>\n<li><a href=\"https://css-tricks.com/debouncing-throttling-explained-examples/\" target=\"_blank\" rel=\"noopener\">Debouncing and Throttling Explained Through Examples</a></li>\n<li><a href=\"https://reactjs.org/docs/events.html\" target=\"_blank\" rel=\"noopener\">SyntheticEvent</a></li>\n</ul>\n","categories":[],"tags":["react","debounce"]},{"title":"建立自己的时间管理系统","url":"http://billqiu.github.io/2016/11/20/建立自己的时间管理系统/","content":"<p>本文启发自<a href=\"https://www.zhihu.com/people/jiaji-deng\" target=\"_blank\" rel=\"noopener\">胖子邓</a>知乎LIVE——<a href=\"https://www.zhihu.com/lives/769214248550166528\" target=\"_blank\" rel=\"noopener\">建立专属的时间管理系统</a>，如果你想了解更多关于时间管理的方法，建议参加LIVE学习。</p>\n<h3 id=\"记录时间\"><a href=\"#记录时间\" class=\"headerlink\" title=\"记录时间\"></a>记录时间</h3><p>在有事做的时候，经常听到有人会抱怨自己很忙，而你让他总结下自己究竟干了哪些事，却又说不上来了。这样的情况时有发生，如此下去必然会造成一个恶性循环，更加严重的是很多人都没有意识到这个问题的存在。</p>\n<p>为了解决这个问题，我们可以尝试使用<strong>柳比歇夫时间记录法</strong>来记录自己每天的有效工作时间时多少。</p>\n<p><img src=\"/assets/blogImg/柳比歇夫.png\" alt=\"柳比歇夫\"></p>\n<a id=\"more\"></a>\n<p>需要注意的是，我们记录的<strong>纯粹</strong>的工作时间，而不是把每一件琐碎的小事都记录下来。千万不要陷入强迫症的误区，找到适合自己的记录方式，不要刻意去追求完美和完善。这样，我们就能清楚的知道我们每天都干了什么，有效工作总时间时多少。</p>\n<h3 id=\"时间的分配\"><a href=\"#时间的分配\" class=\"headerlink\" title=\"时间的分配\"></a>时间的分配</h3><p>在每天晚上，我都会回顾今天都做了什么，然后列出明日的待办事项。如果你要做的事很多，但是你又无法理清先后顺序，建议你使用四象限工作法则。应该优先处理紧急的事情。</p>\n<p><img src=\"/assets/blogImg/四象限.png\" style=\"width: 336px;\"></p>\n<h4 id=\"碎片化时间\"><a href=\"#碎片化时间\" class=\"headerlink\" title=\"碎片化时间\"></a>碎片化时间</h4><p>我们每天都会有很多碎片化的时间，比如上下班的途中，有人使用的是公共交通，那我们可以选择用这段时间来看书，而不是漫无目的的翻看你的手机。对于这段时间的利用，也是因人而异：有的人认为地铁或公交车的环境太嘈杂，自己根本看不进去书，那你其实可以做一些只需要低专注度就可以完成的事。比如看看邮件、TED或者网易公开课等。</p>\n<p><img src=\"/assets/blogImg/专注度.png\" alt=\"专注度\"></p>\n<p>每个人的专注度和要做的事都不一样，你可以根据上表列出自己的表格，然后利用你的碎片化时间完成你想要做的事。对于这些事情，其实非常适合在碎片化的时间段里去完成，如果你用大把时间去做反而会觉得很浪费。</p>\n<h3 id=\"当你对自己的安排感到焦虑\"><a href=\"#当你对自己的安排感到焦虑\" class=\"headerlink\" title=\"当你对自己的安排感到焦虑\"></a>当你对自己的安排感到焦虑</h3><p>每个人的时间管理系统都有一个循序渐进完善的过程，我的方法并不一定适合你，因此一段时间后你也许会产生焦虑感，感觉自己的时间又浪费过去了。这个时候千万不要放弃，希望你能从一个局外人的角度看看是哪里出了问题，应该如何改进。也可以去看看一些你心里崇拜的人的传记，你遇到的问题如果在他们身上也出现过，相信一定能给你很大的启发。</p>\n<p>End</p>\n","categories":[],"tags":["时间管理","LIVE","总结"]},{"title":"每个人心里都住着一只搞事的猴子","url":"http://billqiu.github.io/2016/11/05/每个人心里都住着一只搞事的猴子/","content":"<p><img src=\"/assets/blogImg/monster.png\" alt=\"monter\"></p>\n<blockquote>\n<p><strong>延宕</strong>（<a href=\"https://zh.wikipedia.org/wiki/%E8%8B%B1%E8%AA%9E\" target=\"_blank\" rel=\"noopener\">英语</a>：procrastination）指一种个性行为，即将所计划执行的任务推迟到稍后时间，亦被通常地和广泛地称作“拖延症”。延宕者通常会对开始或完成任何任务或决定感到<a href=\"https://zh.wikipedia.org/wiki/%E7%84%A6%E6%85%AE\" target=\"_blank\" rel=\"noopener\">焦虑</a>，而将延宕作为应付<a href=\"https://zh.wikipedia.org/wiki/%E7%84%A6%E6%85%AE\" target=\"_blank\" rel=\"noopener\">焦虑</a>的一种机制。     ——Wikipedia</p>\n</blockquote>\n<p>你有<strong>拖延症</strong>吗？</p>\n<ul>\n<li>每当我遇到一个难题，稍有进展的时候，就会告诉我自己‘这个问题原来这么简单啊，先去做点其他事再来解决吧’。</li>\n<li>每到周末结束的时候，总会有焦虑感伴随着我，因为我发现还有好多事没做。</li>\n<li>当我把一个问题在脑海中想清楚之后，总会觉得我已经把这个问题解决了，而不去付诸实践。</li>\n<li>你自认是一个完美主义者，你觉得这件事你还没有完全像清楚，所以你j觉得你不应该去做。</li>\n</ul>\n<p>如果以上情况同样在你身上也发生过，我想告诉你，你也许也是一个拖延症患者。</p>\n<a id=\"more\"></a>\n<p>在正常人的脑海中，只存在一个理性决策人，那就是你自己。但是拖延症患者的脑海中，有一点点不同——还住着一只搞事的猴子。</p>\n<p><img src=\"/assets/blogImg/normal.png\" alt=\"normal\"></p>\n<p>这对拖延症患者意味着什么呐？这意味着平时没什么两样，但是一旦发生情况…</p>\n<p><img src=\"/assets/blogImg/happen.png\" alt=\"happen\"></p>\n<p>猴子就会占据完全的主导权。</p>\n<p>他会抢过我们手中方向盘，告诉我们：</p>\n<p>快去看看最近有什么新电影啊？</p>\n<p>知乎上是不是又有人在撕逼了？</p>\n<p>看看微信有没有人联系你啊？</p>\n<p>……</p>\n<p>就这样，我们完全偏离了原来的航向。</p>\n<p>所以，到底发生了什么呐？这个搞事的猴子并不是你希望控制方向盘的人，他完全活在当下，没有过去的记忆，没有未来的概念，他只关心两件事：简单和开心。在动物界，这完全没有什么错，如果你是一条狗，一辈子只追求简单和快乐的事，那就是巨大的成功了！但有些时候，从长远的角度看，一些困难和不开心的事，才是合理的事。</p>\n<p>在猴子把控方向盘期间，我们做了一些本不应该在当时进行的休闲活动，但是你会发现这些事并没有让你感到快乐，反而放你充满了内疚、恐惧和焦虑，这些都是拖延症患者常有的情绪。那么问题来了，我们何时才能自己把控回方向盘呐？</p>\n<p>这还得靠另一个角色——尖叫怪兽——搞事猴子的唯一克星。他一般处于休眠状态，但当截止日期临近、或者有当众出丑的危险时，他就会突然苏醒，大吼一声把猴子吓走，让我们重新获得主导权，去防止那些我们不希望出现的结果。</p>\n<p><img src=\"/assets/blogImg/return.png\" alt=\"return\"></p>\n<p>以上的三个角色就构成了拖延症系统，虽然并不美好，但是也有效果。既然拖延症或者的系统是有效果的，但是到底哪里不对呐？原来，拖延症分为两种，一种是有<strong>截止日期</strong>的，而另一种是没有截止日期的。如果有截止日期，拖延的影响会被限制在一定的时期内，因为后期会有尖叫怪兽的出现。但是另一种，这种拖延是没有截止日期：</p>\n<blockquote>\n<ul>\n<li>你想学习一门艺术，或者去创业，因为开始不会有什么变化的，直到你拼尽全力，才会有一点起色，你才能看到进展。</li>\n<li>比如看望家人</li>\n<li>比如锻炼身体</li>\n<li>比如保持健康</li>\n<li>比如维系感谢</li>\n<li>……</li>\n</ul>\n</blockquote>\n<p>如果你觉得拖延症患者处理这些苦难的唯一机制是尖叫怪兽的话，那就有很大问题了，因为在以上情况是没有截止日期的，尖叫怪兽并不会出现，所以以上拖延症带来的后果是没有限制的，它们会不断延伸。和短时间的拖延相比，这些长时间的拖延更不容易被人发现，也很少被人提及，它长时间折磨着人们，可以说是抑郁和悔恨的根源。让他们难过的其实不是没有实现梦想，而是更本就没有开始追寻过梦想。这也导致了为什么有人看上去每天都兢兢业业，但是到头来一事无成。</p>\n<p>从长时间拖延的角度来看，非拖延症患者是不存在的，<strong>每个人</strong>都有拖延症!</p>\n<p>也许有人会反驳：‘不会啊，我一直都能很好的按时完成任务’，这也许只是因为你和截止日期保持着良性关系。搞事猴子最狡猾的伎俩，发生在没有截止日期的时候。我们应该好好想想，我们真正在拖延的是什么？或许我们今天就应该行动起来。</p>\n<p><strong>或许不一定是今天，而是。。。</strong></p>\n<h2 id=\"参考链接\"><a href=\"#参考链接\" class=\"headerlink\" title=\"参考链接\"></a>参考链接</h2><ul>\n<li><p><a href=\"http://open.163.com/movie/2016/3/Q/E/MBHQSM52F_MBI15O7QE.html\" target=\"_blank\" rel=\"noopener\">你有拖延症吗?</a></p>\n<p>​</p>\n</li>\n</ul>\n","categories":[],"tags":["拖延症","TED","网易公开课"]},{"title":"如何使用git tag","url":"http://billqiu.github.io/2016/10/31/如何使用git-tag/","content":"<h2 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h2><blockquote>\n<p>对某一时间点上的版本打上标签。</p>\n</blockquote>\n<a id=\"more\"></a>\n<h2 id=\"用法\"><a href=\"#用法\" class=\"headerlink\" title=\"用法\"></a>用法</h2><ol>\n<li><p>列出所有标签 <code>git tag</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> git tag</span><br><span class=\"line\">v0.1</span><br><span class=\"line\">v1.3</span><br></pre></td></tr></table></figure>\n<p>显示的标签按字母顺序排列，所以标签的先后并不表示重要程度的轻重。</p>\n</li>\n<li><p>新建标签</p>\n<p>打标签的方式分2种，轻量级的（lightweight）和含附注的（annotated）。</p>\n<ul>\n<li><p>轻量级：直接给出标签名字即可</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> git tag v0.1</span><br><span class=\"line\"><span class=\"meta\">$</span> git tag</span><br><span class=\"line\">v0.1</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>含附注的标签</p>\n<p><code>-a</code>(<code>annotated</code> 的首字母)</p>\n<p><code>-m</code>(指定了对应的标签说明)</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> git tag -a v1.4 -m 'my version 1.4'</span><br><span class=\"line\"><span class=\"meta\">$</span> git tag</span><br><span class=\"line\">v1.4</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p>查看相应标签的版本信息 <code>git show</code></p>\n<p>上面我们打了一个v1.4版本的节点，就可以查看这个打点节点的信息。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> git show v1.4</span><br><span class=\"line\">tag v1.4</span><br><span class=\"line\">Tagger: Scott Chacon &lt;schacon@gee-mail.com&gt;</span><br><span class=\"line\">Date:   Mon Feb 9 14:45:11 2009 -0800</span><br><span class=\"line\"></span><br><span class=\"line\">my version 1.4</span><br><span class=\"line\"></span><br><span class=\"line\">commit 15027957951b64cf874c3557a0f3547bd83b3ff6</span><br><span class=\"line\">Merge: 4a447f7... a6b4c97...</span><br><span class=\"line\">Author: Scott Chacon &lt;schacon@gee-mail.com&gt;</span><br><span class=\"line\">Date:   Sun Feb 8 19:02:46 2009 -0800</span><br><span class=\"line\"></span><br><span class=\"line\">    Merge branch 'experiment'</span><br></pre></td></tr></table></figure>\n<p>​</p>\n</li>\n<li><p>分享标签 <code>git push</code></p>\n<p>默认情况下，<code>git push</code> 并不会把标签传送到远端服务器上，只有通过显式命令才能分享标签到远端仓库。其命令格式如同推送分支，运行 <code>git push origin [tagname]</code> 即可：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> git push origin v1.5</span><br></pre></td></tr></table></figure>\n<p>如果要一次推送所有本地新增的标签上去，可以使用 <code>--tags</code> 选项：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> git push origin --tags</span><br></pre></td></tr></table></figure>\n<p>一般来说，代码有较大的变化或者有重要功能更新的时候，才会将标签共享。</p>\n</li>\n<li><p>删除本地标签<code>git tag -d [tagname]</code></p>\n<p>删除远端标签<code>git push origin :[tagname]</code></p>\n</li>\n<li><p>标签命名</p>\n<p>v&lt;大版本号&gt;-&lt;小版本号&gt;-&lt;补丁修复&gt;</p>\n<p><code>v</code>代表version，当有一个BUG修复后，增加补丁修复号。</p>\n<p>当有功能更新，增加小版本号。</p>\n<p>当有多个功能更新，增加大版本号。</p>\n</li>\n</ol>\n<h2 id=\"使用场景\"><a href=\"#使用场景\" class=\"headerlink\" title=\"使用场景\"></a>使用场景</h2><p>在这里，我们只对master打标签。当版本处于稳定后，就对master打上一个标签。方便自己也方便他人以后修改阅读代码。</p>\n","categories":[],"tags":["git","tag"]},{"title":"如何提高代码的可维护性","url":"http://billqiu.github.io/2016/09/25/如何提高代码的可维护性/","content":"<p>在当下这个产品快速迭代的时代，分分钟一个新需求，动不动就改页面，如果在前期写代码的时候没有没有为后续的拓展做准备的话，简直能把一个程序员给玩死。</p>\n<p>所以在本次项目中，总结了几点经验心得好让自己少被玩死几次。</p>\n<h3 id=\"善用git\"><a href=\"#善用git\" class=\"headerlink\" title=\"善用git\"></a>善用git</h3><p><code>git</code>是个好东西，提供了一套完整的代码管理方案。能让你随时将代码回滚到你想要的位置，当然前提是你拥有良好的提交代码的习惯。基于当下前端最流行的最佳化开发方式，我的建议是每开发完成一个组件就提交一次代码，让你代码的模块划分更加清晰。</p>\n<h3 id=\"页面布局的可拓展性\"><a href=\"#页面布局的可拓展性\" class=\"headerlink\" title=\"页面布局的可拓展性\"></a>页面布局的可拓展性</h3><p>flex布局大法好，但是总是逃不过“兼容性”这个老生常谈的问题的魔爪。可以用flex布局当时舒爽，但是一定要考虑清楚应用环境。如果你全盘使用flex布局，当遇需要兼容的情况时，重新布局带给你的代码了是不是你所能接受的。</p>\n<h3 id=\"封装多次调用的函数\"><a href=\"#封装多次调用的函数\" class=\"headerlink\" title=\"封装多次调用的函数\"></a>封装多次调用的函数</h3><p>这点很重要，不仅仅是减少代码量的问题，如果一旦万一这个函数需要修改，你要做的不仅仅是一处的修改，而是所有用到这个函数的地方都要修改。人不是机器，不能做完美的全局检索，特备是在时间紧急代码量又大的情况下，难免会发生错误。</p>\n<h3 id=\"修改代码前要充分思考\"><a href=\"#修改代码前要充分思考\" class=\"headerlink\" title=\"修改代码前要充分思考\"></a>修改代码前要充分思考</h3><p>因为各种各样的原因有一个地方的代码需要作出修改，OK，这个地方改好了。但是，这是真的改好了，好好想想和其他地方的代码是不是有耦合，特别是对前后的代码逻辑是否会产生影响，真的只有这个地方的代码需要修改吗？</p>\n<h3 id=\"不要轻易删代码\"><a href=\"#不要轻易删代码\" class=\"headerlink\" title=\"不要轻易删代码\"></a>不要轻易删代码</h3><p>有时候我们会为了代码的漂亮干净就把以前写的不再需要的代码给删了，看上去趋势很爽，干净简洁。但是在删代码之前，一定要仔细想想这些代码以后是不是真的不会再用到了，自己当初为什么注释了这些代码而不是删除。删除的如果是页面的代码还好，如果删除了以后可能要用到的脚本代码，就要重新再跑一遍业务逻辑！删代码，爽一时啊！</p>\n<h3 id=\"遵从自己的思考\"><a href=\"#遵从自己的思考\" class=\"headerlink\" title=\"遵从自己的思考\"></a>遵从自己的思考</h3><p>在后期优化的时候，产品、交互、后端、测试可能会给你提出各种各样的问题，需要你去优化。这时候你就要对这些问题作出归纳整理，哪些是你可以做到的，哪些是你做不到的，哪些是你可以做到但当初没有这么做的，为什么没有做，是因为太费时费力，还是有其他原因，比如说会影响其他功能。</p>\n","categories":[],"tags":["维护性","迭代"]},{"title":"Connext2016 & 掘金线下交流会","url":"http://billqiu.github.io/2016/07/24/Connext2016-掘金线下交流会/","content":"<p>本周六参加了一场名为”Connext 2016 新一代青少年科技大会”的线下技术分享会。<br>真的，我该开始是没看到“青少年”三字的，不然我也可能就不会厚着脸皮去了= = 毕竟已经过了那个年纪。<br>但是通过这次线下的分享会，也算是涨了不少见识。</p>\n<p>一个高中刚毕业的IOS开发者，已在APP store上线了自己的项目，支持简繁体、英语、日语等语言，并且获得了1000元左右的收入。<br>一个95年的开发者，从农村走出来，到硅谷工作，薪资最高曾到25K，正在准备二次创业。<br>一个高中辍学的开发者，leancloud服务端工程师，技术大牛。<br>还有这次分享会的主办方，尽然是个还在美国读高中的中学生！</p>\n<p>听了他们的分享会，发现有很多人中学就开始接触计算机编程，并且都有很强的自我驱动能力。<br>和很多社会上参加培训班学习IT技能的人不一样，他们对技术是真心热爱。<br>从编程这个角度看，我感觉为了的中学教育也将会走向专业化。</p>\n<p>在此次分享中，很高兴认识了稀土掘金的CEO阴明。也是同样的前端汪出生，半路学的计算机。<br>很感谢明哥的指导，让我的职业道路更加清晰了一点。<br>也非常感谢今天的掘金线下交流会，又认识了很多技术大牛，最重要的是见到了“芋叔”，并做了一个重要的决定！</p>\n","categories":[],"tags":["Connext","稀土掘金","线下"]},{"title":"在mac上使用docker部署gitlab","url":"http://billqiu.github.io/2016/07/08/在mac上使用docker部署gitlab/","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>git，当下如日中天的版本控制工具。<br>无奈公司用的是SVN，在Cornerstone上用鼠标update、commit、Check Out实在不是很爽。但是有不想花时间去学习SVN命令，便打算在自己的mac上装个gitlab来协助自己平时的开发任务。</p>\n<p>之前我尝试安装gitlab已经好多次了，但是苦于自己的英语捉急，又没有很友好的中文文档，gitlab对mac的支持有限，多是针对linux的应用环境。</p>\n<p>后来无意中接触到了docker，一通摸索之后稍微摸着了点门道，也算是成功地部署了gitlab在自己的mac上。<br><a id=\"more\"></a></p>\n<h2 id=\"准备\"><a href=\"#准备\" class=\"headerlink\" title=\"准备\"></a>准备</h2><p>docker最近出了mac的beta版，可以想原生的mac APP一样使用，大大降低了部署的门槛，给个<a href=\"https://download.docker.com/mac/beta/Docker.dmg\" target=\"_blank\" rel=\"noopener\">传送门</a>。</p>\n<p>docker安装完成后，需要下载Docker镜像管理工具Kitematic并安装。<br><img src=\"/assets/blogImg/Kitematic.png\" alt=\"Kitematic\"></p>\n<h2 id=\"部署\"><a href=\"#部署\" class=\"headerlink\" title=\"部署\"></a>部署</h2><p>以上两个工具都安装好后，就进入正式部署的环节。<br>打开Kitematic，单击new，搜索gitlab-ce，看到第一个官方提供的镜像(image)，单击creat，Kitematic就会自动帮你部署gitlab所需要一切环境。<br><img src=\"/assets/blogImg/gitlab-ce.png\" alt=\"gitlab-ce.png\"></p>\n<p>部署完成后，Kitematic会出现下述页面，通过单击WEB PREVIEW中的箭头，可以跳转到浏览器管理已经部署好的gitlab。<br><img src=\"/assets/blogImg/gitlab-ce-ok.png\" alt=\"gitlab-ce-ok\"></p>\n<p>因为是第一次登陆，所以需要设置一个管理员密码。<br><img src=\"/assets/blogImg/gitlab-ce-login.png\" alt=\"gitlab-ce-login\"></p>\n<p>之后，在下面的注册框中注册完一个账号后就会自动登陆gitlab。在这里，你就可以随意把玩git了。<br><img src=\"/assets/blogImg/gitlab-ce-new.png\" alt=\"gitlab-ce-new\"><br><img src=\"/assets/blogImg/gitlab-in.png\" alt=\"gitlab-in\"></p>\n<h2 id=\"新建一个项目\"><a href=\"#新建一个项目\" class=\"headerlink\" title=\"新建一个项目\"></a>新建一个项目</h2><p>单击首页的New Project按钮进入一个新建项的页面，和github的页面大同小异。<br><img src=\"/assets/blogImg/gitlab-newproject.png\" alt=\"gitlab-newproject\"></p>\n<p>我新建了一个名为test的项目，下一步就需要把该项目clone到本地进行操作了。<br>在此之前，必须要设置好SSH KEY才可以push或者pull这个项目。<br>在项目页面中也给我们这个提示。<br>至于如何设置，用过github的同学肯定清楚，在gitlab中也给了我们很详细的提示，这里就不多说了。<br>有很重的要一点需要说下的是，在执行<code>clone</code>命令时，如果网址是通过localhost打开的，一定要把localhost换成本地的IP地址<code>127.0.0.1</code>，不然clone命令是会失败的。而且一定要在clone的地址后加上<code>.git</code>，不然在push代码的时候是会失败的。<br>举个例子：如果你当前项目的地址是<code>http://127.0.0.1:32772/bill/test</code><br>clone的时候需要改成<code>http://127.0.0.1:32772/bill/test.git</code>才可以。</p>\n<h2 id=\"小结\"><a href=\"#小结\" class=\"headerlink\" title=\"小结\"></a>小结</h2><p>因为我也是第一次接触docker，在部署方面的知识有限，对git的也只是会几个简单的命令，所以不能保证这个过程大家都可以顺利执行下来。如果错误，请多多包涵！</p>\n<p>参考文献：<br><a href=\"http://chrisrc.me/autoit/2016/05/12/autoit-gitlab-gitlab-ci-mac/\" target=\"_blank\" rel=\"noopener\">基于Docker搭建Gitlab/Gitlab CI测试环境</a></p>\n","categories":[],"tags":["git","gitlab","docker","部署"]},{"title":"浅谈line-height与vertical-align对行内元素位置的影响","url":"http://billqiu.github.io/2016/07/01/浅谈line-height与vertical-align对行内元素位置的影响/","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>前几天在做项目的时候，突然遇到了一个文字下沉的问题。设法通过各种途径解决，在慕课网看了张老师的<a href=\"http://www.imooc.com/learn/542\" target=\"_blank\" rel=\"noopener\">课程</a>后，终于恍然大悟，问题得以解决。<br>其实在看完课程后就想写篇博文来记录自己的学习收获，但是因为自己的拖延症一直拖到现在。庆幸的是当时做了比较详细的学习笔记，看看笔记还是能回忆起来一些。但是如果在学习完后能及时总结，收获肯定更大，能系统地描述自己的学习过程。<br>在此立个flag，以后学习完一个知识点后一定要及时总结回顾，一来能加深自己的理解，二来符合自己一贯推崇的“开源精神”。</p>\n<a id=\"more\"></a>\n<h2 id=\"line-height\"><a href=\"#line-height\" class=\"headerlink\" title=\"line-height\"></a>line-height</h2><p>定义：两行文字基线之间的距离。</p>\n<p>那么问题来了，什么是基线？<br>用过英文写字本的童鞋应该都记得其中有一条红色的线，那条就是所谓的基线。<br>不同的字体基线所在的位置是不同的。<br>微软雅黑的基线与x的底部重合。<br><img src=\"/assets/blogImg/yahei.png\" alt=\"微软雅黑\"><br>而宋体和Arial字体则处于基线偏上的位置。<br><img src=\"/assets/blogImg/Arial.png\" alt=\"Arial.png\"></p>\n<p>应用<br>1、 使图片水平垂直居中<br>对父元素设置行高，注意是行高<code>line-height</code>而不是高度<code>height</code>，在子元素设置<code>vertical-align: middle</code>，图片就可实现垂直方向的居中。因为图片为<code>inline</code>水平的元素，所以为父元素设置<code>text-aline: center</code>即可实现水平居中。需要注意的一点是，此方法支持IE8及以上的浏览器。</p>\n<iframe height=\"265\" scrolling=\"no\" src=\"//codepen.io/bill_q/embed/wWqdaQ/?height=265&theme-id=dark&default-tab=result&embed-version=2\" frameborder=\"no\" allowtransparency=\"true\" allowfullscreen=\"true\" style=\"width: 100%;\">See the Pen <a href=\"http://codepen.io/bill_q/pen/wWqdaQ/\" target=\"_blank\" rel=\"noopener\">wWqdaQ</a> by bill (<a href=\"http://codepen.io/bill_q\" target=\"_blank\" rel=\"noopener\">@bill_q</a>) on <a href=\"http://codepen.io\" target=\"_blank\" rel=\"noopener\">CodePen</a>.<br></iframe>\n\n<p>2、 使多行文本水平垂直居中</p>\n<iframe height=\"265\" scrolling=\"no\" src=\"//codepen.io/bill_q/embed/JKyWzK/?height=265&theme-id=dark&default-tab=result&embed-version=2\" frameborder=\"no\" allowtransparency=\"true\" allowfullscreen=\"true\" style=\"width: 100%;\">See the Pen <a href=\"http://codepen.io/bill_q/pen/JKyWzK/\" target=\"_blank\" rel=\"noopener\">JKyWzK</a> by bill (<a href=\"http://codepen.io/bill_q\" target=\"_blank\" rel=\"noopener\">@bill_q</a>) on <a href=\"http://codepen.io\" target=\"_blank\" rel=\"noopener\">CodePen</a>.<br></iframe>\n\n<p>这里插一句，很多人为了让块级元素内的内容垂直居中，会吧高度和行高设置为相同的值。其实仅仅设置行高就可以达到想要的效果。</p>\n<h2 id=\"vertical-align\"><a href=\"#vertical-align\" class=\"headerlink\" title=\"vertical-align\"></a>vertical-align</h2><p>在上面的使用<code>vertical-align: middle</code>居中的例子中，如果你仔细看一下，其实是可以看出来此居中并非完全居中，而是近似居中。为什么呐？这和<code>vertical-align: middle</code>实现居中的原理有关：先看看<code>middle</code>的定义：</p>\n<blockquote>\n<p>元素中线与父元素的小写x中线对齐。</p>\n</blockquote>\n<p>但是在前面我们就说到了，每种字体都是有偏移量的，会相对于中线下沉或上移，所以导致了并不是绝对居中。偏移量的大小又受到字体大小的影响，<code>font-size</code>越大，偏移量越大。<br><img src=\"/assets/blogImg/move.png\" alt=\"move\"></p>\n<p>下面是一个很经典的例子。<br>默认状态下，图片和文字(不包括xbase)的<code>vertical-align</code>值都为baseline。细心的同学可能已经观察到了，在图片的下方，有一条几个像素的边，也就是说图片没有填充满整个容器，那么这条边是哪里来的呐？<br>其实就是vertical-align和line-height‘搞基’产生的。<br><img src=\"/assets/blogImg/line-height.png\" alt=\"line-height\"><br>如图一所示，图片的下边缘和小写字母x的下边缘是对齐的，也就是所谓的基线对齐。再对比图一和图二，图一中文字的<code>line-height</code>默认为<code>normal</code>，也就等于<code>height</code>为16px。图二的<code>line-height</code>为32px。这样就找出了问题所在的根源，在默认基线对齐的情况下，<code>line-height</code>影响了位置关系。<br>那么怎么样才能去除那条几个像素的边呐？<br>有两条思路：<br>1、 改变<code>vertical-align</code>对齐方式。<br>设置图片的<code>vertical-align</code>为middle、top、bottom；<br>在布局允许的情况下，可以改变图片的<code>display</code>水平为<code>block</code>，可以通过浮动、绝对定位等方法。<br>2、 修改<code>line-height</code>值。<br>将父元素的<code>line-height</code>设置为一个较小的值，直到边隙消失。<br>或者也可以改变父元素的<code>font-size</code>，因为<code>line-height</code>是根据<code>font-size</code>的大小决定的。</p>\n<p>这里有一个现象需要解释下，当图片的<code>vertical-align</code>设置为<code>top</code>时，发现文字上移和图片顶部对齐了。这又是为什么呢？<br>其实原理是这样的，图片为了和整行文字的顶部对齐而下移了，但是由于DOM元素都是向左向上对齐的，所以产生了一个盒子内整体内容上移的现象，看上去好像是文字上移和图片去对齐。<br>在同一个包含盒子(containing box)内，如果使用<code>vertical-align</code>对行框盒子(line boxes)的位置进行调整，其相互之间的位置是互不影响的。</p>\n<iframe height=\"265\" scrolling=\"no\" src=\"//codepen.io/bill_q/embed/jAmYKg/?height=265&theme-id=dark&default-tab=result&embed-version=2\" frameborder=\"no\" allowtransparency=\"true\" allowfullscreen=\"true\" style=\"width: 100%;\">See the Pen <a href=\"http://codepen.io/bill_q/pen/jAmYKg/\" target=\"_blank\" rel=\"noopener\">jAmYKg</a> by bill (<a href=\"http://codepen.io/bill_q\" target=\"_blank\" rel=\"noopener\">@bill_q</a>) on <a href=\"http://codepen.io\" target=\"_blank\" rel=\"noopener\">CodePen</a>.<br></iframe>\n\n<p>参考文献：</p>\n<ol>\n<li><a href=\"http://www.imooc.com/learn/542\" target=\"_blank\" rel=\"noopener\">慕课网</a></li>\n<li><a href=\"https://developer.mozilla.org\" target=\"_blank\" rel=\"noopener\">MDN</a></li>\n<li><a href=\"http://www.zhangxinxu.com/wordpress/2015/08/css-deep-understand-vertical-align-and-line-height/\" target=\"_blank\" rel=\"noopener\">张老师的博客</a></li>\n</ol>\n","categories":[],"tags":["vertical-align","line-height","行内元素","位置"]},{"title":"毕业。","url":"http://billqiu.github.io/2016/06/19/毕业。/","content":"<p>今天是2016年06月19日，是我正式毕业离校的日子。<br>我是寝室里第一个走的，虽然总以为我应该会是最后一个离开。<br>独自一人矗在空旷的寝室里，把寝室灯开了关，关了开，做一些我自己都不知道在干什么事。<br>回头看看，没有人在打游戏了。<br>来回走走，过道也不再拥挤。<br>空调可以随便我开到几度，哦不对，空调遥控器已经退还给学校了。<br>我可以随时上床睡觉，不会因为灯光太亮而无法闭眼，因为我可以把灯开了又关，关了又开。<br>可想象与现实终究是不同的，朱留在了金华工作，夏要出国留学，小凯要等教师资格证出成绩，而我因为要回杭州上班，便成了第一个离开的人。</p>\n<p>我的第一次住校献给了我的大学，而这一住就是四年。<br>刚开始也没有所谓的不适用，仅仅是换了个睡觉的地方而已。<br>而今离开却有诸多不适。</p>\n<p>在同一个校园之中，<br>大家的生活充满着交集。<br>而随着时间的推移，<br>会不会像歌里唱的那样，<br>各自奔前程的我们匆匆渐行渐远。<br>生儿育女，养家糊口。<br>渐渐地会成为大家生活的重心。<br>曾经的老同学现已天各一方。</p>\n<p>往往在失去的时候，<br>才知道珍惜。<br>明明懂晓这个道理，<br>也未曾去好好珍惜。</p>\n<p>因为有记忆的存在，<br>好似前不久才刚刚踏入校园，<br>今天尽然就要离开了。</p>\n<p>同学，朋友。<br>毕业，珍重！</p>\n","categories":[],"tags":["毕业","感言"]},{"title":"在无序列表li前增加圆点标识符的几种方式","url":"http://billqiu.github.io/2016/05/31/在无序列表li前增加原点标识符的几种方式/","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>在实际开发过程中，我们经常会用到<code>ul&gt;li</code>标签，特别是对一系列样式相同且排列整齐的文档元素。<br>在默认情况下，我们都会给<code>ul</code>添加一个属性<code>list-style: none</code>，这样就能去除<code>li</code>标签开头的一个实心点。<br>因为去除<code>ul</code>样式的代码用习惯了(很多框架都重写了列表的默认样式)，以至于忘了<code>list-style</code>的存在。<br><a id=\"more\"></a></p>\n<h2 id=\"list-style\"><a href=\"#list-style\" class=\"headerlink\" title=\"list-style\"></a>list-style</h2><p>无序列表有一个CSS属性<code>list-style</code>，它其实是一个缩写，像<code>background</code>一样。<br><code>list-style</code>包含了三个属性<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ul &#123;</span><br><span class=\"line\">    list-style-type: disc;</span><br><span class=\"line\">    list-style-position: outside;</span><br><span class=\"line\">    list-style-image: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">/*Initial value*/</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"list-style-type\"><a href=\"#list-style-type\" class=\"headerlink\" title=\"list-style-type\"></a>list-style-type</h3><p>在原始的无序列表中默认会有一个实心小圆点就是因为<code>list-style-type: disc</code>这个属性。<br>说到<code>list-style-type</code>，其下包含的类别有太多太多，有需要的同学可以点<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/list-style-type\" target=\"_blank\" rel=\"noopener\">这里</a>看看。<br>会用的其实不多，主要有<code>circle, square, upper-roman, lower-alpha</code>等。</p>\n<h3 id=\"list-style-position\"><a href=\"#list-style-position\" class=\"headerlink\" title=\"list-style-position\"></a>list-style-position</h3><p>再说说<code>list-style-position</code></p>\n<blockquote>\n<p>list-style-position: inside|outside|initial|inherit;</p>\n</blockquote>\n<p>inside表示列表符包含在border以内，二outside则表示在border区域外。</p>\n<iframe width=\"100%\" height=\"300\" src=\"//jsfiddle.net/bill_q/o0L8pb69/embedded/html,css,result/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"></iframe>\n\n<h3 id=\"list-style-image\"><a href=\"#list-style-image\" class=\"headerlink\" title=\"list-style-image\"></a>list-style-image</h3><p>至于<code>list-style-image</code>就更简单了，用图片代替标识符。</p>\n<h2 id=\"几种增加圆点标识符的方式\"><a href=\"#几种增加圆点标识符的方式\" class=\"headerlink\" title=\"几种增加圆点标识符的方式\"></a>几种增加圆点标识符的方式</h2><h3 id=\"默认样式\"><a href=\"#默认样式\" class=\"headerlink\" title=\"默认样式\"></a>默认样式</h3><p>首先说的就是默认样式，如果不对ul进行任何CSS修饰，默认每个<code>li</code>标签前都会有一个小黑点标识符。<br>但是从视觉效果上看，这个标识符看上去并不是居中的，而是要稍偏下。<br>所以通常情况下很少直接这样拿来使用，给我们的设计稿如果有这效果需要实现，标识符一般都是居中的。<br>因此就要用到以下方法了。</p>\n<h3 id=\"使用before伪类\"><a href=\"#使用before伪类\" class=\"headerlink\" title=\"使用before伪类\"></a>使用before伪类</h3><iframe width=\"100%\" height=\"100\" src=\"//jsfiddle.net/bill_q/upfupf51/embedded/html,css,result/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"></iframe><br>从上述代码中可以看出使用before添加伪类和默认样式的差别，很明显，默认样式的标识符明显下沉，而且使用伪类可以改变标识符的颜色。<br><br>### 添加新元素<br>要实现一个实心小圆的标识符，可以自己绘制或者添加图片来实现。<br>自己绘制的话我们使用一个空的<code>&lt;i&gt;</code>标签。<br><iframe width=\"100%\" height=\"200\" src=\"//jsfiddle.net/bill_q/t0m7ka31/embedded/html,css,result/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"></iframe>\n\n<p>使用图片的道理也是一样的，通过<code>&lt;img&gt;</code>标签添加图片，在对其位置进行调整。但是使用图片存在一个问题，就是通常标识符的图片都比较小，会有图片失真的情况发生。</p>\n<h3 id=\"list-style-image-1\"><a href=\"#list-style-image-1\" class=\"headerlink\" title=\"list-style-image\"></a>list-style-image</h3><p>通过这种方式添加图片标识符很方便，但是调整标识符图片的位置很不灵活，所以一般很少采用。</p>\n<h2 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h2><p>有时候经验主义会很大地限制我们的思维，让我们一条路走到黑。在写代码的时候，多问问为什么，这样做虽然正确，但是不是最合适的？</p>\n<p>End</p>\n","categories":[],"tags":["CSS","无序列表","HTML"]},{"title":"background八日谈第六日：background-origin","url":"http://billqiu.github.io/2016/05/17/background八日谈第六日：background-origin/","content":"<h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><p>在上文中我们介绍了<code>background-clip</code>属性，<code>background-origin</code>可是说是它的兄弟属性，也有三个值<code>border-box</code>、<code>padding-box</code>、<code>content-box</code>。<br>所以本文的主要目的就是介绍两者的区别。<br><a id=\"more\"></a></p>\n<h2 id=\"background-clip-VS-background-origin\"><a href=\"#background-clip-VS-background-origin\" class=\"headerlink\" title=\"background-clip VS background-origin\"></a>background-clip VS background-origin</h2><p>首先，从两者的定义入手。</p>\n<blockquote>\n<p>background-clip : 设置元素的背景（背景图片或颜色）是否延伸到边框下面<br>background-origin : 指定背景图片background-image 属性的原点位置的背景相对区域</p>\n</blockquote>\n<p>从定义可以看出，当需要改变背景颜色(图片)的覆盖范围时，需要使用<code>background-clip</code>属性。<br>当需要改变背景图片(<code>background-image</code>)的起点位置时，需要使用<code>background-orgin</code>属性。</p>\n<h3 id=\"默认值\"><a href=\"#默认值\" class=\"headerlink\" title=\"默认值\"></a>默认值</h3><p><code>background-origin</code>的默认值为<code>padding-box</code><br><code>background-clip</code>的默认值为<code>border-box</code></p>\n<p>想要加深对两者理解的可以用下面的例子把玩把玩。</p>\n<iframe width=\"100%\" height=\"300\" src=\"//jsfiddle.net/bill_q/xhsoy51v/1/embedded/html,css,result/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"></iframe>\n\n<p>TO BE CONTINUED!</p>\n<p>参考文献：<br><a href=\"https://css-tricks.com\" target=\"_blank\" rel=\"noopener\">css-tricks</a><br><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/background-origin\" target=\"_blank\" rel=\"noopener\">MDN</a></p>\n","categories":[],"tags":["background","CSS3","background-origin"]},{"title":"background八日谈第五日：background-clip","url":"http://billqiu.github.io/2016/05/15/background八日谈第五日：background-clip/","content":"<h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><p><code>background-clip</code>是CSS3中新加入属性，用来设置元素的背景（背景图片或颜色）是否延伸到边框下面。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.border &#123;</span><br><span class=\"line\">    background-clip: border-box;   //默认值</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"值-Values\"><a href=\"#值-Values\" class=\"headerlink\" title=\"值(Values)\"></a>值(Values)</h3><p><code>background-clip</code>一共有三个值：</p>\n<ol>\n<li>border-box<br>默认值，背景延伸到边框外沿（但是在边框之下）。</li>\n<li>padding-box<br>边框下面没有背景，即背景延伸到内边距外沿。</li>\n<li>content-box<br>背景裁剪到内容区 (content-box) 外沿。<a id=\"more\"></a>\n</li>\n</ol>\n<h2 id=\"示例-Demo\"><a href=\"#示例-Demo\" class=\"headerlink\" title=\"示例(Demo)\"></a>示例(Demo)</h2><p><iframe width=\"100%\" height=\"300\" src=\"//jsfiddle.net/bill_q/rm4tov8q/embedded/html,css,result/dark/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"></iframe><br>上述4个例子的HTML代码结构完全相同，为div设置的背景颜色为黄色，边框颜色为半透明的蓝色。<br>当<code>background-clip</code>的值为默认值<code>border-box</code>时，可以看到边框的颜色变成了灰色。这是因为div的背景颜色延伸到了边框外沿，背景色黄色和边框的半透明蓝色混合在一起显示为灰色。<br>当<code>background-clip</code>的值为<code>padding-box</code>时，div的背景色被限制在外边框之内，外边框的颜色为呈现为当初设置的半透明蓝。<br>当<code>background-clip</code>的值为<code>content-box</code>时，只有div中的内容——p标签——的背景色为黄色。div的padding和border没有背景色。这里需要注意一点，div容器内的p标签的整个盒模型(padding+marging+content)都会有黄色的背景色。</p>\n<p>TO BE CONTINUED!</p>\n<p>参考文献：<br><a href=\"https://css-tricks.com\" target=\"_blank\" rel=\"noopener\">css-tricks</a><br><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/background-clip\" target=\"_blank\" rel=\"noopener\">MDN</a></p>\n","categories":[],"tags":["background","CSS3","background-clip"]},{"title":"background八日谈第四日：background-size","url":"http://billqiu.github.io/2016/05/13/background八日谈第四日：background-size/","content":"<h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><p><code>background-size</code>属性主要用来对<code>background-image</code>进行一系列的操作，功能很强大也非常有用。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">html &#123;</span><br><span class=\"line\">  background: url(greatimage.jpg);</span><br><span class=\"line\">  background-size: 300px 100px;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"三种描述方式\"><a href=\"#三种描述方式\" class=\"headerlink\" title=\"三种描述方式\"></a>三种描述方式</h2><ul>\n<li>单值</li>\n<li>双值</li>\n<li>多背景<a id=\"more\"></a>\n<h3 id=\"单值-One-Value\"><a href=\"#单值-One-Value\" class=\"headerlink\" title=\"单值(One Value)\"></a>单值(One Value)</h3>单值的表示方式有两种：数值和关键字。<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">html &#123;</span><br><span class=\"line\">    background: url(greatimage.jpg);</span><br><span class=\"line\">    background-size: 300px;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>仅仅用一个数值描述<code>background-size</code>，如果容器的宽高足够，最后的得到的背景图片必然为一个矩形。因为背景图片的宽度值被定义为300px后，由于没有为其定高，则高度值默认为<code>auto</code>，也就是300px。<br>在用数值定义<code>background-size</code>时，可以使用任意合适的<a href=\"https://css-tricks.com/the-lengths-of-css\" target=\"_blank\" rel=\"noopener\">CSS长度单位</a>。</p>\n<p>同理也可以使用百分比来进行描述。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">html &#123;</span><br><span class=\"line\">    background: url(greatimage.jpg);</span><br><span class=\"line\">    background-size: 50%;   //50%图片的大小</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>再说说常用的两个关键词<code>cover</code>与<code>contain</code>。</p>\n<ul>\n<li>cover：把背景图像扩展至足够大，以使背景图像完全覆盖背景区域。背景图像的某些部分也许无法显示在背景定位区域中。</li>\n<li>contain： 把图像图像扩展至最大尺寸，以使其宽度和高度完全适应内容区域。</li>\n</ul>\n<h3 id=\"双值-Two-Values\"><a href=\"#双值-Two-Values\" class=\"headerlink\" title=\"双值(Two Values)\"></a>双值(Two Values)</h3><p>可以设置任意两个数值来描述背景图片的大小，第一个表示的宽，第二个表示高。如果数值设置过大，会导致图片失真。</p>\n<h3 id=\"多背景-Multiple-Images\"><a href=\"#多背景-Multiple-Images\" class=\"headerlink\" title=\"多背景(Multiple Images)\"></a>多背景(Multiple Images)</h3><p>CSS3的多背景是一个非常棒的属性，可以为一个元素设置多个背景图片，但是其中也有一些问题需要注意。</p>\n<ol>\n<li>背景图片层次结构。<br><iframe width=\"100%\" height=\"300\" src=\"//jsfiddle.net/bill_q/jem3xuga/1/embedded/html,css,result/dark/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"></iframe><br>从上述代码中可以看出，背景图片有类似z-index的属性，最先声明的拥有最高的优先级，会把之后的声明的背景图片的重叠部分覆盖。</li>\n<li>单值、双值的方式可以混合使用，但注意要用逗号分隔。</li>\n</ol>\n<p>TO BE CONTINUED!</p>\n<p>参考文献：<br><a href=\"https://css-tricks.com\" target=\"_blank\" rel=\"noopener\">css-tricks</a></p>\n","categories":[],"tags":["background","CSS","background-size"]},{"title":"background八日谈第三日：background-position","url":"http://billqiu.github.io/2016/05/09/background八日谈第三日：background-position/","content":"<h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><p>首先从字面上理解background-positio——背景位置，那这里的背景指的是什么呐？<br>当然是<a href=\"http://billqiu.com/2016/04/14/background%E5%85%AB%E6%97%A5%E8%B0%88%E7%AC%AC%E4%B8%80%E6%97%A5%EF%BC%9Abackground-image/\" target=\"_blank\" rel=\"noopener\">background-image</a>啦，对背景图片的位置进行调整。</p>\n<h2 id=\"兼容性\"><a href=\"#兼容性\" class=\"headerlink\" title=\"兼容性\"></a>兼容性</h2><iframe id=\"rewYxL\" src=\"http://caniuse.com/css-background-offsets/embed\" scrolling=\"no\" frameborder=\"0\" height=\"300\" allowtransparency=\"true\" allowfullscreen=\"true\" class=\"cp_embed_iframe undefined\" style=\"width: 100%; overflow: hidden;\"></iframe><br>还是老样子，IE8以下不兼容。<br><a id=\"more\"></a><br>## 三种描述方式<br>- 数值(e.g. 100px 5px)<br>- 百分比(e.g. 100% 5%)<br>- 关键词(e.g. top right)<br><br>### 数值<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.lengthvalue &#123;</span><br><span class=\"line\">    background-position: 10px 10px;</span><br><span class=\"line\">    //向右偏移10个像素，向下偏移10个像素。</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><br><br>如果不对background-position进行赋值，背景图片默认从右上角开始排列。<br>如果有2个描述，第一个表示水平方向上距离左边的偏移量，第二个表示垂直方向上距离上边的偏移量。(负值则相反)<br>不仅仅的是px，任何CSS的单位比如<code>em</code>、<code>rem</code>都可以用于其中。<br><br>### 百分比<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.prcentages &#123;</span><br><span class=\"line\">    background-position: 10% 10%;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><br><br>百分比描述方式的偏移规则与用数值描述的相同。<code>10%</code>表示背景图片的中线与容器1/10处的分割线对齐。<br>最长的用<code>background-position: 50%</code>表示背景图片在容器的正中央(当只填写第一个数值时，第二个数值默认与第二个相同)。<br><br>### 关键词<br>一共有5个关键词<code>left</code>、<code>right</code>、<code>top</code>、<code>buttom</code>、<code>center</code>。<br><code>left</code>：水平方向最左边<br><code>right</code>：水平方向最右边<br><code>top</code>：垂直方向最上边<br><code>buttom</code>：垂直方向最下边<br><code>center</code>：居中<br>这里有一个小tips <code>background-position: top center</code> = <code>background-position: center top</code>。当且仅当使用关键词描述时才有效。<br><br>## 声明数值的方式<br>我们可以使用1个数值来描述位置，也可以用两个。<br>甚至，可是使用三个或四个！<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#threevalues &#123;</span><br><span class=\"line\">  background-position: right 45px bottom;</span><br><span class=\"line\">  //表示距离右边45个像素，置底。</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#fourvalues &#123;</span><br><span class=\"line\">  background-position: right 45px bottom 20px;</span><br><span class=\"line\">  //表示距离右边45个像素，距离底边20个像素。</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><br><br>上述规则也很简单，先声明一个关键字，再进行百分比或数值进行具体描述。<br><br>## background-position-x/y<br>有时我们仅需要对背景图片的一个方向进行调整，便会用到<code>background-position-x</code>或<code>background-position-y</code>。<br>使用方法完全可以参照上文，但有一点需要注意，那就是兼容性。火狐浏览器对此属性的兼容性很差。<br><iframe id=\"rewYxL\" src=\"http://caniuse.com/background-position-x-y/embed\" scrolling=\"no\" frameborder=\"0\" height=\"300\" allowtransparency=\"true\" allowfullscreen=\"true\" class=\"cp_embed_iframe undefined\" style=\"width: 100%; overflow: hidden;\"></iframe>\n\n<p>TO BE CONTINUED!</p>\n<p>参考文献：<br><a href=\"https://css-tricks.com\" target=\"_blank\" rel=\"noopener\">css-tricks</a></p>\n","categories":[],"tags":["CSS","background-position"]},{"title":"background八日谈第二日：background-color","url":"http://billqiu.github.io/2016/05/05/background八日谈第二日：background-color/","content":"<h2 id=\"三种显示颜色的方式\"><a href=\"#三种显示颜色的方式\" class=\"headerlink\" title=\"三种显示颜色的方式\"></a>三种显示颜色的方式</h2><p><img src=\"/assets/blogImg/color-style.png\" alt=\"颜色\">)<br><a id=\"more\"></a></p>\n<h3 id=\"HEX\"><a href=\"#HEX\" class=\"headerlink\" title=\"HEX\"></a>HEX</h3><p>先说说HEX，最常见的颜色表达方式。<br>PS: 此HEX非彼hex(贺老)<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">html &#123;</span><br><span class=\"line\">  background-color: #fffff;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>上述代码中的<code>#fffff</code>就是HEX的颜色描述方式，也可以简写成<code>#fff</code>，一看就能明白的东西，不多说了。</p>\n<h3 id=\"color-name\"><a href=\"#color-name\" class=\"headerlink\" title=\"color name\"></a>color name</h3><p>如果想要用白色作为背景色，可以这样写:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">html &#123;</span><br><span class=\"line\">  background-color: white;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>因为颜色的多样，并不是没种颜色都可以通过<code>color name</code>来表示。在实际开发中用的比较好，更多用在调试中。<br>想要知道更多颜色的名字，可以看<a href=\"https://css-tricks.com/snippets/css/named-colors-and-hex-equivalents/\" target=\"_blank\" rel=\"noopener\">这里</a>。</p>\n<h3 id=\"RGBA\"><a href=\"#RGBA\" class=\"headerlink\" title=\"RGBA\"></a>RGBA</h3><p>RGBA的颜色描述方式大家肯定也很熟悉了<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">html &#123;</span><br><span class=\"line\">  background-color: rgba(0, 0, 0, 0.8); /* 80% Black */</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>R:red, B:blue, G:green, A:alpha 通过三原色的配比获取我们想要的任何颜色，通过alpha值调节颜色的透明度。<br><code>RGBA</code>的浏览器支持性很好，除了IE8及以下浏览器都支持这个属性。<br>如果项目不需要支持IE8及以下浏览器，但是用到了RGBA，可以使用一个<em>Fallback</em>实现向下兼容。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">html &#123;</span><br><span class=\"line\">    background-color: rgb(0, 0, 0, 0.8);  /Fallback/</span><br><span class=\"line\">    background-color: rgba(0, 0, 0, 0.8); /* 80% Black */</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>当需要在IE8及以下浏览器中实现RGBA的效果时，就需要用到<code>Microsoft CSS filter</code>了<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!--[if IE]&gt;</span><br><span class=\"line\">   &lt;style type=&quot;text/css&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">   .color-block &#123;</span><br><span class=\"line\">       background:transparent;</span><br><span class=\"line\">       filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#50990000,endColorstr=#50990000);</span><br><span class=\"line\">       zoom: 1;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    &lt;/style&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;![endif]--&gt;</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"HSLA\"><a href=\"#HSLA\" class=\"headerlink\" title=\"HSLA\"></a>HSLA</h3><p>这种颜色的表达方式比较少见，至于为什么，我也清楚。有国外的大神说可能是因为<code>HSLA</code>的色值比较难获取。<br>Hue、Saturation、Lightness and alpha分别代表色调、饱和度、亮度和透明度。<br>从理性的角度来说，用HSLA更容易创造出自己想要的颜色。</p>\n<ol>\n<li>改变第二个数值，会使颜色的饱和度发生变化。</li>\n<li>改变第三个数值，使颜色的亮度发生变化。</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#some-element &#123;</span><br><span class=\"line\">  background-color: hsla(170, 50%, 45%, 1);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>HSLA</code>的兼容性与RGBA相同，可以使用RGBA的地方都可以是使用HSLA代替。</p>\n<iframe id=\"rewYxL\" src=\"http://caniuse.com/css3-colors/embed\" scrolling=\"no\" frameborder=\"0\" height=\"300\" allowtransparency=\"true\" allowfullscreen=\"true\" class=\"cp_embed_iframe undefined\" style=\"width: 100%; overflow: hidden;\"></iframe>\n\n\n<p>TO BE CONTINUED!</p>\n<p>参考文献：<br><a href=\"https://css-tricks.com\" target=\"_blank\" rel=\"noopener\">css-tricks</a></p>\n","categories":[],"tags":["background","css","background-color","RGBA","HSLA"]},{"title":"background八日谈第一日：background-image","url":"http://billqiu.github.io/2016/04/14/background八日谈第一日：background-image/","content":"<h2 id=\"开宗明义\"><a href=\"#开宗明义\" class=\"headerlink\" title=\"开宗明义\"></a>开宗明义</h2><p><code>background</code>，一个最常用的CSS属性，只要是写过CSS的人，都肯定用过这个属性。<br>正如他的字面意思：背景，我们平常更多地用他来设置背景颜色。殊不知background是一个强大的家族，共有八个兄弟姐妹，background八日谈系类文章将分八个章节对他们进行一一介绍，相信你定会对他们有一个新的认识。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">body &#123;</span><br><span class=\"line\">  background:</span><br><span class=\"line\">     url(sweettexture.jpg)    /* image */</span><br><span class=\"line\">     top center / 200px 200px /* position / size */</span><br><span class=\"line\">     no-repeat                /* repeat */</span><br><span class=\"line\">     fixed                    /* attachment */</span><br><span class=\"line\">     padding-box              /* origin */</span><br><span class=\"line\">     content-box              /* clip */</span><br><span class=\"line\">     red;                     /* color */</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<a id=\"more\"></a>\n<h2 id=\"图片类型\"><a href=\"#图片类型\" class=\"headerlink\" title=\"图片类型\"></a>图片类型</h2><p>在CSS中，图片大致大致可以分为两大类：常规图片(regular images)和渐变图片(gradients)，本文也根据图片类型分为两部分来介绍<code>background-image</code>。</p>\n<h3 id=\"常规图片-regular-images\"><a href=\"#常规图片-regular-images\" class=\"headerlink\" title=\"常规图片(regular images)\"></a>常规图片(regular images)</h3><p>从我们最常用的常规图片说起，<code>background: url(sweettexture.jpg);</code>这个属性大家都不会陌生，对相应的元素设置一个名为sweettexture的jpg格式的是图片。<br>当然这只是最基础的，如果我们想让图片置于一个合理的位置，常常会与<code>background-repeat</code>、<code>background-position</code>等属性配合使用。<br>在设置常规图片时，一定要考虑到浏览器是否能识别图片的格式，几乎所有的浏览器都支持JPEG、GIF、PNG格式的图片，如果要用到其他格式的图片就要慎重考虑了。至于以上三种图片的应用场景，以超出本文的讨论范围，请大家自行<a href=\"https://www.google.com\" target=\"_blank\" rel=\"noopener\">google</a>(不要百度！不要百度！不要百度！)</p>\n<p>除了以上几种常用的引入图片的类型，还有一种base64的图片格式，大家可能用的比较少。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">background-image:url(data:image/gif;base64,R0lGODlhBAABAIABAMLBwfLx8SH5BAEAAAEALAAAAAAEAAEAAAICRF4AOw==);</span><br></pre></td></tr></table></figure></p>\n<p><code>data:[&lt;mime type&gt;][;charset=&lt;charset&gt;][;base64],&lt;encoded data&gt;</code><br>优点：</p>\n<ul>\n<li>减少了HTTP请求</li>\n<li>某些文件可以避免跨域的问题</li>\n<li>没有图片更新要重新上传，还要清理缓存的问题<br>缺点：</li>\n<li>增加了CSS文件的尺寸</li>\n<li>浏览器支持<br>想要了解base64图片的，可以看看张老师写的这篇<a href=\"http://www.zhangxinxu.com/wordpress/2012/04/base64-url-image-%E5%9B%BE%E7%89%87-%E9%A1%B5%E9%9D%A2%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/\" target=\"_blank\" rel=\"noopener\">文章</a>。</li>\n</ul>\n<p>对同一个元素，我们可以通过<code>background-image</code>设置多个背景图片。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">body &#123;</span><br><span class=\"line\">  background: url(logo.png), url(background-pattern.png);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>这里有一点需要注意——图片的设置顺序，越先声明的层次优先级越高。<br>举个栗子，如果声明的第二个背景图片的尺寸比第一个小，并且没有进行定位，就会被第一个申明的背景图片覆盖。</p>\n<iframe width=\"100%\" height=\"200\" src=\"//jsfiddle.net/bill_q/34pyvr7k/1/embedded/html,css,result/dark/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"></iframe>\n\n<p>在使用背景图片的时候，我们有时会遇到图片无法加载的情况，为此可以为背景图片设置一个<b>回调颜色</b>，在图片无法加载的情况下代替图片显示。</p>\n<iframe width=\"100%\" height=\"150\" src=\"//jsfiddle.net/bill_q/70x9cbLo/embedded/html,css,result/dark/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"></iframe>\n\n<h3 id=\"渐变图片-gradients\"><a href=\"#渐变图片-gradients\" class=\"headerlink\" title=\"渐变图片(gradients)\"></a>渐变图片(gradients)</h3><p></p><p style=\"font-size: 17px\">线性渐变</p><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">background: linear-gradient(angle, color-stop1, color-stop2);</span><br></pre></td></tr></table></figure><p></p>\n<p>依旧从我们最熟悉的线性渐变开始说起，如果没有设置angle值，默认从上到下。</p>\n<iframe width=\"100%\" height=\"200\" src=\"//jsfiddle.net/bill_q/sy1Laak7/1/embedded/html,css,result/dark/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"></iframe>\n\n<p>使用to表示颜色的延生方向，一共有八个方向<br>to <code>top/bottom/right/left/top left/top right/buttom left/buttom right</code></p>\n<iframe width=\"100%\" height=\"200\" src=\"//jsfiddle.net/bill_q/xw4251ov/2/embedded/html,css,result/dark/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"></iframe>\n\n<p>如果想要更加精确的颜色延生角度，可以使用<code>deg</code><br>标记12点方向为0度，顺时针方向增加，90deg = to right,-90deg = to left</p>\n<iframe width=\"100%\" height=\"200\" src=\"//jsfiddle.net/bill_q/cf7zcu55/embedded/html,css,result/dark/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"></iframe>\n\n<p>当想要控制色块中某种颜色开始或结束的位置，可以使用<code>%</code>进行控制</p>\n<iframe width=\"100%\" height=\"200\" src=\"//jsfiddle.net/bill_q/73m47n7L/embedded/html,css,result/dark/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"></iframe>\n\n<p></p><p style=\"font-size: 17px\">径向渐变</p><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">background: radial-gradient(shape size at position, start-color, ..., last-color);</span><br></pre></td></tr></table></figure><p></p>\n<p>径向渐变与线性渐变大体相同，主要区别在于angle与shape size at position上。<br>默认从内向外扩散。</p>\n<iframe width=\"100%\" height=\"300\" src=\"//jsfiddle.net/bill_q/cgssdgbc/embedded/html,css,result/dark/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"></iframe>\n\n<h3 id=\"兼容性\"><a href=\"#兼容性\" class=\"headerlink\" title=\"兼容性\"></a>兼容性</h3><p><img src=\"/assets/blogImg/linear-gradient.png\" alt=\"兼容性\"></p>\n<h3 id=\"拓展\"><a href=\"#拓展\" class=\"headerlink\" title=\"拓展\"></a>拓展</h3><p>关于多背景图，我们可以对其设置多样CSS3动画，并且完全不需要JS的介入。</p>\n<iframe width=\"100%\" height=\"300\" src=\"//jsfiddle.net/bill_q/eb08a191/embedded/html,css,result/dark/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"></iframe>\n\n<p>巧妙运用渐变，会得到一系列意想不到的<a href=\"http://lea.verou.me/css3patterns/\" target=\"_blank\" rel=\"noopener\">图案</a>。</p>\n<p>TO BE CONTINUED!</p>\n<p>参考文献：</p>\n<ol>\n<li><a href=\"https://css-tricks.com/\" target=\"_blank\" rel=\"noopener\">https://css-tricks.com/</a></li>\n<li><a href=\"http://www.w3schools.com/\" target=\"_blank\" rel=\"noopener\">http://www.w3schools.com/</a></li>\n<li><a href=\"http://www.zhangxinxu.com/wordpress/2012/04/base64-url-image-%E5%9B%BE%E7%89%87-%E9%A1%B5%E9%9D%A2%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/\" target=\"_blank\" rel=\"noopener\">http://www.zhangxinxu.com/wordpress/2012/04/base64-url-image-%E5%9B%BE%E7%89%87-%E9%A1%B5%E9%9D%A2%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/</a></li>\n</ol>\n","categories":[],"tags":["background","background-image","CSS","linear-gradient"]},{"title":"给table交的一点学费","url":"http://billqiu.github.io/2016/04/12/table布局引发的“血案”/","content":"<p>最近在做公司的一个项目，项目团队还挺大，整个团队加起来有10多个人，向我这样的小前端也就只有打打杂的份了 = =<br>以前做的都是一些静态页面为主的工作，这次的项目则需要前后端交互，各种接口的调用，一个完整web项目从零开始，对我来说真是一个很好的学习的机会。</p>\n<p>项目前期的工作当然还是以搭静态页面为主，其中必然遇到了不少的坑，且听我慢慢道来。</p>\n<h2 id=\"关于table布局\"><a href=\"#关于table布局\" class=\"headerlink\" title=\"关于table布局\"></a>关于table布局</h2><p>现代的网页，已经很少看到<code>table</code>元素了，除非是非常标准的表格，用<code>table</code>实现效率远高于其他布局方式，不然，永远不推荐使用<code>table</code>！永远不推荐使用<code>table</code>！！永远不推荐使用<code>table</code>！！！<br>在这里向当年使用table布局的老同志们致以深深的敬意。</p>\n<p>display大家肯定都知道，我是一个喜欢刨根问底的人，曾经查阅过display相关的文档资料，其中有将近有一半的属性和table有关，因为很少用到，又嫌麻烦，便没有去做多深入了解，知道今天遇到了，才被好好地坑了一把。</p>\n<p><img src=\"/assets/blogImg/table.png\" alt=\"table\"><br><a id=\"more\"></a><br>上面是我整理的一些table标签和相关display的脑图，看晕了没？<br>既然说到了display，就不得不说W3C标准盒模型<br><img src=\"/assets/blogImg/boxmodel.png\" alt=\"boxmodel\"><br>这是一个标准的W3C盒模型图，内容(content)+边框(border)+内边距(padding)+外边距(margin)。<br>在早期的IE浏览器中，存在一个怪异盒模型。<br><img src=\"/assets/blogImg/IEbox.png\" alt=\"IEbox\"><br>如上图所示，标准盒子模型中content = 怪异盒模型中content+padding+border。<br>换句话说，在怪异盒模型中，如果你设置了border值和padding值，会呈现出一个比遵从标准行为的结果更窄或者更短的盒子。<br>再换个角度来说，当我们在标准盒模型中给一个元素定宽时，如果给它设置了padding和border，就会得到一个比实际更宽的效果。如果要得到想要的效果，就需要在宽度值中减去padding和border的值。<br>为了避免上述情况，<code>box-sizing: border-box;</code>横空出世，demo可以戳<a href=\"http://zh.learnlayout.com/box-sizing.html\" target=\"_blank\" rel=\"noopener\">这里</a>。</p>\n<p>在table中，常用的tr,td,th,tbody都是不符合标准盒模型的，所以一些常用的CSS属性是无法设置的，也就导致了无法设置一些常用样式。比如：</p>\n<ul>\n<li>background 是正常的，除了tbody、tfoot、thead都可以用，</li>\n<li>text-align、text-indent 等文字相关属性，只对单元格有效，但是可以被继承。 *margin 只在 table 上有效，对 td th 等等无效。</li>\n<li>border 只在 table、td、th、caption 有效，对 thead、tbody、tfoot、tr 等无效。</li>\n<li>padding、overflow、vertical-align 只对单元格有效。</li>\n<li>height 在表格、行和单元格上有效，但其值只能作为最小高度，因为内容总是会扩大单元格、行以及表格的高度。如果使用 display 将其改成 block 块级元素，就会溢出而不会扩大。</li>\n</ul>\n<p>table中还有一个大坑就是设置表格线框。<br>一般我们在表格内画线框，都是为<code>td</code>设置<code>border</code>属性。<br>今天在做项目时，却碰到了这样一个问题，<br><img src=\"/assets/blogImg/point.png\" alt=\"point\"><br>没错，就是中间那一个小小的像素点，差点没我搞死。<br>如果你的表格基础不错，应该一眼就能看出问题的所在。<br>如果你真看不出，可以先想想为什么会有这一个像素点的存在。<br>表格的是典型的“井”字形布局，有横就有竖。想到了吗，那一点就是默认存在的白色竖边框。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;table cellspacing=&quot;0&quot;&gt;</span><br></pre></td></tr></table></figure></p>\n<p>使用以上代码完美解决问题。<br>这里有一点需要注意的是，在HTML5中，已经移除了这个属性，推荐使用CSS的<code>border-spacing</code>来设置。</p>\n<p>以上就是给<code>table</code>交的一点学费，与君共勉！</p>\n<p><br><br>参考文献：</p>\n<ol>\n<li><a href=\"https://zh.wikipedia.org/wiki/IE%E7%9B%92%E6%A8%A1%E5%9E%8B%E7%BC%BA%E9%99%B7\" target=\"_blank\" rel=\"noopener\">https://zh.wikipedia.org/wiki/IE%E7%9B%92%E6%A8%A1%E5%9E%8B%E7%BC%BA%E9%99%B7</a></li>\n<li><a href=\"http://yujiangshui.com/about-table/\" target=\"_blank\" rel=\"noopener\">http://yujiangshui.com/about-table/</a></li>\n<li><a href=\"http://zh.learnlayout.com/box-model.html\" target=\"_blank\" rel=\"noopener\">http://zh.learnlayout.com/box-model.html</a></li>\n</ol>\n","categories":[],"tags":["table","display","盒模型"]},{"title":"再见，考拉。","url":"http://billqiu.github.io/2016/03/24/再见，考拉。/","content":"<p><img src=\"/assets/blogImg/koala.png\" alt=\"koala\"></p>\n<h3 id=\"引言\"><a href=\"#引言\" class=\"headerlink\" title=\"引言\"></a>引言</h3><p>还曾记得小时候，外婆家有只大黄狗，他叫做考拉。<br>每年这个时候，外婆家地里油菜花长的比我人还要高。<br>最喜欢做的事，就是和考拉玩捉迷藏。<br>…<br><a id=\"more\"></a><br>当你看到这个标题，点开后看到这样的文字。<br>你一定会以为，又TM是一篇回忆“青涩”童年的“人狗传奇”。<br>好吧，我承认我标题党了 = =</p>\n<h3 id=\"正文\"><a href=\"#正文\" class=\"headerlink\" title=\"正文\"></a>正文</h3><p>koala，中文名考拉，一款国人大神开发的前端预处理器语言图形编译工具，支持Less、Sass、Compass、CoffeeScript。<br>由于前端项目的工作量越来越繁重，单纯的CSS开发已经无法满足工程需求，因此便有了Less、Sass等动态层叠样式表语言。提供变量、嵌套、混合、操作符、函数等一般编程所需的抽象机制。<br>koala的操作非常简便，看了教程后完全可以傻瓜式操作，最重要的是软件内置中文选项！中文选项！！中文选项！！！对国人来说非常友好。</p>\n<p>既然题目是再见考拉，当然肯定还有比考拉更加酷炫的东西，才能让我这么重情义的人说出“再见”二字。</p>\n<p>没错，就是它——gulp<br>前端自动化工具。<br>也许你没听过它的大名，那么大名鼎鼎的grunt总知道吧？<br>没听过？好吧。 U win</p>\n<p>对于两者，可以最直观地从github的star数上来看。<br>截止目前（2016-03-24）<br>gulp 20071 star<br>grunt 10647 star<br>grunt完败！</p>\n<p>作为一个初学者，就不多说什么技术性的东西了。<br>免得误导了他人。</p>\n<p>写此文的目的，是希望大家能多尝试一些前端的新技术和工具。也许有人觉得会很累，但是个人觉得：<br>这不正是前端的魅力所在吗？<br>哈哈，借用“公司文化”中的一句：拥抱变化吧！</p>\n","categories":[],"tags":["gulp","koala","学习"]},{"title":"关于前端自学的学习思路","url":"http://billqiu.github.io/2016/03/05/关于前端自学的学习思路/","content":"<h3 id=\"写在前面的一些话\"><a href=\"#写在前面的一些话\" class=\"headerlink\" title=\"写在前面的一些话\"></a>写在前面的一些话</h3><p>其实本来想写的文章并不是这一篇，而是想做一个技术的分享。后来在google的过程中，发现有人早就写好了我想写的内容，而且我自认为打不到他的水平。继续写原来的文章，肯定会受到很大程度上的影响。且不说算不算抄袭，万一别人看了我的文章之后发现还有更好的，不也浪费了他人的时间吗？</p>\n<p>曾经在知乎上看到过这样一句话：</p>\n<blockquote>\n<p>如果你不能通过自学来达到能找到工作的水平，那你还是放弃程序员这个职业吧。</p>\n</blockquote>\n<p>很庆幸自己从系统的学习前端开始，一直都没有放弃，坎坎坷坷一路走来，也算是积累了一些经验。<br>在这里同大家分享。<br><a id=\"more\"></a></p>\n<h3 id=\"引子\"><a href=\"#引子\" class=\"headerlink\" title=\"引子\"></a>引子</h3><p>前段时间在制作一个专题页面的时候，有这样的一个效果需要实现。<br><img src=\"/assets/blogImg/more.png\" alt=\"more\"><br>由于专题页仅仅针对PC端，所以完全可以用图片的形式来实现，\u0010\u0010省时省力。但是一想，如果要在移动端实现这个效果呐，难道也用图片？这不仅仅增加了一次页面请求，还减慢了加载的速度，是不符合移动端开发准则的。</p>\n<h3 id=\"理清思路\"><a href=\"#理清思路\" class=\"headerlink\" title=\"理清思路\"></a>理清思路</h3><p>如果这个专题页是基于移动端开发的，我首先想到的是用CSS来实现。好处就不多说了，加载速度杠杠的，也不用太担心兼容性问题。<br>于是我便google了关键词“CSS实现平行四边形”。<br>点击进了第一条搜索结果，<a href=\"http://jerryzou.com/posts/use-css-to-paint-triangle-and-parallelogram/\" target=\"_blank\" rel=\"noopener\">用CSS实现三角形与平行四边形</a>。<br>从标题看到，除了用CSS实现平行四边形，还可以实现三角形。对于一直寻求甚解的我来说肯定不会放弃这一个小细节。<br>看了看实现三角形的CSS代码，我当时就蒙B了<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  width: 0;</span><br><span class=\"line\">  height: 0;</span><br><span class=\"line\">  border-width: 10px;</span><br><span class=\"line\">  border-style: solid;</span><br><span class=\"line\">  border-color: red transparent transparent transparent;</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure></p>\n<p>这尼玛什么鬼，用border实现三角形，想不通啊？border还可以分开写，<code>boder: 1px solid #ccc</code>这不才是最常规的写法吗？<br>看到这儿，我知道是我自己的基础不够扎实的缘故，如果真的想要掌握这个知识点，越往后面看肯定还有很多不清楚需要查阅资料的。<br>于是乎，这儿就要借用思维导图工具了。在线的推荐用<a href=\"http://naotu.baidu.com/\" target=\"_blank\" rel=\"noopener\">百度脑图</a>，也可以去下载个XMind，都挺好用的。<br>之后怎么做呐，把你不懂的知识点、google的过程，一步步通过树状图罗列出来，这样你就可以随时知道你学到哪儿了，哪些知识点是你没有掌握的，对你后期的回顾和整个学习流程的把握很有帮助，形散而神不散，不会让前端庞大的知识体系给压垮了。</p>\n<h3 id=\"说说border\"><a href=\"#说说border\" class=\"headerlink\" title=\"说说border\"></a>说说border</h3><p>以前写代码的时候，一直都觉得border是个很普通、简单的属性，今日一切磋才知道是我“井底之蛙”了。<br>这里有一点要<strong>提一下</strong>，很多人都在<a href=\"http://www.w3school.com.cn/\" target=\"_blank\" rel=\"noopener\">w3school</a>查阅相关的资料，不能说不好吧，但是强烈推荐使用<a href=\"http://www.w3schools.com/\" target=\"_blank\" rel=\"noopener\">w3schools</a>代替w3school来使用，虽然全英文，但是耐下性子来看，只要英语不是差到无可救药的地步，还是可以看懂的。当有问题的时候，多上上<a href=\"http://stackoverflow.com/\" target=\"_blank\" rel=\"noopener\">stackoverflow</a>，很快就能找到你想要的答案。这就是一个良好习惯的养成过程。</p>\n<p>言归正传，还是来说说border吧。<br>在emment插件中，有一个<code>bd+</code>的快捷键，可以直接<code>border: 1px solid #000;</code>也正是因为这样的惯性思维，让我没有多去思考这个属性。</p>\n<p>其实我们平常用的都是border的简写形式，放张图看看border包含的其他属性。<br><img src=\"/assets/blogImg/border.png\" alt=\"boder\"><br>其实这也只是一部分，需要深入了解的还是要自己去查阅相关资料。<br>再次推荐<a href=\"http://www.w3schools.com/\" target=\"_blank\" rel=\"noopener\">w3schools</a><br>纳尼，boder-color还可以这样写？其实你理解了这一点，也就基本上理解了实现三角形的原理。</p>\n<p>再来看看我们google到的第一个<a href=\"http://jerryzou.com/posts/use-css-to-paint-triangle-and-parallelogram/\" target=\"_blank\" rel=\"noopener\">网站</a><br><img src=\"/assets/blogImg/triangle.png\" alt=\"triangle\"><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#first &#123;</span><br><span class=\"line\">  width: 20px;</span><br><span class=\"line\">  height: 20px;</span><br><span class=\"line\">  border-width: 10px;</span><br><span class=\"line\">  border-style: solid;</span><br><span class=\"line\">  border-color: red green blue brown;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">#second &#123;</span><br><span class=\"line\">  width: 0;</span><br><span class=\"line\">  height: 0;</span><br><span class=\"line\">  border-width: 10px;</span><br><span class=\"line\">  border-style: solid;</span><br><span class=\"line\">  border-color: red green blue brown;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">#third &#123;</span><br><span class=\"line\">  width: 0;</span><br><span class=\"line\">  height: 0;</span><br><span class=\"line\">  border-width: 10px;</span><br><span class=\"line\">  border-style: solid;</span><br><span class=\"line\">  border-color: red transparent transparent transparent;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>其实仔细看看这了例子也差不多能明白，只能说还是太<strong>浮躁</strong>了，没用沉下心来。</p>\n<h3 id=\"其他实现三角形的方法\"><a href=\"#其他实现三角形的方法\" class=\"headerlink\" title=\"其他实现三角形的方法\"></a>其他实现三角形的方法</h3><p><strong>1.</strong> 字符法<br>这个方法是在张老师的<a href=\"http://www.zhangxinxu.com/wordpress/2009/11/%E5%91%8A%E5%88%AB%E5%9B%BE%E7%89%87%E2%80%94%E4%BD%BF%E7%94%A8%E5%AD%97%E7%AC%A6%E5%AE%9E%E7%8E%B0%E5%85%BC%E5%AE%B9%E6%80%A7%E7%9A%84%E5%9C%86%E8%A7%92%E5%B0%96%E8%A7%92%E6%95%88%E6%9E%9Cbeta/\" target=\"_blank\" rel=\"noopener\">博客</a>中看到的，惊叹张老师09年的时候就想到了现如今所谓的font-icon。<br>强烈推荐张老师的<a href=\"http://www.zhangxinxu.com/wordpress/2015/05/how-to-ask-web-front-question/\" target=\"_blank\" rel=\"noopener\">博客</a>，看了之后，你说不定会惊叹，TMD竟然还可以这样玩！<br>\u0010<br><strong>2.</strong> 边框法<br>也就是前文介绍的方法。<br>依旧推荐张老师<a href=\"http://www.zhangxinxu.com/wordpress/2010/03/%E7%BA%AFcss%E5%AE%9E%E7%8E%B0%E5%90%84%E7%B1%BB%E6%B0%94%E7%90%83%E6%B3%A1%E6%B3%A1%E5%AF%B9%E8%AF%9D%E6%A1%86%E6%95%88%E6%9E%9C/\" target=\"_blank\" rel=\"noopener\">博客</a>中对边框法的介绍。</p>\n<p><strong>3.</strong> 其他<br>这就是我说的那篇介绍的挺全面的<a href=\"http://www.daqianduan.com/4721.html\" target=\"_blank\" rel=\"noopener\">文章</a>，反正总结的肯定会比我好。</p>\n<h3 id=\"可以回归正题了\"><a href=\"#可以回归正题了\" class=\"headerlink\" title=\"可以回归正题了\"></a>可以回归正题了</h3><p>说了这么多，不知道大家有没有把我想要搜索的正题给忘了，没错，就是“实现平行四边形”。<br>前面说了一大堆，好像TM完全不沾边啊。<br>NO, NO, NO!<br>其实这正是我写这篇文章的主要目的：<strong>分享解决问题的方法</strong>。<br>前端技术的发展日新月异，NodeJS社区每天都有一个新的API出来，要完全掌握是不可能的，但是我们可以学习解决问题的方法。从“用CSS实现平行四边形”这个问题出发，使我深入了解了<code>border</code>属性，更掌握了一系列实现“三角形”的方法。在学习之后，我能归纳总结我所学到的知识和存在的不足，这才是对我帮助最大的。</p>\n<p>至于如何“用CSS实现平行四边形”，大家应该可以自行google了吧。<br>如果你告诉我你翻不了墙，那我只能“祝你幸福”！</p>\n<p>End</p>\n","categories":[],"tags":["个人感悟","自学经验"]},{"title":"如何获取CSS的属性值","url":"http://billqiu.github.io/2016/02/24/如何获取CSS的属性值/","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>说到通过JS获取CSS的属性值，大家首先想到的一般是通过<code>element.style.attr</code>方法来获取。<br>或者通过jQuery的<code>.css()</code>获取。<br>但是不知道你有没有想过，jQuery是怎么获取的呐？<br>其实我也没有想过这个问题 = =<br>只是今天在学习JS动画的时候，碰到了JS的<code>getComputedStyle</code>方法，通过查阅一系列的资料，总结了以下几种获取CSS属性值的方法。</p>\n<h2 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h2><p>在这篇博文中，我打算介绍三种获取CSS属性值的方法。对于只想知其然的朋友，可能会觉得比较啰嗦。但是个人认为在对一个问题钻研的越深入，在下次碰到时才能举一反三，迎刃而解。</p>\n<ol>\n<li>通过jQuery的<code>.css()</code>获取属性</li>\n<li>通过原生JS的<code>element.style.attr</code>方法获取</li>\n<li>通过<code>getComputedStyle()</code>获取<a id=\"more\"></a>\n<h2 id=\"jQuery方法\"><a href=\"#jQuery方法\" class=\"headerlink\" title=\"jQuery方法\"></a>jQuery方法</h2><strong>.css( propertyName )</strong><br>通过<code>.css(&quot;background-color&quot;)</code>可以获取元素的背景颜色，同时用<code>.css(&quot;backgroundColor&quot;)</code>也可以获取元素的背景颜色。其中的”background-color”是用multiple-word格式化的DOM属性的写法，而在JS中获取背景颜色，通过以下代码：<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">document.body.style.backgroundColor;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>需要<strong>注意</strong>的是，<strong>简写速写</strong>的CSS属性(例如： margin, background, border) 是不支持的，例如，如果你想重新获取margin，可以使用$(elem).css(‘marginTop’) 和 $(elem).css(‘marginRight’)，其他的也是如此。</p>\n<p>从jQuery1.9开始，添加了<code>.css( propertyNames )</code>,可以匹配元素的多个属性值。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$( elem ).css([ &quot;borderTopWidth&quot;, &quot;borderRightWidth&quot;, &quot;borderBottomWidth&quot;; &quot;borderLeftWidth&quot; ])</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"原生JS方法\"><a href=\"#原生JS方法\" class=\"headerlink\" title=\"原生JS方法\"></a>原生JS方法</h2><p><strong>1. style方法</strong><br>通过element.style不仅可以获取元素的属性值，还可以设置属性值，可读可写。</p>\n<p><strong>2. getComputedStyle方法</strong></p>\n<blockquote>\n<p>The getComputedStyle() method gets all the actual (computed) CSS property and values of the specified element.The computed style is the style acutally used in displaying the element, after stylings from multiple sources have been apllied.</p>\n</blockquote>\n<p>简单翻译下就是说getComputedStyle方法返回指定元素所有CSS属性和值，也就是最终显示出来的样式值。相比于style方法，getComputedStyle返回一个CSS样式声明对象([object CSSStyleDeclaration])，<strong>只读</strong>。还有一点很大的区别，getComputedStyle返回的是最终显示在页面上的样式的属性值。</p>\n<blockquote>\n<p>window.getComputedStyle(element, pseudoElement)</p>\n</blockquote>\n<p><strong>getPropertyValue方法</strong><br>getPropertyValue方法可以获取CSS样式申明对象上的属性值（直接属性名称）<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">window.getComputedStyle(element, null).getPropertyValue(&quot;float&quot;);</span><br></pre></td></tr></table></figure></p>\n<p>如果不使用getPropertyValue方法，也可以使用键值的方式访问。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">window.getComputedStyle(element, null).[];</span><br></pre></td></tr></table></figure></p>\n<p>但是使用键值存在一个问题，要获取float属性时，需要判断使用cssFloat还是还是styleFloat(for IE)，比较麻烦。<br>由于getPropertyValue不支持驼峰命名法，当遇到用“-”连接的属性时，：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">style.getPropertyValue(&quot;border-top-left-radius&quot;);</span><br></pre></td></tr></table></figure></p>\n<p>getPropertyValue方法虽然好用，但是是DOM2的方法，IE9以上才支持。So。。。<br><img src=\"/assets/blogImg/DOM2.png\" alt=\"DOM2\"><br><br><br><strong>getAttribute方法</strong><br><img src=\"/assets/blogImg/getAttributeSuport.png\" alt=\"getAttributeSuport\"><br>从上图可以看出，<a href=\"http://www.w3schools.com/jsref/met_element_getattribute.asp\" target=\"_blank\" rel=\"noopener\">getAttribute方法</a>对浏览器全支持。<br>张老师给的<a href=\"http://www.zhangxinxu.com/study/201205/getpropertyvalue-getAttribute-background-color.html\" target=\"_blank\" rel=\"noopener\">例子</a><br>需要注意的一点是，getAttribute方法需要属性名用驼峰写法<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">style.getAttribute(&quot;backgroundColor&quot;);</span><br></pre></td></tr></table></figure></p>\n<p>并且不需要<code>cssFloat</code>与<code>styleFloat</code>的兼容写法，可以直接float<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">style.getAttribute(&quot;float&quot;);</span><br></pre></td></tr></table></figure></p>\n<p><br><br><strong>getComputedStyle的兼容性</strong><br><img src=\"/assets/blogImg/getComputedStyle的兼容性.png\" alt=\" getComputedStyle的兼容性\"><br>从上图中，可以看出getComputedStyle是不支持IE8及以下浏览器的。<br>但是IE自己提供了一个currentStyle方法。在查阅相关资料时，Mozilla开发者中心是这样描述的：</p>\n<blockquote>\n<p>Element.currentStyle is a property which is a proprietary alternative to the standardized window.getComputedStyle method. It is available in old versions of Microsoft Internet Explorer.</p>\n</blockquote>\n<p>如果有使用需要的，可以去微软的开发者中心查阅。  <a href=\"https://msdn.microsoft.com/en-us/library/ms535231(v=vs.85).aspx\" target=\"_blank\" rel=\"noopener\">https://msdn.microsoft.com/en-us/library/ms535231(v=vs.85).aspx</a></p>\n<p><strong>3. style与getComputedStyle的区别</strong></p>\n<p>下面看一个例子:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">\t&lt;p id=&quot;p&quot;&gt;&lt;/p&gt;</span><br><span class=\"line\">\t&lt;script&gt;</span><br><span class=\"line\">\t\twindow.onload = function() &#123;</span><br><span class=\"line\">\t\t\tvar p = document.getElementById(&quot;p&quot;);</span><br><span class=\"line\">\t\t\tvar calcWidth = getComputedStyle(p,null)[&quot;width&quot;];</span><br><span class=\"line\">\t\t\tconsole.log(&quot;pWidth = &quot; + p.style.width);  //0</span><br><span class=\"line\">\t\t\tconsole.log(&quot;calcWidth = &quot; + calcWidth);   //与浏览器宽度相关</span><br><span class=\"line\">\t\t&#125;;</span><br><span class=\"line\">\t&lt;/script&gt;\t</span><br><span class=\"line\">&lt;/body&gt;</span><br></pre></td></tr></table></figure></p>\n<p>p元素为块级元素，所以宽度为浏览器视口的宽度(减去各种边距值)。<br><br></p>\n<p>参考文献：</p>\n<ol>\n<li><a href=\"http://www.zhangxinxu.com/wordpress/2012/05/getcomputedstyle-js-getpropertyvalue-currentstyle/\" target=\"_blank\" rel=\"noopener\">http://www.zhangxinxu.com/wordpress/2012/05/getcomputedstyle-js-getpropertyvalue-currentstyle/</a></li>\n<li><a href=\"http://www.w3schools.com/jsref/jsref_getcomputedstyle.asp\" target=\"_blank\" rel=\"noopener\">http://www.w3schools.com/jsref/jsref_getcomputedstyle.asp</a></li>\n<li><a href=\"http://www.jquery123.com/css/\" target=\"_blank\" rel=\"noopener\">http://www.jquery123.com/css/</a></li>\n</ol>\n","categories":[],"tags":["JavaScript","jQuery"]},{"title":"关于爱、包容与死亡","url":"http://billqiu.github.io/2016/02/14/关于爱、包容与死亡/","content":"<p>2015年1月31日晨，突然接到了母亲的电话。<br>还没等接起来，我差不多就猜了什么。<br>母亲从来不会在这个时候给我打电话，果然得到的是外公去世的消息。<br>虽然算是有点准备，但是心里不免还是咯噔一下。<br>“我要今天赶回去吗？”<br>这是我说的第一句话。<br>但是母亲还是希望我主持完公司的年会再回家，毕竟主持人对年会还是很重要的。<br><a id=\"more\"></a></p>\n<p>下午的年会举办的还算不错，大家又唱又跳的都很开心。<br>年会一结束我就像一只泄了气的皮球，完全没了当时在台上主持的状态。<br>晚饭也没吃就匆匆赶回了住处收拾行李。<br>本来是打算陪女朋友到5号一起回去的，但是突发事件让我不得不提早我的行程。</p>\n<p>回到家，大家的状态都还可以，也没有特别伤心。<br>毕竟外公已经在床上躺了有一年多，我外婆也<strong>全程</strong>陪着照顾了一年多。<br>处理大小便、翻身、换洗衣服、喂食等等一切，虽然我母亲他们姐弟也有帮忙，但主要还都是外婆做的。<br>听母亲说，外婆照顾外公的这一年多时间里，基本没睡过一个好觉。<br>从早干到晚，从晚干到早，从来没有抱怨过一句。<br>她认为外公总有一天会好起来，和从前一样每天和她吵嘴。</p>\n<p>在照顾外公期间，外婆的腰肌劳损加重了。<br>舅舅的腰椎间盘突出住院，连自己穿上裤子都困难。<br>在北京打工的姨妈每天都提心吊胆，很怕家里打来的电话。<br>母亲也很久没有去锻炼身体了。</p>\n<p>外婆照顾外公的事迹在村子里都知道，<br>每个人都由衷的称赞我的外婆。<br>姨妈们还开玩笑说：外婆都可以去评选“感动中国人物”了<br>外婆说：我这其实也是在做给你们看啊，以后一定要孝敬老人。</p>\n<p>外婆是一个很淳朴的农村老人，<br>一辈子的劳碌命。<br>在外公的身体稍微好点的时候，<br>每天都会出去干活。<br>扫地、洗碗、家政、卖菜……<br>家里人都劝她不要出去做了，<br>在家里好好照顾外公就够了，<br>又不缺钱。<br>甚至为此还和姨舅吵过架，<br>但是还是要出去做，<br>知道外公躺在床上，<br>生活无法自理。</p>\n<p>中国的父母，<br>总是想方设法想让自己的子女过上幸福的生活，<br>不让他们为自己的生活操心。<br>外婆出去干活岂会没有这样的因素在里面。<br>农村人没赚钱的大本事，<br>种庄稼现在也种不动了，<br>最多只能种一点自己吃。<br>为了自己将来过世的时候不给子女带去太大的负担，<br>便选择自己苦一点，再苦一点。</p>\n<p>对外公来说，<br>到了这样的境地，<br>死亡何尝不是一种解脱。</p>\n","categories":[],"tags":["随笔","思考","情感"]},{"title":"读《如何变得有思想》有感","url":"http://billqiu.github.io/2016/02/13/《如何变得有思想》书摘/","content":"<p><img src=\"/assets/blogImg/book.jpg\" alt=\"如何变得有思想\"><br>过年这几天总是没有一整块的时间来码代码，闲着无聊就用吧碎片化的时间用来看书，感觉也是挺不错的。<br>以前就一直关注阮一峰老师<a href=\"http://www.ruanyifeng.com/blog/\" target=\"_blank\" rel=\"noopener\">博客</a>,不过主要是技术类的文章。<br>最近看了他的《如何变得有思想》后，感悟颇深。</p>\n<a id=\"more\"></a>\n<h3 id=\"《决定，是还做决定》\"><a href=\"#《决定，是还做决定》\" class=\"headerlink\" title=\"《决定，是还做决定》\"></a>《决定，是还做决定》</h3><p>在日常生活中，为了表示态度谦恭，我经常会用一些长音节的表达方式。<br>近年来，这种做法越来越流行，社会各界都在使用。<br>但是感觉效果并不好，反而有种适得其反的感觉：</p>\n<ol>\n<li>别人不容易理解。</li>\n<li>增加自己的语言负担，正所谓言多必失。</li>\n<li>扰乱自己的思维逻辑。<br>希望以后大家也能注意同样的问题。</li>\n</ol>\n<h3 id=\"《如何变得有思想》\"><a href=\"#《如何变得有思想》\" class=\"headerlink\" title=\"《如何变得有思想》\"></a>《如何变得有思想》</h3><p>我上大学的期间也算读了很多书，感觉自己算是一个挺有思想的人。<br>但是如果你问我，什么叫“有思想”，可能我还真的很难回答上来。也许会告诉你“只可意会不可言传”。<br>但是阮老师在文中列了一个简单的公式：</p>\n<blockquote>\n<p>事实 + 前提 + 逻辑 = 观点<br>（1）事实。也就是客观的存在。<br>（2）前提。这就是做出推断的依据，是不需要证明的公理，比如“两点之间直线段最短”。<br>（3）逻辑。也就是做出推理的规则。<br>（4）结论。也就是最后得到的观点。<br>反过来说,如何变得有思想，就是在这几个方面加强努力：了解更多的背景知识，明确个人的价值观，培养自己的逻辑分析能力。</p>\n</blockquote>\n","categories":[],"tags":["阅读","随笔"]},{"title":"Pages + hexo 开宗明义","url":"http://billqiu.github.io/2016/02/06/Pages-hexo-开宗明义/","content":"<p>以前就一直想搭建一个自己的博客<br>刚开始想用的jekyll,但是在查找资料的过程中，发现很多人推荐使用hexo。<br>那时候的自己刚入前端的不归路没多久，一根筋想用jekyll。<br>但是因为一些原因没有钻研成功就放弃了。<br>后来在学习过程中明白了一个道理，<strong>现阶段的技术更新实在太快了，想要全都学精是不现实的。除了专攻技术的基础知识要学透彻，其他能用工具代替的技术，就学会使用工具</strong>。<br>KK老爷子在《必然》中说道：</p>\n<blockquote>\n<p>以后的机器人将代替绝大部分人类的工作。</p>\n</blockquote>\n<p>因此<strong>人机交互</strong>能力就成了一项重要的衡量指标。<br><a id=\"more\"></a></p>\n<h3 id=\"关于hexo\"><a href=\"#关于hexo\" class=\"headerlink\" title=\"关于hexo\"></a>关于hexo</h3><p>首先介绍下hexo是个什么东西。</p>\n<blockquote>\n<p>Hexo 是一个快速、简洁且高效的博客框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页。</p>\n</blockquote>\n<p>以上是官方给的解释。<br>我的理解是这样的：<br>它是一个博客前端页面的生成工具，可以方便快捷地搭建一个静态博客。<br>也就是说，它只是一个生成工具，其本身和生成的前端代码是两个<strong>独立</strong>的个体。<br>将生成的前端代码上传到github的仓库中，就可以直接访问那个属于你自己的博客。</p>\n<p>因为刚开始不了解这个概念，捣鼓了很久，总以为hexo源代码和生成的代码是一整套的，其实不然。</p>\n<h3 id=\"什么是github-Pages\"><a href=\"#什么是github-Pages\" class=\"headerlink\" title=\"什么是github Pages\"></a>什么是github Pages</h3><p>这个就不多说了，网上的很多大神说的都很清楚，英文还口以的也可以看看<a href=\"https://pages.github.com/\" target=\"_blank\" rel=\"noopener\">官网</a>。</p>\n<p><---end---></---end---></p>\n","categories":[],"tags":[]},{"title":"about","url":"http://billqiu.github.io/about/index.html","content":"","categories":[],"tags":[]},{"title":"project","url":"http://billqiu.github.io/project/index.html","content":"","categories":[],"tags":[]},{"title":"search","url":"http://billqiu.github.io/search/index.html","content":"","categories":[],"tags":[]},{"title":"category","url":"http://billqiu.github.io/category/index.html","content":"","categories":[],"tags":[]},{"title":"tag","url":"http://billqiu.github.io/tag/index.html","content":"","categories":[],"tags":[]},{"title":"","url":"http://billqiu.github.io/assets/js/embed_bill.js","content":"//HelloDog -  http://wsgzao.github.io/post/duoshuo/\n//Mobile Start\nfunction checkMobile() {\n    var isiPad = navigator.userAgent.match(/iPad/i) != null;\n    if (isiPad) {\n        return false;\n    }\n    var isMobile = navigator.userAgent.match(/iphone|android|phone|mobile|wap|netfront|x11|java|opera mobi|opera mini|ucweb|windows ce|symbian|symbianos|series|webos|sony|blackberry|dopod|nokia|samsung|palmsource|xda|pieplus|meizu|midp|cldc|motorola|foma|docomo|up.browser|up.link|blazer|helio|hosin|huawei|novarra|coolpad|webos|techfaith|palmsource|alcatel|amoi|ktouch|nexian|ericsson|philips|sagem|wellcom|bunjalloo|maui|smartphone|iemobile|spice|bird|zte-|longcos|pantech|gionee|portalmmm|jig browser|hiptop|benq|haier|^lct|320x320|240x320|176x220/i) != null;\n    if (isMobile) {\n        return true;\n    }\n    return false;\n}\n//Mobile End\n//Admin Start\nfunction sskadmin(e) {\n    var ssk = '';\n    if (e.user_id == 6248060922846250000) {\n        if (checkMobile()) {\n            ssk = '<span class=\"this_ua sskadmin\">R00T</span><br><br>';\n        } else {\n            ssk = '<span class=\"this_ua sskadmin\">R00T</span>';\n        }\n    } else {\n        if (checkMobile()) {\n            ssk = '<br><br>';\n        }\n    }\n    return ssk;\n}\n//Admin End\n//UA Start\n function show_ua(string){\n        console.log(string)\n        $.ua.set(string);\n        var sua=$.ua;\n        if(sua.os.version=='x86_64')sua.os.version='x64';\n        if (checkMobile()) {\n        return '<span class=\"this_ua platform '+sua.os.name+'\">'+sua.os.name+' '+sua.os.version+'</span><br><br><span class=\"this_ua browser '+sua.browser.name+'\">'+sua.browser.name+' '+sua.browser.version+'</span>';\n        } else {  \n        return '<span class=\"this_ua platform '+sua.os.name+'\">'+sua.os.name+' '+sua.os.version+'</span><span class=\"this_ua browser '+sua.browser.name+'\">'+sua.browser.name+' '+sua.browser.version+'</span>';\n        }\n    }\n//UA End\n\n(function(e, t, n) {\n    function at(e, t) {\n        for (var n in t) t[n] && (e[n] ? e[n].set(t[n]) : e[n] = new et(t[n]))\n    }\n    function ft(e, t) {\n        for (var n in t) e[n] = t[n]\n    }\n    function lt() {\n        if (u.checkPermission()) return;\n        var t;\n        while (t = O.shift()) {\n            var n = u.createNotification(t.iconUrl, t.title, t.body),\n            i = t.url;\n            try {\n                n.onclick = function() {\n                    e.focus(),\n                    r.href = i,\n                    n.cancel()\n                }\n            } catch(s) {}\n            n.show(),\n            setTimeout(function() {\n                n.cancel && n.cancel()\n            },\n            8e3)\n        }\n    }\n    function ct() {\n        return rt.data.user_id == 0\n    }\n    function ht(e, t, n) {\n        if (o) try {\n            o.removeItem(e),\n            o.removeItem(e + \":timestamp\"),\n            o[e] = i.stringify(t),\n            o[e + \":timestamp\"] = Math.floor(n)\n        } catch(r) {}\n    }\n    function pt(e) {\n        w.theme = e,\n        e != \"none\" && w.injectStylesheet(b + \"/styles/embed\" + (e ? \".\" + e + \".css?\" + y[e] : \".\" + short_name) + \".css\")\n    }\n    if (e.DUOSHUO) return;\n    var r = e.location,\n    i = e.JSON,\n    s = e.XMLHttpRequest,\n    o = i && i.stringify && e.localStorage,\n    u = e.webkitNotifications,\n    a = t.getElementsByTagName(\"head\")[0] || t.getElementsByTagName(\"body\")[0],\n    f = e.navigator.userAgent,\n    l = t.location.protocol == \"https:\" ? \"https:\": \"http:\",\n    c = 0,\n    h,\n    p = function() {\n        var e = {\n            \"<\": \"&lt;\", \">\": \"&gt;\",\n            '\"': \"&quot;\",\n            \"'\": \"&#x27;\",\n            \"`\": \"&#x60;\"\n        },\n        t = /&(?!\\w+;)|[<>\"'`]/g,\n        n = /[&<>\"'`]/,\n        r = function(t) {\n            return e[t] || \"&amp;\"\n        };\n        return function(e) {\n            return e == null || e === !1 ? \"\": n.test(e) ? e.replace(t, r) : e\n        }\n    } (),\n    d = function(e) {\n        if (e.match(/^(http|https):/)) return e;\n        var n = t.createElement(\"a\");\n        return n.href = e,\n        x.hrefNormalized ? n.href: n.getAttribute(\"href\", 4)\n    },\n    v = {\n        start: 0,\n        end: 0\n    },\n    m = function(e) {\n        var n = this,\n        r = 0,\n        i = 0,\n        s, o, u, a, f;\n        t.selection && (o = t.selection.createRange(), o && o.parentElement() == n && (a = n.value.length, s = n.value.replace(/\\r\\n/g, \"\\n\"), u = n.createTextRange(), u.moveToBookmark(o.getBookmark()), f = n.createTextRange(), f.collapse(!1), u.compareEndPoints(\"StartToEnd\", f) > -1 ? r = i = a: (r = -u.moveStart(\"character\", -a), r += s.slice(0, r).split(\"\\n\").length - 1, u.compareEndPoints(\"EndToEnd\", f) > -1 ? i = a: (i = -u.moveEnd(\"character\", -a), i += s.slice(0, i).split(\"\\n\").length - 1)))),\n        v.start = r,\n        v.end = i\n    },\n    g = function(e) {\n        return function() {\n            return e\n        }\n    },\n    y = {\n        \"default\": \"d6149e1c\",\n        dark: \"c11b5925\",\n        bluebox: \"dbc0a9af\"\n    },\n    b = l + \"//static.duoshuo.com\",\n    w = e.DUOSHUO = {\n        DOMAIN: \"duoshuo.com\",\n        REMOTE: \"http://duoshuo.com\",\n        version: 140327,\n        loaded: {\n            jQuery: typeof jQuery != \"undefined\" && jQuery.fn.jquery >= \"1.5\",\n            smilies: !1,\n            mzadxN: typeof mzadxN != \"undefined\"\n        },\n        libs: {\n            jQuery: b + \"/libs/embed.compat.js?24f8ca3f.js\",\n            smilies: b + \"/libs/smilies.js?921e8eda.js\",\n            mzadxN: \"http://js.miaozhen.com/mz_ad_serving.js\"\n        },\n        sourceName: {\n            weibo: \"\\u65b0\\u6d6a\\u5fae\\u535a\",\n            qq: \"QQ\",\n            qzone: \"QQ\\u7a7a\\u95f4\",\n            qqt: \"\\u817e\\u8baf\\u5fae\\u535a\",\n            renren: \"\\u4eba\\u4eba\\u7f51\",\n            douban: \"\\u8c46\\u74e3\\u7f51\",\n            netease: \"\\u7f51\\u6613\\u5fae\\u535a\",\n            kaixin: \"\\u5f00\\u5fc3\\u7f51\",\n            sohu: \"\\u641c\\u72d0\\u5fae\\u535a\",\n            baidu: \"\\u767e\\u5ea6\",\n            taobao: \"\\u6dd8\\u5b9d\",\n            msn: \"MSN\",\n            google: \"\\u8c37\\u6b4c\"\n        },\n        serviceNames: {\n            weibo: \"\\u5fae\\u535a\",\n            qq: \"QQ\",\n            douban: \"\\u8c46\\u74e3\",\n            renren: \"\\u4eba\\u4eba\",\n            netease: \"\\u7f51\\u6613\",\n            kaixin: \"\\u5f00\\u5fc3\",\n            sohu: \"\\u641c\\u72d0\",\n            baidu: \"\\u767e\\u5ea6\",\n            taobao: \"\\u6dd8\\u5b9d\",\n            msn: \"MSN\",\n            google: \"\\u8c37\\u6b4c\"\n        },\n        parseDate: function(e) {\n            return e.parse(\"2011-10-28T00:00:00+08:00\") &&\n            function(t) {\n                return new e(t)\n            } || e.parse(\"2011/10/28T00:00:00+0800\") &&\n            function(t) {\n                return new e(t.replace(/-/g, \"/\").replace(/:(\\d\\d)$/, \"$1\"))\n            } || e.parse(\"2011/10/28 00:00:00+0800\") &&\n            function(t) {\n                return new e(t.replace(/-/g, \"/\").replace(/:(\\d\\d)$/, \"$1\").replace(\"T\", \" \"))\n            } ||\n            function(t) {\n                return new e(t)\n            }\n        } (Date),\n        fullTime: function(e) {\n            var t = w.parseDate(e);\n            return t.getFullYear() + \"\\u5e74\" + (t.getMonth() + 1) + \"\\u6708\" + t.getDate() + \"\\u65e5 \" + t.toLocaleTimeString()\n        },\n        elapsedTime: function(e) {\n            var t = w.parseDate(e),\n            n = new Date,\n            r = (n - c - t) / 1e3;\n            return r < 10 ? \"\\u521a\\u521a\": r < 60 ? Math.round(r) + \"\\u79d2\\u524d\": r < 3600 ? Math.round(r / 60) + \"\\u5206\\u949f\\u524d\": r < 86400 ? Math.round(r / 3600) + \"\\u5c0f\\u65f6\\u524d\": (n.getFullYear() == t.getFullYear() ? \"\": t.getFullYear() + \"\\u5e74\") + (t.getMonth() + 1) + \"\\u6708\" + t.getDate() + \"\\u65e5\"\n        },\n        require: function(e, t) {\n            if (typeof e == \"string\") w.loaded[e] ? t() : F(w.libs[e],\n            function() {\n                w.loaded[e] = !0,\n                t()\n            });\n            else if (typeof e == \"object\") {\n                var n, r = !0;\n                for (n = 0; n < e.length; n++)(function(i) {\n                    if (w.loaded[e[n]]) return;\n                    r = !1,\n                    F(w.libs[i],\n                    function() {\n                        w.loaded[i] = !0;\n                        for (var n = 0; n < e.length; n++) if (!w.loaded[e[n]]) return;\n                        t()\n                    })\n                })(e[n]);\n                r && t()\n            }\n        },\n        getCookie: function(e) {\n            var r = \" \" + e + \"=\",\n            i = t.cookie.split(\";\"),\n            s = 0,\n            o,\n            u,\n            a;\n            for (; s < i.length; s++) {\n                o = \" \" + i[s],\n                u = o.indexOf(r);\n                if (u >= 0 && u + r.length == (a = o.indexOf(\"=\") + 1)) return decodeURIComponent(o.substring(a, o.length).replace(/\\+/g, \"\"))\n            }\n            return n\n        },\n        param: function(e) {\n            var t = [];\n            for (var r in e) e[r] != n && t.push(r + \"=\" + encodeURIComponent(e[r]));\n            return t.join(\"&\")\n        },\n        ajax: function(e, t, r, o, u) {\n            var a = w.getCookie(\"duoshuo_token\");\n            r.v = w.version,\n            a ? r.jwt = a: z.remote_auth && (r.remote_auth = z.remote_auth);\n            if (s && i && i.parse) {\n                var f = new s;\n                if ( !! f && \"withCredentials\" in f) {\n                    var l;\n                    function c(e, t, n, r) {\n                        var s, a, f, l = t;\n                        if (e >= 200 && e < 300 || e === 304) if (e === 304) l = \"notmodified\",\n                        s = !0;\n                        else try {\n                            a = i.parse(n),\n                            l = \"success\",\n                            s = !0\n                        } catch(c) {\n                            l = \"parsererror\",\n                            f = c\n                        } else {\n                            f = l;\n                            if (!l || e) l = \"error\",\n                            e < 0 && (e = 0);\n                            try {\n                                a = i.parse(n)\n                            } catch(c) {\n                                l = \"parsererror\",\n                                f = c\n                            }\n                        }\n                        s ? o(a) : l === \"parseerror\" ? I(\"\\u89e3\\u6790\\u9519\\u8bef: \" + n) : (u && u(a), I(\"\\u51fa\\u9519\\u5566(\" + a.code + \"): \" + a.errorMessage), a.errorTrace && I(a.errorTrace))\n                    }\n                    f.open(e, w.hostUrl + t + \".json\" + (e == \"GET\" ? \"?\" + w.param(r) : \"\"), !0),\n                    f.withCredentials = !0,\n                    f.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded; charset=UTF-8\"),\n                    f.send(e == \"GET\" ? null: w.param(r)),\n                    l = function(e, t) {\n                        var r, i, s, o;\n                        try {\n                            if (l && (t || f.readyState === 4)) {\n                                l = n;\n                                if (t) f.readyState !== 4 && f.abort();\n                                else {\n                                    r = f.status,\n                                    s = f.getAllResponseHeaders();\n                                    try {\n                                        o = f.responseText\n                                    } catch(e) {}\n                                    try {\n                                        i = f.statusText\n                                    } catch(u) {\n                                        i = \"\"\n                                    }\n                                }\n                            }\n                        } catch(a) {\n                            t || c( - 1, a)\n                        }\n                        o && c(r, i, o, s)\n                    },\n                    f.readyState === 4 ? l() : f.onreadystatechange = l;\n                    return\n                }\n            }\n            e != \"GET\" && (r._method = \"POST\");\n            var h = \"cb_\" + Math.round(Math.random() * 1e6);\n            w[h] = function(e) {\n                switch (e.code) {\n                case 0:\n                    o(e);\n                    break;\n                default:\n                    u && u(e),\n                    I(\"\\u51fa\\u9519\\u5566(\" + e.code + \"): \" + e.errorMessage),\n                    e.errorTrace && I(e.errorTrace)\n                }\n            },\n            r.callback = \"DUOSHUO['\" + h + \"']\",\n            F(w.hostUrl + t + \".jsonp?\" + w.param(r))\n        },\n        injectStylesheet: function(e) {\n            var n = t.createElement(\"link\");\n            n.type = \"text/css\",\n            n.rel = \"stylesheet\",\n            n.href = e,\n            a.appendChild(n)\n        },\n        setCustomStyle: function(e) {\n            h || (h = t.createElement(\"style\"), h.type = \"text/css\", a.appendChild(h)),\n            e = e.replace(/\\}/g, \"}\\n\");\n            if (h.styleSheet) h.styleSheet.cssText = e;\n            else {\n                while (h.firstChild) h.removeChild(h.firstChild);\n                h.appendChild(t.createTextNode(e))\n            }\n        },\n        compileStyle: function(e) {\n            var t = \"\",\n            n = {\n                textbox: \"#ds-thread #ds-reset .ds-replybox .ds-textarea-wrapper\"\n            };\n            if (e) for (var r in e) t += n[r] + \"{\" + e[r] + \"}\\n\";\n            return t\n        },\n        init: function(e, t) {\n            e && !N[e] && (N[e] = t || {\n                type: \"EmbedThread\"\n            }),\n            w.initView && w.initView()\n        }\n    },\n    E = t.all,\n    S,\n    x = w.support = function() {\n        var n = t.createElement(\"div\");\n        n.innerHTML = '<a href=\"/a\">a</a><input type=\"checkbox\">';\n        var i = n.getElementsByTagName(\"a\")[0],\n        o = n.getElementsByTagName(\"input\")[0],\n        u = {\n            placeholder: \"placeholder\" in o,\n            touch: \"ontouchstart\" in e || \"onmsgesturechange\" in e,\n            hrefNormalized: i.getAttribute(\"href\") === \"/a\",\n            iOS: f.match(/ \\((iPad|iPhone|iPod);( U;)? CPU( iPhone)? OS /),\n            android: f.match(/ \\(Linux; U; Android /)\n        };\n        return S = !s && typeof n.style.maxHeight == \"undefined\",\n        u.authInWin = e.postMessage && e.screen.width > 800 && !u.iOS && !u.android && r.origin,\n        u\n    } (),\n    T = function(e, n) {\n        var r = (t.body || t.documentElement).style;\n        if (typeof r == \"undefined\") return ! 1;\n        if (typeof r[e] == \"string\") return n ? e: !0;\n        var i = [\"Moz\", \"Webkit\", \"ms\"],\n        e = e.charAt(0).toUpperCase() + e.substr(1),\n        s = 0;\n        for (; s < i.length; s++) if (typeof r[i[s] + e] == \"string\") return n ? i[s] + e: !0\n    },\n    N = w.selectors = {\n        \".ds-thread\": {\n            type: \"EmbedThread\"\n        },\n        \".ds-recent-comments\": {\n            type: \"RecentComments\"\n        },\n        \".ds-recent-visitors\": {\n            type: \"RecentVisitors\"\n        },\n        \".ds-top-users\": {\n            type: \"TopUsers\"\n        },\n        \".ds-top-threads\": {\n            type: \"TopThreads\"\n        },\n        \".ds-login\": {\n            type: \"LoginWidget\"\n        },\n        \".ds-thread-count\": {\n            type: \"ThreadCount\"\n        }\n    },\n    C = w.pagelets = [],\n    k = {\n        post: \"\\u53d1\\u5e03\",\n        posting: \"\\u6b63\\u5728\\u53d1\\u5e03\",\n        settings: \"\\u8bbe\\u7f6e\",\n        reply: \"\\u56de\\u590d\",\n        like: \"\\u9876\",\n        repost: \"\\u8f6c\\u53d1\",\n        report: \"\\u4e3e\\u62a5\",\n        \"delete\": \"\\u5220\\u9664\",\n        reply_to: \"\\u56de\\u590d \",\n        reposts: \"\\u8f6c\\u53d1\",\n        comments: \"\\u8bc4\\u8bba\",\n        floor: \"\\u697c\",\n        latest: \"\\u6700\\u65b0\",\n        earliest: \"\\u6700\\u65e9\",\n        hottest: \"\\u6700\\u70ed\",\n        share_to: \"\\u5206\\u4eab\\u5230:\",\n        leave_a_message: \"\\u8bf4\\u70b9\\u4ec0\\u4e48\\u5427\\u2026\",\n        no_comments_yet: \"\\u8fd8\\u6ca1\\u6709\\u8bc4\\u8bba\\uff0c\\u6c99\\u53d1\\u7b49\\u4f60\\u6765\\u62a2\",\n        repost_reason: \"\\u8bf7\\u8f93\\u5165\\u8f6c\\u53d1\\u7406\\u7531\",\n        hot_posts_title: \"\\u88ab\\u9876\\u8d77\\u6765\\u7684\\u8bc4\\u8bba\",\n        comments_zero: \"\\u6682\\u65e0\\u8bc4\\u8bba\",\n        comments_one: \"1\\u6761\\u8bc4\\u8bba\",\n        comments_multiple: \"{num}\\u6761\\u8bc4\\u8bba\",\n        reposts_zero: \"\\u6682\\u65e0\\u8f6c\\u53d1\",\n        reposts_one: \"1\\u6761\\u8f6c\\u53d1\",\n        reposts_multiple: \"{num}\\u6761\\u8f6c\\u53d1\",\n        weibo_reposts_zero: \"\\u6682\\u65e0\\u65b0\\u6d6a\\u5fae\\u535a\",\n        weibo_reposts_one: \"1\\u6761\\u65b0\\u6d6a\\u5fae\\u535a\",\n        weibo_reposts_multiple: \"{num}\\u6761\\u65b0\\u6d6a\\u5fae\\u535a\",\n        qqt_reposts_zero: \"\\u6682\\u65e0\\u817e\\u8baf\\u5fae\\u535a\",\n        qqt_reposts_one: \"1\\u6761\\u817e\\u8baf\\u5fae\\u535a\",\n        qqt_reposts_multiple: \"{num}\\u6761\\u817e\\u8baf\\u5fae\\u535a\"\n    },\n    L = function(e, t, n, r) {\n        w.ajax(\"GET\", e, t, n ||\n        function() {},\n        r)\n    },\n    A = function(e, t, n, r) {\n        w.ajax(\"POST\", e, t, n ||\n        function() {},\n        r)\n    },\n    O = [],\n    M,\n    _ = [],\n    D = function(t) {\n        if (! (\"WebSocket\" in e && i)) return ! 1;\n        _.push(i.stringify(t)),\n        M || (M = w.webSocket = new WebSocket(\"ws://ws.duoshuo.com:8201/\"), M.onopen = function() {\n            var e;\n            if (M.readyState === 1) while (e = _.shift()) M.send(e)\n        },\n        M.onmessage = function(e) {\n            try {\n                var t = 0,\n                n, r = i.parse(e.data)\n            } catch(s) {\n                return\n            }\n            switch (r.type) {\n            case \"post\":\n                for (; t < w.pagelets.length; t++) n = w.pagelets[t],\n                n.threadId == r.thread_id && n.onMessage(r);\n                break;\n            case \"notification\":\n                O.push(r),\n                lt();\n                break;\n            default:\n            }\n        },\n        e.addEventListener(\"beforeunload\",\n        function() {\n            M.close()\n        })),\n        M.onopen()\n    },\n    P = w.Collections = {},\n    H = w.Views = {},\n    B = w.Callbacks = {},\n    j = w.openDialog = function(e) {\n        return w.dialog !== n && w.dialog.el.remove(),\n        w.dialog = (new H.Dialog('<div class=\"ds-dialog\"><div class=\"ds-dialog-inner ds-rounded\"><div class=\"ds-dialog-body\">' + e + '</div><div class=\"ds-dialog-footer\"><a href=\"http://duoshuo.com/\" target=\"_blank\" class=\"ds-logo\"></a><span>\\u793e\\u4f1a\\u5316\\u8bc4\\u8bba\\u6846</span></div><a class=\"ds-dialog-close\" href=\"javascript:void(0)\" title=\"\\u5173\\u95ed\" target=\"_blank\" rel=\"noopener\"></a></div></div>')).open()\n    },\n    F = w.injectScript = function(r, i) {\n        var s = t.createElement(\"script\"),\n        o = t.head || t.getElementsByTagName(\"head\")[0] || t.documentElement;\n        s.type = \"text/javascript\",\n        s.src = r,\n        s.async = \"async\",\n        s.charset = \"utf-8\",\n        i && (s.onload = s.onreadystatechange = function(t, r) {\n            if (r || !s.readyState || /loaded|complete/.test(s.readyState)) s.onload = s.onreadystatechange = null,\n            o && s.parentNode && o.removeChild(s),\n            s = n,\n            r || i.call(e)\n        }),\n        o.insertBefore(s, o.firstChild)\n    },\n    I = w.log = function(e) {\n        typeof console == \"object\" && console.log(e)\n    },\n    q = w.smilies = {},\n    R = [\"EmbedThread\", \"RecentComments\", \"RecentVisitors\", \"TopUsers\", \"TopThreads\", \"LoginWidget\", \"ThreadCount\"],\n    U = 0,\n    z,\n    W = function() {\n        var e = {},\n        t = 0;\n        for (; t < arguments.length; t++) arguments[t] && ft(e, arguments[t]);\n        var n = w.param(e);\n        return n ? \"?\" + n: \"\"\n    },\n    X = function() {\n        var e = w.getCookie(\"duoshuo_token\");\n        return e ? {\n            jwt: e\n        }: z.remote_auth ? {\n            short_name: z.short_name,\n            remote_auth: z.remote_auth\n        }: n\n    },\n    V = function() {\n        return ! z && (z = e.duoshuoQuery) && tt.trigger(\"queryDefined\"),\n        z\n    };\n    for (var $ in Object.prototype) return alert(\"Object.prototype\\u4e0d\\u4e3a\\u7a7a\\uff0c\\u8bf7\\u4e0d\\u8981\\u7ed9Object.prototype\\u8bbe\\u7f6e\\u65b9\\u6cd5\");\n    var J = w.templates = {\n        userUrl: function(e) {\n            return e.url\n        },\n        avatarUrl: function(e, t) {\n            return e.avatar_url || nt.data.default_avatar_url\n        },\n        userAnchor: function(e) {\n            var t = J.userUrl(e);\n            return t ? '<a rel=\"nofollow author\" target=\"_blank\" href=\"' + p(t) + '\">' + p(e.name) + \"</a>\": p(e.name)\n        },\n        avatarImg: function(e, t) {\n            return '<img src=\"' + p(J.avatarUrl(e, t)) + '\" alt=\"' + p(e.name) + '\" ' + (t ? style=\"width:' + t + \" px;height:\" t 'px\"': \"\") \">\"\n        },\n        avatar: function(e, t) {\n            var n = J.avatarImg(e, t),\n            r = J.userUrl(e);\n            return r ? '<a rel=\"nofollow author\" target=\"_blank\" href=\"' + p(r) + '\" ' + (e.user_id ? \" onclick=\"\\\"this.href='\"\" w.hosturl user-url ?user_id=\" + e.user_id + \" ';\\\"\": \"\") title=\"' + p(e.name) + '\">' + n + \"</a>\": n\n        },\n        timeHtml: function(e, t) {\n            return e ? t ? '<a href=\"' + t + '\" target=\"_blank\" rel=\"nofollow\" class=\"ds-time\" datetime=\"' + e + '\" title=\"' + w.fullTime(e) + '\">' + w.elapsedTime(e) + \"</a>\": '<span class=\"ds-time\" datetime=\"' + e + '\" title=\"' + w.fullTime(e) + '\">' + w.elapsedTime(e) + \"</span>\": \"\"\n        },\n        serviceIcon: function(e, t) {\n            return '<a href=\"javascript:void(0)\" class=\"ds-service-icon' + (t ? \" -grey\": \"\") + \" ds-\" e '\" data-service=\"' + e + '\" title=\"' + w.sourceName[e] + '\" target=\"_blank\" rel=\"noopener\"></a>'\n        },\n        loginButtons: function(e) {\n            return '<div class=\"ds-login-buttons\"><p>\\u793e\\u4ea4\\u5e10\\u53f7\\u767b\\u5f55:</p><div class=\"ds-social-links\">' + J.serviceList() + J.additionalServices() + \"</div></div>\"\n        },\n        poweredBy: function(e) {\n            return '<p class=\"ds-powered-by\"><a href=\"http://duoshuo.com\" target=\"_blank\" rel=\"nofollow\">' + p(e) + \"</a></p>\"\n        },\n        indicator: g('<div id=\"ds-indicator\"></div>'),\n        waitingImg: g('<div id=\"ds-waiting\"></div>'),\n        serviceList: function(e) {\n            var t = '<ul class=\"ds-service-list\">',\n            n = [\"weibo\", \"qq\", \"renren\", \"douban\"],\n            r = 0;\n            for (; r < n.length; r++) t += J.loginItem(n[r], e);\n            return t + '<li><a class=\"ds-more-services\" href=\"javascript:void(0)\" target=\"_blank\" rel=\"noopener\">\\u66f4\\u591a\\u00bb</a></li>' + \"</ul>\"\n        },\n        additionalServices: function(e) {\n            var t = '<ul class=\"ds-service-list ds-additional-services\">',\n            n = [\"kaixin\", \"netease\", \"sohu\", \"baidu\", \"google\"],\n            r = 0;\n            for (; r < n.length; r++) t += J.loginItem(n[r], e);\n            return t + \"</ul>\"\n        },\n        loginItem: function(e, t) {\n            var n = J[t ? \"bindUrl\": \"loginUrl\"](e);\n            return '<li><a href=\"' + n + '\" rel=\"nofollow\" class=\"ds-service-link ds-' + e + '\">' + w.serviceNames[e] + (rt.data.social_uid[e] ? ' <span class=\"ds-icon ds-icon-ok\"></span>': \"\") + \"</a>\" + \"</li>\"\n        },\n        loginUrl: function(e, t) {\n            return t || (t = {}),\n            z.sso && z.sso.login && (t.sso = 1, t.redirect_uri = z.sso.login),\n            w.hostUrl + \"/login/\" + e + \"/\" + W(t)\n        },\n        bindUrl: function(e) {\n            return w.hostUrl + \"/bind/\" + e + \"/\" + W(z.sso && z.sso.login ? {\n                sso: 1,\n                redirect_uri: z.sso.login\n            }: null, X())\n        },\n        logoutUrl: function() {\n            return w.hostUrl + \"/logout/\" + W(z.sso && z.sso.logout ? {\n                sso: 1,\n                redirect_uri: z.sso.logout\n            }: null)\n        },\n        likePost: function(e) {\n            return '<a class=\"ds-post-likes\" href=\"javascript:void(0);\" target=\"_blank\" rel=\"noopener\"><span class=\"ds-icon ds-icon-like\"></span>' + k.like + (e.likes > 0 ? \"(\" + e.likes + \")\": \"\") + \"</a>\"\n        },\n        ctxPost: function(e, t, n) {\n            var r = K(e);\n            return '<li class=\"ds-ctx-entry\" ' + (n ? style=\"display:none\" ': \"\") data-post-id=\"' + e.post_id + '\"><div class=\"ds-avatar\">' + J.avatar(r) + '</div><div class=\"ds-ctx-body\"><div class=\"ds-ctx-head\">' + J.userAnchor(r) + J.timeHtml(e.created_at, e.url) + (t >= 0 ? '<div class=\"ds-ctx-nth\" title=\"' + w.fullTime(e.created_at) + '\">' + (t + 1) + k.floor + \"</div>\": \"\") + '</div><div class=\"ds-ctx-content\">' + e.message + (t >= 0 ? '\\u3000\\u3000\\u3000\\u3000\\u3000\\u3000\\u3000<div class=\"ds-comment-actions' + (e.vote > 0 ? \" ds-post-liked\": \"\") + '\">' + J.likePost(e) + ' <a class=\"ds-post-repost\" href=\"javascript:void(0);\" target=\"_blank\" rel=\"noopener\"><span class=\"ds-icon ds-icon-share\"></span>' + k.repost + \"</a>\" + ' <a class=\"ds-post-reply\" href=\"javascript:void(0);\" target=\"_blank\" rel=\"noopener\"><span class=\"ds-icon ds-icon-reply\"></span>' + k.reply + \"</a>\" + \"</div>\": \"\") + \"</div></div></li>\"\n        }\n    },\n    K = function(e) {\n        return ut[e.author_id] && ut[e.author_id].data || e.author\n    },\n    Q = function(e) {\n        var t = [];\n        for (var n in e) t.push('<input type=\"hidden\" name=\"' + n + '\" value=\"' + p(e[n]) + '\">');\n        return t.join(\"\\n\")\n    };\n    for (; U < R.length; U++) w[R[U]] = function(e) {\n        return function(t, n) {\n            n = n || {},\n            n.type = e,\n            t && !N[t] && (N[t] = n),\n            w.initSelector && w.initSelector(t, n)\n        }\n    } (R[U]),\n    w[\"create\" + R[U]] = function(e) {\n        return function(n, r) {\n            var i = t.createElement(n);\n            for (var s in r) i.setAttribute(\"data-\" + s, r[s]);\n            return w[e](i),\n            i\n        }\n    } (R[U]);\n    w.RecentCommentsWidget = w.RecentComments;\n    var G = 0,\n    Y = w.Class = function() {};\n    Y.extend = function(e) {\n        function r() { ! G && this.init && this.init.apply(this, arguments)\n        }\n        G = 1;\n        var t = new this;\n        G = 0;\n        for (var n in e) t[n] = e[n];\n        return r.prototype = t,\n        r.prototype.constructor = r,\n        r.extend = arguments.callee,\n        r\n    };\n    var Z = w.Event = Y.extend({\n        on: function(e, t) {\n            var r = this.handlers || (this.handlers = {});\n            return r[e] === n && (r[e] = []),\n            r[e].push(t),\n            this\n        },\n        trigger: function(e, t) {\n            var n = (this.handlers || (this.handlers = {}))[e];\n            if (n) for (var r = 0; r < n.length; r++) if (n[r].call(this, t) === !1) break;\n            return this\n        }\n    }),\n    et = w.Model = Z.extend({\n        init: function(e) {\n            this.data = e\n        },\n        reset: function(e) {\n            this.data = e,\n            this.trigger(\"reset\")\n        },\n        remove: function(e) {\n            this.data.splice(e, 1),\n            this.trigger(\"reset\")\n        },\n        set: function(e, t) {\n            if (t === n) for (var r in e) this.data[r] = e[r];\n            else this.data[e] = t;\n            this.trigger(\"reset\")\n        }\n    }),\n    tt = w.events = new Z,\n    nt = w.site = new et,\n    rt = w.visitor = new et,\n    it = w.unread = new et,\n    st = w.threads = {},\n    ot = w.postPool = {},\n    ut = w.users = {};\n    tt.on(\"queryDefined\",\n    function() {\n        var e = z.short_name;\n        w.hostUrl = e ? l + \"//\" + e + \".\" + w.DOMAIN: w.REMOTE,\n        z.theme && pt(z.theme);\n        if (o) {\n            var t = o[\"ds_site_\" + e],\n            n = o[\"ds_lang_\" + e];\n            t && nt.reset(i.parse(t)),\n            n && ft(k, i.parse(n))\n        }\n    }),\n    V(),\n    w.loaded.jQuery && (w.jQuery = e.jQuery),\n    w.require(\"jQuery\",\n    function() {\n        function dt(e, t, n) {\n            if (e.find(\".ds-post[data-post-id=\" + t.post_id + \"]\")[0]) return;\n            return e.find(\".ds-post-placeholder\").remove(),\n            i(J.post(t, n)).hide()[n.order == \"asc\" ? \"appendTo\": \"prependTo\"](e).slideDown(function() {})\n        }\n        function vt(e, t) {\n            var n;\n            this.delegate(\"a.ds-post-likes\", \"click\",\n            function(e) {\n                if (ct()) return gt(),\n                !1;\n                var t = i(this).parent();\n                return liked = t.hasClass(\"ds-post-liked\"),\n                matches = i(this).html().match(/\\((\\d+)\\)/),\n                likes = (matches ? parseInt(matches[1]) : 0) + (liked ? -1 : 1),\n                A(\"/api/posts/vote\", {\n                    post_id: t.closest(\".ds-ctx-entry, .ds-post-self\").attr(\"data-post-id\"),\n                    vote: liked ? 0 : 1\n                }),\n                i(this).html(i(this).html().replace(/\\(\\d+\\)/, \"\") + (likes ? \"(\" + likes + \")\": \"\")),\n                t[liked ? \"removeClass\": \"addClass\"](\"ds-post-liked\"),\n                !1\n            }).delegate(\"a.ds-post-repost\", \"click\",\n            function(e) {\n                var t = i(this).closest(\".ds-post-self\"),\n                n = ot[t.attr(\"data-post-id\")];\n                return w.repostDialog(n, \"\"),\n                !1\n            }).delegate(\"a.ds-post-delete\", \"click\",\n            function(t) {\n                if (confirm(\"\\u786e\\u5b9a\\u8981\\u5220\\u9664\\u8fd9\\u6761\\u8bc4\\u8bba\\u5417\\uff1f\")) {\n                    var n = i(this).closest(\".ds-post-self\");\n                    A(\"/api/posts/remove\", {\n                        post_id: n.attr(\"data-post-id\")\n                    }),\n                    n.parent().fadeOut(200,\n                    function() {\n                        e.data.comments--,\n                        e.updateCounter(\"duoshuo\"),\n                        i(this).remove()\n                    })\n                }\n                return ! 1\n            }).delegate(\"a.ds-post-report\", \"click\",\n            function(e) {\n                if (confirm(\"\\u786e\\u5b9a\\u8981\\u4e3e\\u62a5\\u8fd9\\u6761\\u8bc4\\u8bba\\u5417\\uff1f\")) {\n                    var t = i(this).closest(\".ds-post-self\");\n                    A(\"/api/posts/report\", {\n                        post_id: t.attr(\"data-post-id\")\n                    }),\n                    alert(\"\\u611f\\u8c22\\u60a8\\u7684\\u53cd\\u9988\\uff01\")\n                }\n                return ! 1\n            }).delegate(\"a.ds-post-reply\", \"click\",\n            function(r) {\n                var s = i(this),\n                o = s.closest(\".ds-comment-actions\");\n                if (o.hasClass(\"ds-reply-active\")) n.el.fadeOut(200,\n                function() {\n                    i(this).detach()\n                }),\n                o.removeClass(\"ds-reply-active\");\n                else {\n                    var u = s.closest(\".ds-ctx-entry, .ds-post-self\");\n                    n ? n.actionsBar.removeClass(\"ds-reply-active\") : (n = new H.Replybox(e), n.render(!0).el.addClass(\"ds-inline-replybox\").detach()),\n                    n.el.find(\"[name=parent_id]\").val(u.attr(\"data-post-id\")),\n                    n.el.show().appendTo(s.closest(\".ds-ctx-body, .ds-comment-body\")).find(\"textarea\").focus(),\n                    n.actionsBar = o.addClass(\"ds-reply-active\"),\n                    t.max_depth <= 1 ? n.postlist=\"e.postList.el:\" (n.postlist=\"u.siblings(\".ds-children\"),\" n.postlist[0] || class=\"ds-children\">').insertAfter(u)))\n                }\n                return ! 1\n            }).delegate(\"a.ds-weibo-comments\", \"click\",\n            function(e) {\n                var n = i(this).closest(\".ds-post-self\"),\n                r = n.attr(\"data-post-id\"),\n                s = n.data(\"source\");\n                if (n.attr(\"data-root-id\") == 0) {\n                    var o = n.siblings(\".ds-children\");\n                    o[0] ? o.remove() : (o = i('<ul class=\"ds-children\"></ul>').insertAfter(n), L(\"/api/posts/listComments\", bt({\n                        post_id: r\n                    }),\n                    function(e) {\n                        l(e),\n                        o.append(i.map(e.response,\n                        function(e) {\n                            return J.post(e, t)\n                        }).join(\"\"))\n                    }))\n                }\n                return ! 1\n            }).delegate(\"a.ds-weibo-reposts\", \"click\",\n            function(t) {\n                var n = i(this).closest(\".ds-post-self\"),\n                r = ot[n.attr(\"data-post-id\")],\n                s = r.data.source;\n                if (!rt.data.social_uid[s == \"qqt\" ? \"qq\": s]) {\n                    mt(s);\n                    return\n                }\n                var o = r.data.root_id,\n                u = o != \"0\" ? ot[o] : r,\n                a = \"\";\n                if (o != \"0\") {\n                    var f = K(r.data);\n                    a = (s == \"weibo\" ? \"//@\" + f.name: \"|| @\" + f.qqt_account) + \":\" + r.data.message\n                }\n                return w.repostDialog(u, a, e, s),\n                !1\n            }).delegate(\"a.ds-expand\", \"click\",\n            function(e) {\n                var t = i(this).parent();\n                return t.siblings().show(),\n                t.remove(),\n                !1\n            }),\n            x.touch || this.delegate(\"a.ds-comment-context, .ds-avatar, .ds-user-name\", \"mouseenter\",\n            function(t) {\n                var n = this;\n                if (bubbleOutTimer && $.owner == n) clearTimeout(bubbleOutTimer),\n                bubbleOutTimer = 0;\n                else {\n                    var r = i(n);\n                    Y = setTimeout(function() {\n                        Y = 0,\n                        $.owner = n,\n                        tt();\n                        var t = r.offset(),\n                        i = e.el.offset(),\n                        s = r.innerWidth() / 2,\n                        o = e.el.innerHeight() - (t.top - i.top) + 6,\n                        u = t.left - i.left - 35 + (s > 35 ? 35 : s);\n                        try {\n                            if (r.hasClass(\"ds-comment-context\")) G.attr(\"id\", \"ds-ctx-bubble\").attr(\"data-post-id\", r.attr(\"data-post-id\")).html('<ul id=\"ds-ctx\">' + J.ctxPost(ot[r.attr(\"data-parent-id\")].data) + \"</ul>\" + '<div class=\"ds-bubble-footer\"><a class=\"ds-ctx-open\" href=\"javascript:void(0);\" target=\"_blank\" rel=\"noopener\">\\u67e5\\u770b\\u5bf9\\u8bdd</a></div>');\n                            else if (r.hasClass(\"ds-avatar\") || r.hasClass(\"ds-user-name\")) {\n                                var a = {},\n                                f = a.user_id = r.attr(\"data-user-id\");\n                                if (!f) throw \"no info\";\n                                G.attr(\"id\", \"ds-user-card\").attr(\"data-user-id\", f).empty(),\n                                ut[f] ? G.html(J.userInfo(ut[f].data)) : L(\"/api/users/profile\", bt(a),\n                                function(e) {\n                                    var t = e.response;\n                                    ut[f] ? ut[f].set(t) : ut[f] = new et(t),\n                                    $.owner == n && G.html(J.userInfo(t))\n                                })\n                            }\n                            $.css({\n                                bottom: o,\n                                left: u\n                            }).appendTo(e.innerEl)\n                        } catch(l) {\n                            $.detach()\n                        }\n                    },\n                    200)\n                }\n            }).delegate(\"a.ds-comment-context, .ds-avatar, .ds-user-name\", \"mouseleave\",\n            function() {\n                Y ? (clearTimeout(Y), Y = 0) : bubbleOutTimer || bubbleOut()\n            })\n        }\n        function mt(e) {\n            var t = J[ct() ? \"loginUrl\": \"bindUrl\"](e);\n            x.authInWin && O(e, t) || (r.href = t)\n        }\n        function gt() {\n            var e = j(\"<h2>\\u793e\\u4ea4\\u5e10\\u53f7\\u767b\\u5f55</h2>\" + J.serviceList() + J.additionalServices()).el.find(\".ds-dialog\").css(\"width\", \"300px\");\n            M(e)\n        }\n        function bt(e) {\n            var n = {\n                require: \"site,visitor,nonce,serverTime,lang\" + (yt++?\"\": \",unread,log,extraCss\"),\n                site_ims: o && o[\"ds_site_\" + z.short_name + \":timestamp\"],\n                lang_ims: o && o[\"ds_lang_\" + z.short_name + \":timestamp\"],\n                referer: t.referrer\n            };\n            z.stylePatch && (n.style_patch = z.stylePatch);\n            for (var r in n) n[r] && (!S || encodeURIComponent(n[r]).length < 200) && (e[r] = n[r]);\n            return e\n        }\n        var i = w.jQuery,\n        s = i(e),\n        a = i(t),\n        l = w.loadRequire = function(e) {\n            e.serverTime && (c = (new Date).getTime() - e.serverTime * 1e3),\n            e.visitor && (!rt.data && e.visitor.user_id && u && !u.checkPermission() && D({\n                logged_user_id: e.visitor.user_id\n            }), rt.reset(e.visitor)),\n            e.site && (nt.reset(e.site), ht(\"ds_site_\" + z.short_name, e.site, e.serverTime)),\n            !w.theme && nt.data.theme && pt(nt.data.theme),\n            e.lang && (ft(k, e.lang), ht(\"ds_lang_\" + z.short_name, e.lang, e.serverTime));\n            if (e.stylesheets) for (var t = 0; t < e.stylesheets.length; t++) w.injectStylesheet(e.stylesheets[t]);\n            e.nonce && (w.nonce = e.nonce),\n            e.style && w.setCustomStyle((e.style || \"\") + w.compileStyle(z.component_style)),\n            e.unread && it.reset(e.unread)\n        },\n        h = function(e) {\n            e.stopPropagation()\n        },\n        g = function(e) { (e.ctrlKey && e.which == 13 || e.which == 10) && i(this.form).trigger(\"submit\")\n        },\n        y = function(e) {\n            var t = i(this);\n            t.height(Math.max(54, t.next(\".ds-hidden-text\").text(this.value).height() + 27))\n        },\n        O = function(t, n) {\n            var i = {\n                weibo: [760, 600],\n                renren: [420, 322],\n                qq: [504, 445],\n                netease: [810, 645],\n                sohu: [972, 600],\n                google: [600, 440],\n                taobao: [480, 585]\n            } [t] || [550, 400];\n            return e.open(n + (n.indexOf(\"?\") == -1 ? \"?\": \"&\") + w.param({\n                origin: r.origin || \"http://\" + r.host\n            }), \"_blank\", \"width=\" + i[0] + \",height=\" + i[1] + \",toolbar=no,menubar=no,location=yes\")\n        },\n        M = function(e, t) {\n            x.authInWin && e.find(t || \"a.ds-service-link\").click(function(e) {\n                var t = this.href.match(/\\/(login|bind)\\/(\\w+)\\//i);\n                if (!t || !w.serviceNames[t[2]]) return;\n                return ! O(t[2], this.href)\n            })\n        },\n        _ = function(e) {\n            return x.touch && e.addClass(\"ds-touch\"),\n            T(\"transition\") || e.addClass(\"ds-no-transition\"),\n            S && e.addClass(\"ds-ie6\"),\n            i.support.opacity || e.addClass(\"ds-no-opacity\"),\n            e\n        },\n        B = function(e) {\n            if (!x.placeholder) {\n                var t = e.attr(\"placeholder\");\n                e.val(t).focus(function() {\n                    this.value === t && (this.value = \"\")\n                }).blur(function() {\n                    this.value === \"\" && (this.value = t)\n                })\n            }\n            return e\n        };\n        if (e.postMessage) {\n            var F = function(e) {\n                if (e.origin === \"http://duoshuo.com\") switch (e.data.type) {\n                case \"login\":\n                    r.href = e.data.redirectUrl;\n                    break;\n                default:\n                }\n            };\n            e.addEventListener ? e.addEventListener(\"message\", F, !1) : e.attachEvent && e.attachEvent(\"onmessage\", F)\n        }\n        w.scrollTo = function(e) {\n            var t = e.offset().top; (t < s.scrollTop() || t > s.scrollTop() + s.height()) && i(\"html, body\").animate({\n                scrollTop: t - 40\n            },\n            200, \"swing\")\n        },\n        w.toJSON = function(e) {\n            var t = /\\r?\\n/g,\n            n = /^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,\n            r = /^(?:select|textarea)/i,\n            s = e.map(function() {\n                return this.elements ? i.makeArray(this.elements) : this\n            }).filter(function() {\n                return this.name && !this.disabled && (this.checked || r.test(this.nodeName) || n.test(this.type))\n            }).map(function(e, n) {\n                var r = i(this).val();\n                return r == null ? null: i.isArray(r) ? i.map(r,\n                function(e, r) {\n                    return {\n                        name: n.name,\n                        value: e.replace(t, \"\\r\\n\")\n                    }\n                }) : {\n                    name: n.name,\n                    value: r.replace(t, \"\\r\\n\")\n                }\n            }).toArray(),\n            o = {};\n            return i.each(s,\n            function() {\n                o[this.name] = this.value\n            }),\n            o\n        };\n        var R = w.Widget = Z.extend({\n            init: function(e, t) {\n                this.el = e,\n                this.options = t || {},\n                this.render()\n            },\n            render: function() {},\n            reset: function() {},\n            load: function(e) {\n                switch (e.code) {\n                case 0:\n                    l(e),\n                    this.onload(e);\n                    break;\n                default:\n                    this.onError(e)\n                }\n            },\n            onload: function(e) {\n                this.el.html(J[this.tmpl].call(J, e.response, i.extend(this.options, e.options)))\n            },\n            onMessage: function() {},\n            onError: function(e) {\n                I(\"\\u51fa\\u9519\\u5566(\" + e.code + \"): \" + e.errorMessage),\n                e.errorTrace && I(e.errorTrace)\n            }\n        }),\n        U = function(e) {\n            var t = {\n                \"unread-comments\": {\n                    title: \"\\u65b0\\u7559\\u8a00\\u53ca\\u56de\\u590d\",\n                    apiUrl: \"/api/users/unreadComments\",\n                    tmpl: function(e) {\n                        return '<li data-thread-id=\"' + e.thread.thread_id + '\">' + i.map(e.authors, J.userAnchor).join(\"\\u3001\") + ' \\u5728 <a class=\"ds-read\" href=\"' + e.thread.url + '#comments\" target=\"_blank\">' + p(e.thread.title || \"\\u65e0\\u6807\\u9898\") + '</a> \\u4e2d\\u56de\\u590d\\u4e86\\u4f60 <a class=\"ds-delete ds-read\" title=\"\\u77e5\\u9053\\u4e86\" href=\"javascript:void(0)\" target=\"_blank\" rel=\"noopener\">\\u77e5\\u9053\\u4e86</a></li>'\n                    },\n                    read: function(e) {\n                        var t = e.attr(\"data-thread-id\");\n                        A(\"/api/threads/read\", {\n                            thread_id: t\n                        }),\n                        it.data.comments--\n                    }\n                },\n                \"unread-notifications\": {\n                    title: \"\\u7cfb\\u7edf\\u6d88\\u606f\",\n                    apiUrl: \"/api/users/unreadNotifications\",\n                    tmpl: function(e) {\n                        return '<li data-notification-id=\"' + e.notification_id + '\" data-notification-type=\"' + e.type + '\">' + e.content + ' <a class=\"ds-delete ds-read\" title=\"\\u77e5\\u9053\\u4e86\" href=\"javascript:void(0)\" target=\"_blank\" rel=\"noopener\">\\u77e5\\u9053\\u4e86</a></li>'\n                    },\n                    read: function(e) {\n                        var t = e.attr(\"data-notification-id\");\n                        A(\"/api/notifications/read\", {\n                            notification_id: t\n                        }),\n                        it.data.notifications--\n                    }\n                }\n            } [e],\n            n = j(\"<h2>\" + t.title + \"</h2>\" + '<ul class=\"ds-unread-list\"></ul>');\n            n.on(\"close\", w.resetNotify);\n            var r = n.el.find(\".ds-unread-list\").delegate(\".ds-delete\", \"click\",\n            function(e) {\n                return i(this).parent().remove(),\n                r.children().length === 0 && n.close(),\n                !1\n            }).delegate(\".ds-read\", \"click\",\n            function(e) {\n                t.read(i(this).parent())\n            });\n            i(\"#ds-notify\").hide(),\n            L(t.apiUrl, {},\n            function(e) {\n                n.el.find(\".ds-unread-list\").html(i.map(e.response, t.tmpl).join(\"\\n\"))\n            }),\n            u && u.checkPermission() && u.requestPermission(lt)\n        };\n        w.resetNotify = function() {\n            var e = i(\"#ds-notify\"),\n            n = it.data;\n            e[0] || (e = i('<div id=\"ds-notify\"></div>').css({\n                hidden: {\n                    display: \"none\"\n                },\n                \"top-right\": {\n                    top: \"24px\",\n                    right: \"24px\"\n                },\n                \"bottom-right\": {\n                    bottom: \"24px\",\n                    right: \"24px\"\n                }\n            } [nt.data.notify_position]).delegate(\".ds-notify-unread a\", \"click\",\n            function(e) {\n                return U(i(this).data(\"type\")),\n                !1\n            }).appendTo(t.body)),\n            e.html('<div id=\"ds-reset\"><a class=\"ds-logo\" href=\"http://duoshuo.com/\" target=\"_blank\" title=\"\\u591a\\u8bf4\"></a><ul class=\"ds-notify-unread\"><li' + (n.comments ? \"\": ' style=\"display:none;\" ')><a data-type=\"unread-comments\" href=\"javascript:void(0);\" target=\"_blank\" rel=\"noopener\">\\u4f60\\u6709' + n.comments + \"\\u6761\\u65b0\\u56de\\u590d</a><li\" + (n.notifications ? \"\": ' style=\"display:none;\" ')><a data-type=\"unread-notifications\" href=\"javascript:void(0);\" target=\"_blank\" rel=\"noopener\">\\u4f60\\u6709' + n.notifications + \"\\u6761\\u7cfb\\u7edf\\u6d88\\u606f</a></li\"></li'></ul></div>\")[(n.comments || n.notifications) && nt.data.notify_position !== \"hidden\" && !i(\".ds-dialog\")[0] ? \"show\": \"hide\"]()\n        },\n        it.on(\"reset\", w.resetNotify),\n        J.replybox = function(e, t) {\n            var n = e.options,\n            r = rt.data,\n            i = [],\n            s = \"\",\n            o,\n            u = {\n                thread_id: e.threadId,\n                parent_id: \"\",\n                nonce: w.nonce\n            };\n            for (var a in r.repostOptions) r.repostOptions[a] && (i.push(a), o = 1),\n            s += J.serviceIcon(a, !r.repostOptions[a]);\n            return '<div class=\"ds-replybox\"><a class=\"ds-avatar\" ' + (ct() ? href=\"javascript:void(0);\" onclick=\"return false\" ': settings avatar \" w(x()) '\" target=\"_blank\" title=\"\\u8bbe\\u7f6e\\u5934\\u50cf\" ')>\" + J.avatarImg(r) + \"</a>\" + '<form method=\"post\">' + Q(u) + '<div class=\"ds-textarea-wrapper ds-rounded-top\">' + '<textarea name=\"message\" title=\"Ctrl+Enter\\u5feb\\u6377\\u63d0\\u4ea4\" placeholder=\"' + p(k.leave_a_message) + '\"></textarea>' + '<pre class=\"ds-hidden-text\"></pre>' + \"</div>\" + '<div class=\"ds-post-toolbar\">' + '<div class=\"ds-post-options ds-gradient-bg\">' + '<span class=\"ds-sync\">' + (!ct() && s ? '<input id=\"ds-sync-checkbox' + (t ? \" -inline\": \"\") + '\" type=\"checkbox\" name=\"repost\" ' (o ? 'checked=\"checked\" ': 'value=\"' + i.join(\" ,\")> <label for=\"ds-sync-checkbox' + (t ? \" -inline\": \"\") + '\">' + k.share_to + \"</label>\" + s: \"\") + \"</span>\" + \"</div>\" + '<button class=\"ds-post-button\" type=\"submit\">' + p(k.post) + \"</button>\" + '<div class=\"ds-toolbar-buttons\">' + (n.use_smilies ? '<a class=\"ds-toolbar-button ds-add-emote\" title=\"\\u63d2\\u5165\\u8868\\u60c5\"></a>': \"\") + (n.use_images && n.parse_html_enabled ? '<a class=\"ds-toolbar-button ds-add-image\" title=\"\\u63d2\\u5165\\u56fe\\u7247\"></a>': \"\") + \"</div>\" + \"</div>\" + \"</form>\" + \"</div>\"\n        },\n        H.Replybox = function(e) {\n            this.embedThread = e\n        },\n        H.Replybox.prototype = {\n            render: function(e) {\n                function T(e) {\n                    e.data(\"submitting\", !0),\n                    e.find(\".ds-post-button\").addClass(\"ds-waiting\").html(k.posting)[0].disabled = !0\n                }\n                function N(e) {\n                    e.data(\"submitting\", !1),\n                    e.find(\".ds-post-button\").removeClass(\"ds-waiting\").html(k.post)[0].disabled = !1\n                }\n                var n = this,\n                r = n.embedThread,\n                s = r.options,\n                u = function(e) {\n                    w.require(\"smilies\",\n                    function() {})\n                },\n                a = n.el = i(J.replybox(r, e)).click(u),\n                f = a.find(\"form\"),\n                l = f.find(\"input[type=checkbox]\")[0],\n                c = f.find(\"a.ds-service-icon, a.ds-service-icon-grey\"),\n                h = B(f.find(\"textarea\")).focus(u).keyup(g).keyup(y).bind(\"focus mousedown mouseup keyup\", m),\n                d = a.find(\".ds-add-emote\").click(function(e) {\n                    var r = w.smiliesTooltip;\n                    return d.toggleClass(\"ds-expanded\").hasClass(\"ds-expanded\") ? (r || (r = w.smiliesTooltip = new H.SmiliesTooltip, r.render(), w.require(\"smilies\",\n                    function() {\n                        r.reset(\"\\u5fae\\u535a-\\u9ed8\\u8ba4\")\n                    })), r.replybox = n, r.el.appendTo(t.body).css({\n                        top: n.el.offset().top + n.el.outerHeight() + 4 + \"px\",\n                        left: n.el.find(\".ds-textarea-wrapper\").offset().left + \"px\"\n                    }), i(t.body).click(E)) : E(e),\n                    !1\n                }),\n                b = a.find(\".ds-add-image\").click(function(e) {\n                    var n = h[0],\n                    r = n.value,\n                    i = \"\\u8bf7\\u8f93\\u5165\\u56fe\\u7247\\u5730\\u5740\",\n                    s = '<img src=\"' + i + '\">';\n                    if (t.selection) {\n                        n.value = r.substring(0, v.start) + s + r.substring(v.end, r.length),\n                        n.value = n.value.replace(\"\\u8bf4\\u70b9\\u4ec0\\u4e48\\u5427 ...\", \"\"),\n                        n.focus();\n                        var o = t.selection.createRange();\n                        o.collapse(),\n                        o.findText(i),\n                        o.select()\n                    } else {\n                        n.value = r.substring(0, n.selectionStart) + s + r.substring(n.selectionEnd);\n                        var u = n.value.search(i);\n                        n.setSelectionRange(u, u + i.length),\n                        n.focus()\n                    }\n                    e.preventDefault()\n                }),\n                E = n.hideSmilies = function(e) {\n                    d.removeClass(\"ds-expanded\"),\n                    w.smiliesTooltip.el.detach(),\n                    i(t.body).unbind(\"click\", E)\n                },\n                S = function(e, t) {\n                    var n = j('<h2>\\u793e\\u4ea4\\u5e10\\u53f7\\u767b\\u5f55</h2><div class=\"ds-icons-32\">' + i.map([\"weibo\", \"qq\", \"renren\", \"kaixin\", \"douban\", \"netease\", \"sohu\"],\n                    function(e) {\n                        return '<a class=\"ds-' + e + '\" href=\"' + J.loginUrl(e) + '\">' + w.sourceName[e] + \"</a>\"\n                    }).join(\"\") + \"</div>\" + (s.deny_anonymous ? \"\": '<h2>\\u4f5c\\u4e3a\\u6e38\\u5ba2\\u7559\\u8a00</h2><form><div class=\"ds-control-group\"><input type=\"text\" name=\"author_name\" id=\"ds-dialog-name\" value=\"' + p(rt.data.name) + '\" required>' + '<label for=\"ds-dialog-name\">\\u540d\\u5b57(\\u5fc5\\u586b)</label>' + \"</div>\" + (s.require_guest_email ? '<div class=\"ds-control-group\"><input type=\"email\" name=\"author_email\" id=\"ds-dialog-email\" value=\"' + p(rt.data.email) + '\" required>' + '<label for=\"ds-dialog-email\">\\u90ae\\u7bb1(\\u5fc5\\u586b)</label>' + \"</div>\": \"\") + (s.require_guest_url ? '<div class=\"ds-control-group\"><input type=\"url\" name=\"author_url\" id=\"ds-dialog-url\" placeholder=\"http://\" value=\"' + p(rt.data.url || \" \") + '\">' + '<label for=\"ds-dialog-url\">\\u7f51\\u5740(\\u53ef\\u9009)</label>' + \"</div>\": \"\") + '<button type=\"submit\">\\u53d1\\u5e03</button>' + \"</form>\")),\n                    r = n.el.find(\".ds-dialog\").css(\"width\", \"320px\");\n                    M(r, \".ds-icons-32 a\");\n                    if (!s.deny_anonymous) {\n                        var o = n.el.find(\"form\");\n                        o.submit(function(e) {\n                            var r = o.find(\"input[name=author_email]\").val();\n                            return (r || s.require_guest_email) && !r.match(/^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/) ? (alert(\"\\u8bf7\\u8f93\\u5165\\u4e00\\u4e2a\\u6709\\u6548\\u7684email\\u5730\\u5740.\"), !1) : (t(w.toJSON(o)), n.close(), !1)\n                        }),\n                        o.find(\"input[name=author_name]\")[0].focus()\n                    }\n                };\n                s.deny_anonymous && h.focus(function(e) {\n                    if (ct()) {\n                        S(f, C);\n                        var t = function(e) {\n                            e.stopPropagation(),\n                            h.unbind(\"click\", t)\n                        };\n                        h.click(t)\n                    }\n                    return ! 1\n                });\n                var C = function(e) {\n                    T(f),\n                    A(\"/api/posts/create\", i.extend(w.toJSON(f), e),\n                    function(e) {\n                        var t = e.response,\n                        i = dt(n.postList, t, s);\n                        s.order == \"asc\" == (s.formPosition == \"top\") && w.scrollTo(i),\n                        ot[t.post_id] = new et(t),\n                        r.data.comments++,\n                        r.updateCounter(\"duoshuo\"),\n                        h.val(\"\").trigger(\"keyup\"),\n                        N(f),\n                        a.hasClass(\"ds-inline-replybox\") && (a.detach(), n.actionsBar.removeClass(\"ds-reply-active\"));\n                        if (o) try {\n                            o.removeItem(\"ds_draft_\" + r.threadId)\n                        } catch(u) {}\n                    },\n                    function(e) {\n                        N(f),\n                        alert(e.errorMessage)\n                    })\n                };\n                f.submit(function(e) {\n                    if (f.data(\"submitting\")) return ! 1;\n                    var t = i.trim(f[0].message.value);\n                    return t == \"\" || !x.placeholder && t == h.attr(\"placeholder\") ? (alert(\"\\u60a8\\u8fd8\\u6ca1\\u5199\\u5185\\u5bb9\\u5462\"), !1) : (ct() ? S(f, C) : C(), !1)\n                });\n                var L = function(e) {\n                    return i(e).hasClass(\"ds-service-icon-grey\") ? null: i(e).attr(\"data-service\")\n                };\n                return c.click(function() {\n                    return i(this).toggleClass(\"ds-service-icon-grey\").toggleClass(\"ds-service-icon\"),\n                    l.value = i.map(c, L).join(\",\"),\n                    l.checked = l.value != \"\",\n                    !1\n                }),\n                i(l).change(function() {\n                    var e = this.checked;\n                    c[e ? \"removeClass\": \"addClass\"](\"ds-service-icon-grey\")[e ? \"addClass\": \"removeClass\"](\"ds-service-icon\"),\n                    this.value = i.map(c, L).join(\",\")\n                }),\n                this\n            }\n        },\n        H.Dialog = Z.extend({\n            init: function(e, t) { (this.el = i(\"#ds-wrapper\"))[0] || (this.el = _(i('<div id=\"ds-wrapper\"></div>'))),\n                this.options = i.extend({\n                    width: 600\n                },\n                t),\n                e !== n && i(e).attr(\"id\", \"ds-reset\").appendTo(this.el)\n            },\n            open: function() {\n                var e = this;\n                e.el.hide().appendTo(t.body).fadeIn(200),\n                S && e.el.css(\"top\", s.scrollTop() + 100),\n                e.el.show().find(\".ds-dialog\").delegate(\"a.ds-dialog-close\", \"click\",\n                function(t) {\n                    return e.close(),\n                    !1\n                }).click(h);\n                var n = function(t) {\n                    if (t.which == 27) return e.close(),\n                    !1\n                },\n                r = function(t) {\n                    return e.close(),\n                    !1\n                };\n                return a.keydown(n),\n                i(t.body).click(r),\n                e.close = function(s) {\n                    a.unbind(\"keydown\", n),\n                    i(t.body).unbind(\"click\", r),\n                    e.el.fadeOut(200,\n                    function() {\n                        i(this).remove()\n                    }),\n                    e.trigger(\"close\")\n                },\n                e\n            }\n        }),\n        J.likePanel = function(e) {\n            return e.likes ? '<span class=\"ds-highlight\">' + e.likes + \"</span> \\u4eba\\u559c\\u6b22\": \"\"\n        },\n        J.likeTooltip = function(e) {\n            var t = {\n                qzone: \"QQ\\u7a7a\\u95f4\",\n                weibo: \"\\u65b0\\u6d6a\\u5fae\\u535a\",\n                qqt: \"\\u817e\\u8baf\\u5fae\\u535a\",\n                renren: \"\\u4eba\\u4eba\\u7f51\",\n                kaixin: \"\\u5f00\\u5fc3\\u7f51\",\n                douban: \"\\u8c46\\u74e3\\u7f51\",\n                baidu: \"\\u767e\\u5ea6\\u641c\\u85cf\",\n                netease: \"\\u7f51\\u6613\\u5fae\\u535a\",\n                sohu: \"\\u641c\\u72d0\\u5fae\\u535a\"\n            },\n            n = [];\n            for (var r in t) n.push('<li><a class=\"ds-share-to-' + r + \" ds-service-link ds-\" + r '\" href=\"' + w.hostUrl + \" share-proxy ?\" w.param({ service: r, thread_id: e.thread_id })>' + t[r] + \"</a></li>\");\n            var i = Math.ceil(n.length / 2);\n            return '<div class=\"ds-like-tooltip ds-rounded\"><p>\\u5f88\\u9ad8\\u5174\\u4f60\\u80fd\\u559c\\u6b22\\uff0c\\u5206\\u4eab\\u4e00\\u4e0b\\u5427\\uff1a</p><ul>' + n.slice(0, i).join(\"\") + \"</ul><ul>\" + n.slice(i).join(\"\") + '</ul><p class=\"ds-like-tooltip-footer\"><a class=\"ds-like-tooltip-close\">\\u7b97\\u4e86</a></p></div>'\n        },\n        H.Meta = function(e) {\n            this.embedThread = e\n        },\n        H.Meta.prototype = {\n            render: function() {\n                var r = this,\n                s = r.embedThread,\n                o = s.data,\n                u = r.el = i('<div class=\"ds-meta\"><a href=\"javascript:void(0)\" class=\"ds-like-thread-button ds-rounded' + (o.user_vote > 0 ? \" ds-thread-liked\": \"\") + '\" target=\"_blank\" rel=\"noopener\"><span class=\"ds-icon ds-icon-heart\"></span>' + ' <span class=\"ds-thread-like-text\">' + (o.user_vote > 0 ? \"\\u5df2\\u559c\\u6b22\": \"\\u559c\\u6b22\") + '</span><span class=\"ds-thread-cancel-like\">\\u53d6\\u6d88\\u559c\\u6b22</span></a><span class=\"ds-like-panel\"></span></div>'),\n                a = u.find(\".ds-like-thread-button\").click(function(f) {\n                    var l = a.hasClass(\"ds-thread-liked\");\n                    A(\"/api/threads/vote\", {\n                        thread_id: s.threadId,\n                        vote: l ? 0 : 1\n                    },\n                    function(e) {\n                        i.each(e.response.thread,\n                        function(e, t) {\n                            o[e] = t\n                        }),\n                        r.resetLikePanel()\n                    }),\n                    a.toggleClass(\"ds-thread-liked\"),\n                    a.find(\".ds-thread-like-text\").text(l ? \"\\u559c\\u6b22\": \"\\u5df2\\u559c\\u6b22\");\n                    var c = function(e) {\n                        r.tooltip.detach(),\n                        i(t.body).unbind(\"click\", c)\n                    };\n                    return l ? r.tooltip && c(f) : (r.tooltip === n && (r.tooltip = i(J.likeTooltip(o)).click(h).delegate(\"a\", \"click\",\n                    function(t) {\n                        switch (this.className) {\n                        case \"ds-like-tooltip-close\":\n                            c(t);\n                            break;\n                        default:\n                            if (!e.open(this.href, \"_blank\", \"height=500,width=600,top=0,left=0,toolbar=no,menubar=no,resizable=yes,location=yes,status=no\")) return\n                        }\n                        return ! 1\n                    })), r.tooltip.appendTo(s.innerEl).css({\n                        top: u.position().top + u.outerHeight() - 4 + \"px\",\n                        left: 0\n                    }), i(t.body).click(c)),\n                    !1\n                });\n                return r.resetLikePanel(),\n                ct() && u.hide(),\n                r\n            },\n            resetLikePanel: function() {\n                this.el.find(\".ds-like-panel\").html(J.likePanel(this.embedThread.data))\n            }\n        },\n        J.postListHead = function(e) {\n            var t = e.data,\n            n = e.options;\n            return '<div class=\"ds-comments-info\"><div class=\"ds-sort\"><a class=\"ds-order-desc\">' + k.latest + '</a><a class=\"ds-order-asc\">' + k.earliest + '</a><a class=\"ds-order-hot\">' + k.hottest + '</a></div><ul class=\"ds-comments-tabs\"><li class=\"ds-tab\"><a class=\"ds-comments-tab-duoshuo ds-current\" href=\"javascript:void(0);\" target=\"_blank\" rel=\"noopener\"></a></li>' + (n.show_reposts && t.reposts ? '<li class=\"ds-tab\"><a class=\"ds-comments-tab-repost\" href=\"javascript:void(0);\" target=\"_blank\" rel=\"noopener\"></a></li>': \"\") + (n.show_weibo && t.weibo_reposts ? '<li class=\"ds-tab\"><a class=\"ds-comments-tab-weibo\" href=\"javascript:void(0);\" target=\"_blank\" rel=\"noopener\"></a></li>': \"\") + (n.show_qqt && t.qqt_reposts ? '<li class=\"ds-tab\"><a class=\"ds-comments-tab-qqt\" href=\"javascript:void(0);\" target=\"_blank\" rel=\"noopener\"></a></li>': \"\") + \"</ul>\" + \"</div>\"\n        },\n        H.PostListHead = function(e) {\n            this.embedThread = e\n        },\n        H.PostListHead.prototype = {\n            render: function() {\n                var e = this.embedThread,\n                t = e.options,\n                n = e.postList,\n                r = this.el = i(J.postListHead(e)),\n                s = r.find(\"ul.ds-comments-tabs\").delegate(\".ds-tab a\", \"click\",\n                function(t) {\n                    s.find(\"a.ds-current\").removeClass(\"ds-current\"),\n                    n.params.page = 1;\n                    var r = t.currentTarget;\n                    switch (r.className) {\n                    case \"ds-comments-tab-duoshuo\":\n                        n.params.source = \"duoshuo\",\n                        e.replybox.el.show();\n                        break;\n                    case \"ds-comments-tab-repost\":\n                        n.params.source = \"repost\",\n                        e.replybox.el.hide();\n                        break;\n                    case \"ds-comments-tab-weibo\":\n                        n.params.source = \"weibo\",\n                        e.replybox.el.hide();\n                        break;\n                    case \"ds-comments-tab-qqt\":\n                        n.params.source = \"qqt\",\n                        e.replybox.el.hide();\n                        break;\n                    default:\n                    }\n                    return i(r).addClass(\"ds-current\"),\n                    n.refetch(),\n                    !1\n                }),\n                o = r.find(\".ds-sort\").delegate(\"a\", \"click\",\n                function(e) {\n                    return o.find(\"a.ds-current\").removeClass(\"ds-current\"),\n                    n.params.order = t.order = this.className.replace(\"ds-order-\", \"\"),\n                    n.params.page = 1,\n                    n.refetch(),\n                    i(this).addClass(\"ds-current\"),\n                    !1\n                });\n                return o.find(\".ds-order-\" + n.params.order).addClass(\"ds-current\"),\n                this\n            }\n        },\n        H.Paginator = function(e) {\n            e = e || {};\n            var t = this,\n            n = t.el = e.el || i('<div class=\"ds-paginator\"></div>'),\n            r = t.collection = e.collection;\n            n.delegate(\"a\", \"click\",\n            function(e) {\n                return r.params.page = parseInt(this.innerHTML),\n                r.refetch(),\n                n.find(\".ds-current\").removeClass(\"ds-current\"),\n                i(this).addClass(\"ds-current\"),\n                !1\n            })\n        },\n        H.Paginator.prototype = {\n            reset: function(e) {\n                function i(e) {\n                    r.push('<a data-page=\"' + e + '\" href=\"javascript:void(0);\" target=\"_blank\" rel=\"noopener\">' + e + \"</a>\")\n                }\n                var t = this.collection.params.page || 1,\n                n, r = [];\n                if (t > 1) {\n                    i(1),\n                    n = t > 4 ? t - 2 : 2,\n                    n > 2 && r.push('<span class=\"page-break\">...</span>');\n                    for (; n < t; n++) i(n)\n                }\n                r.push('<a data-page=\"' + t + '\" href=\"javascript:void(0);\" class=\"ds-current\" target=\"_blank\" rel=\"noopener\">' + t + \"</a>\");\n                if (t < e.pages) {\n                    for (n = t + 1; n <= 4 t + && n < e.pages; n++) i(n); e.pages r.push('<span class=\"page-break\">...'),\n                    i(e.pages)\n                }\n                this.el.html('<div class=\"ds-border\"></div>' + r.join(\" \"))[e.pages > 1 ? \"show\": \"hide\"]()\n            }\n        },\n        J.smiliesTooltip = function(e) {\n            var t = '<div id=\"ds-smilies-tooltip\"><ul class=\"ds-smilies-tabs\">';\n            for (var n in e) t += \"<li><a>\" + n + \"</a></li>\";\n            return t + '</ul><div class=\"ds-smilies-container\"></div></div>'\n        },\n        w.addSmilies = function(e, t) {\n            var n = w.smiliesTooltip;\n            n && n.el.find(\"ul.ds-smilies-tabs\").append(\"<li><a>\" + e + \"</a></li>\"),\n            w.smilies[e] = t\n        },\n        H.SmiliesTooltip = function() {},\n        H.SmiliesTooltip.prototype = {\n            render: function() {\n                var e = this,\n                n = e.el = i(J.smiliesTooltip(q));\n                return n.click(h).find(\"ul.ds-smilies-tabs\").delegate(\"a\", \"click\",\n                function(t) {\n                    e.reset(this.innerHTML)\n                }),\n                n.find(\".ds-smilies-container\").delegate(\"img\", \"click\",\n                function(n) {\n                    var r = e.replybox,\n                    i = r.el.find(\"textarea\")[0],\n                    s = i.value;\n                    if (t.selection) {\n                        i.value = s.substring(0, v.start) + this.title + s.substring(v.end, s.length),\n                        i.value = i.value.replace(k.leave_a_message, \"\"),\n                        i.focus();\n                        var o = t.selection.createRange();\n                        o.moveStart(\"character\", v.start + this.title.length),\n                        o.collapse(),\n                        o.select()\n                    } else {\n                        var u = i.selectionStart + this.title.length;\n                        i.value = s.substring(0, i.selectionStart) + this.title + s.substring(i.selectionEnd),\n                        i.setSelectionRange(u, u)\n                    }\n                    r.hideSmilies(),\n                    i.focus()\n                }),\n                this\n            },\n            reset: function(e) {\n                var t = this.el.find(\"ul.ds-smilies-tabs\");\n                t.find(\"a.ds-current\").removeClass(\"ds-current\"),\n                t.find(\"a\").filter(function() {\n                    return this.innerHTML == e\n                }).addClass(\"ds-current\");\n                var n = \"<ul>\";\n                return i.each(q[e],\n                function(t, r) {\n                    var i = e.indexOf(\"\\u5fae\\u535a\") === 0 ? \"http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/\" + r.replace(\"_org\", \"_thumb\") : b + \"/images/smilies/\" + r;\n                    e === \"WordPress\" && (t = \" \" + t + \" \"),\n                    n += '<li><img src=\"' + i + '\" title=\"' + p(t) + '\"></li>'\n                }),\n                n += \"</ul>\",\n                this.el.find(\".ds-smilies-container\").html(n),\n                this\n            }\n        },\n        J.postPlaceholder = function() {\n            return '<li class=\"ds-post ds-post-placeholder\">' + k.no_comments_yet + \"</li>\"\n        },\n        J.post = function(e, t) {\n            var n = K(e),\n            r = n.user_id ? ' data-user-id=\"' + n.user_id + '\"': \"\",\n            s = n.qqt_account || \"\",\n            o = J.timeHtml(e.created_at, e.url),\n            u = e.parents || [];\n            switch (e.source) {\n            case \"duoshuo\":\n                o += '<a class=\"ds-post-reply\" href=\"javascript:void(0);\" target=\"_blank\" rel=\"noopener\"><span class=\"ds-icon ds-icon-reply\"></span>' + k.reply + \"</a>\" + J.likePost(e) + '<a class=\"ds-post-repost\" href=\"javascript:void(0);\" target=\"_blank\" rel=\"noopener\"><span class=\"ds-icon ds-icon-share\"></span>' + k.repost + \"</a>\" + '<a class=\"ds-post-report\" href=\"javascript:void(0);\" target=\"_blank\" rel=\"noopener\"><span class=\"ds-icon ds-icon-report\"></span>' + k.report + \"</a>\" + (e.privileges[\"delete\"] ? '<a class=\"ds-post-delete\" href=\"javascript:void(0);\" target=\"_blank\" rel=\"noopener\"><span class=\"ds-icon ds-icon-delete\"></span>' + k[\"delete\"] + \"</a>\": \"\");\n                break;\n            case \"qqt\":\n            case \"weibo\":\n                o += '<a class=\"ds-weibo-comments\" href=\"javascript:void(0);\" target=\"_blank\" rel=\"noopener\">' + k.comments + (e.type.match(/\\-comment$/) ? \"\": '(<span class=\"ds-count\">' + e.comments + \"</span>)\") + \"</a>\" + '<a class=\"ds-weibo-reposts\" href=\"javascript:void(0);\" target=\"_blank\" rel=\"noopener\">' + k.reposts + (e.type.match(/\\-comment$/) ? \"\": '(<span class=\"ds-count\">' + e.reposts + \"</span>)\") + \"</a>\";\n                break;\n            default:\n            }\n            return '<li class=\"ds-post\" data-post-id=\"' + e.post_id + '\"><div class=\"ds-post-self\" data-post-id=\"' + e.post_id + '\" data-thread-id=\"' + e.thread_id + '\" data-root-id=\"' + e.root_id + '\" data-source=\"' + e.source + '\"><div class=\"ds-avatar\" ' + r \">\" + J.avatar(n) + (w.sourceName[e.source] ? J.serviceIcon(e.source) : \"\") + '</div><div class=\"ds-comment-body\"><div class=\"ds-comment-header\">' + (n.url ? '<a class=\"ds-user-name ds-highlight\" data-qqt-account=\"' + s + '\" href=\"' + p(n.url) + '\" ' + (n.user_id ? \" onclick=\"\\\"this.href='\"\" w.hosturl user-url ?user_id=\" + n.user_id + \" ';\\\"\": \"\") rel=\"nofollow\" target=\"_blank\" r>\" + p(n.name) + \"</a>\": '<span class=\"ds-user-name\" ' + r data-qqt-account=\"'+s+'\">'+p(n.name)+\"</span>\") + \"<span class=\"\\\"ua\\\"\">\" + sskadmin(e.author) + \"<span class=\"\\\"ua\\\"\">\" + show_ua(e.agent) + \"</span></span></div>\" + (t.max_depth == 1 && t.show_context && u.length ? '<ol id=\"ds-ctx\">' + i.map(u,\n            function(e, t) {\n                return (t == 1 && u.length > 2 ? '<li class=\"ds-ctx-entry\"><a href=\"javascript:void(0);\" class=\"ds-expand\" target=\"_blank\" rel=\"noopener\">\\u8fd8\\u6709' + (u.length - 2) + \"\\u6761\\u8bc4\\u8bba</a></li>\": \"\") + (ot[e] ? J.ctxPost(ot[e].data, t, t && t < u.length - 1) : \"\")\n            }).join(\"\") + \"</ol>\": \"\") + \"<p>\" + (u.length >= t.max_depth && (!t.show_context || t.max_depth > 1) && e.parent_id && ot[e.parent_id] ? '<a class=\"ds-comment-context\" data-post-id=\"' + e.post_id + '\" data-parent-id=\"' + e.parent_id + '\">' + k.reply_to + p(K(ot[e.parent_id].data).name) + \": </a>\": \"\") + e.message + '</p><div class=\"ds-comment-footer ds-comment-actions' + (e.vote > 0 ? \" ds-post-liked\": \"\") + '\">' + o + \"</div></div></div>\" + (t.max_depth > 1 && (e.childrenArray || e.children) && e.source != \"weibo\" && e.source != \"qqt\" ? '<ul class=\"ds-children\">' + i.map(e.childrenArray || e.children,\n            function(e) {\n                return ot[e] ? J.post(ot[e].data, t) : \"\"\n            }).join(\"\") + \"</ul>\": \"\") + \"</li>\"\n        };\n        var $ = i('<div id=\"ds-bubble\"><div class=\"ds-bubble-content\"></div><div class=\"ds-arrow ds-arrow-down ds-arrow-border\"></div><div class=\"ds-arrow ds-arrow-down\"></div></div>'),\n        G = $.find(\".ds-bubble-content\").delegate(\"a.ds-ctx-open\", \"click\",\n        function(e) {\n            L(\"/api/posts/conversation\", {\n                post_id: G.attr(\"data-post-id\")\n            },\n            function(e) {\n                t.el.find(\"ol\").html(i.map(e.response, J.ctxPost).join(\"\\n\"))\n            });\n            var t = j('<h2>\\u67e5\\u770b\\u5bf9\\u8bdd</h2><ol id=\"ds-ctx\"></ol>');\n            return t.el.find(\".ds-dialog\").css(\"width\", \"600px\"),\n            t.el.find(\".ds-dialog-body\").css({\n                \"max-height\": \"350px\",\n                _height: \"350px\",\n                \"overflow-y\": \"auto\",\n                \"padding-top\": \"10px\"\n            }),\n            !1\n        }),\n        Y = bubbleOutTimer = 0,\n        tt = function() {\n            bubbleOutTimer && (clearTimeout(bubbleOutTimer), bubbleOutTimer = 0)\n        };\n        bubbleOut = function() {\n            bubbleOutTimer = setTimeout(function() {\n                bubbleOutTimer = 0,\n                $.detach()\n            },\n            400)\n        },\n        $.mouseenter(tt).mouseleave(bubbleOut),\n        J.userInfo = function(e) {\n            var t = [];\n            return i.each(e.social_uid,\n            function(e, n) {\n                t.push('<a href=\"' + w.REMOTE + \" user-proxy \" + e n ' target=\"_blank\" class=\"ds-service-icon ds-' + e + '\" title=\"' + w.sourceName[e] + '\"></a>')\n            }),\n            '<a href=\"' + p(e.url) + '\" class=\"ds-avatar\" target=\"_blank\">' + J.avatarImg(e) + '</a><a href=\"' + p(e.url) + '\" class=\"ds-user-name ds-highlight\" target=\"_blank\">' + p(e.name) + \"</a>\" + t.join(\"\") + '<p class=\"ds-user-card-meta\"><a href=\"' + w.REMOTE + \" profile \" + e.user_id ' target=\"_blank\"><span class=\"ds-highlight\">' + e.comments + \"</span>\\u6761\\u8bc4\\u8bba</a></p>\" + (e.description ? '<p class=\"ds-user-description\">' + p(e.description) + \"</p>\": \"\")\n        },\n        P.PostList = function(e) {\n            e && (e.params && (this.params = e.params), e.embedThread && (this.embedThread = e.embedThread)),\n            this.el = i('<ul class=\"ds-comments\"></ul>')\n        },\n        P.PostList.prototype = {\n            url: \"/api/threads/listPosts\",\n            render: function() {\n                return vt.call(this.el, this.embedThread, this.embedThread.options),\n                this\n            },\n            reset: function(e) {\n                var t = this.embedThread.options;\n                this.el.html(e[0] ? i.map(e,\n                function(e) {\n                    return ot[e] ? J.post(ot[e].data, t) : \"\"\n                }).join(\"\") : J.postPlaceholder())\n            },\n            refetch: function() {\n                var e = this,\n                n = i(J.indicator()).appendTo(t.body).fadeIn(200);\n                e.el.fadeTo(200, .5),\n                L(e.url, e.params,\n                function(t) {\n                    at(ot, t.parentPosts || t.relatedPosts),\n                    at(ut, t.users),\n                    e.reset(t.response),\n                    e.embedThread.paginator.reset(t.cursor),\n                    e.el.fadeTo(200, 1),\n                    w.scrollTo(e.el),\n                    n.remove()\n                })\n            }\n        },\n        w.repostDialog = function(e, t, n, r) {\n            var i = j('<h2>\\u8f6c\\u53d1\\u5230\\u5fae\\u535a</h2><div class=\"ds-quote\"><strong>@' + p(K(e.data).name) + \"</strong>: \" + e.data.message + \"</div>\" + \"<form>\" + Q({\n                post_id: e.data.post_id\n            }) + '<div class=\"ds-textarea-wrapper\">' + '<textarea name=\"message\" title=\"Ctrl+Enter\\u5feb\\u6377\\u63d0\\u4ea4\" placeholder=\"' + p(k.repost_reason) + '\">' + p(t) + \"</textarea>\" + '<pre class=\"ds-hidden-text\"></pre>' + \"</div>\" + '<div class=\"ds-actions\">' + (r ? Q({\n                \"service[]\": r\n            }) : '<label><input type=\"checkbox\" name=\"service[]\" value=\"weibo\" ' + (rt.data.social_uid.weibo ? checked=\"checked\" ': \"\")><span class=\"ds-service-icon ds-weibo\"></span>\\u65b0\\u6d6a\\u5fae\\u535a</label>  ' + '<label><input type=\"checkbox\" name=\"service[]\" value=\"qqt\" ' + (rt.data.social_uid.qq ? checked=\"checked\" ': \"\")><span class=\"ds-service-icon ds-qqt\"></span>\\u817e\\u8baf\\u5fae\\u535a</label>') + '<button type=\"submit\">' + k.repost + \"</button>\" + \"</div>\" + \"</form>\"),\n            s = i.el.find(\"form\").submit(function(e) {\n                return ! r && !s.find(\"[type=checkbox]:checked\")[0] ? (alert(\"\\u8fd8\\u6ca1\\u6709\\u9009\\u53d1\\u5e03\\u5230\\u54ea\\u513f\\u5462\"), !1) : (A(\"/api/posts/repost\", w.toJSON(s),\n                function(e) {\n                    if (n && r) {\n                        var t = n.options,\n                        i = dt(n.postList.el, e.response[r], t);\n                        t.order == \"asc\" == (t.formPosition == \"top\") && w.scrollTo(i);\n                        var s = n.el.find(\".ds-comments-tab-\" + r + \" span.ds-highlight\");\n                        s.html(parseInt(s.html()) + 1)\n                    }\n                }), i.close(), !1)\n            });\n            return s.find(\".ds-actions [type=checkbox]\").change(function(e) {\n                var t = this.value;\n                if (this.checked && !rt.data.social_uid[t == \"qqt\" ? \"qq\": t]) {\n                    mt(t);\n                    return\n                }\n            }),\n            B(s.find(\"textarea\")).keyup(g).keyup(y).focus(),\n            !1\n        },\n        J.toolbar = function(e) {\n            var t = J.logoutUrl();\n            return '<div class=\"ds-toolbar\"><div class=\"ds-account-control\"><span class=\"ds-icon ds-icon-settings\"></span> <span>\\u5e10\\u53f7\\u7ba1\\u7406</span><ul><li><a class=\"ds-bind-more\" href=\"javascript:void(0);\" style=\"border-top: none\" target=\"_blank\" rel=\"noopener\">\\u7ed1\\u5b9a\\u66f4\\u591a</a></li><li><a target=\"_blank\" href=\"' + w.REMOTE + \" settings \" + w(x()) '\">' + p(k.settings) + \"</a></li>\" + '<li><a rel=\"nofollow\" href=\"' + t + '\" style=\"border-bottom: none\">\\u767b\\u51fa</a></li>' + \"</ul>\" + \"</div>\" + '<div class=\"ds-visitor\">' + (rt.data.url ? '<a class=\"ds-visitor-name\" href=\"' + p(rt.data.url) + '\" target=\"_blank\">' + p(rt.data.name) + \"</a>\": '<span class=\"ds-visitor-name\">' + p(rt.data.name) + \"</span>\") + '<a class=\"ds-unread-comments-count\" href=\"javascript:void(0);\" title=\"\\u65b0\\u56de\\u590d\" target=\"_blank\" rel=\"noopener\"></a>' + \"</div>\" + \"</div>\"\n        },\n        H.EmbedThread = R.extend({\n            uri: \"/api/threads/listPosts\",\n            params: \"thread-id local-thread-id source-thread-id thread-key category channel-key author-key author-id url limit order max-depth form-position container-url\" + (f.match(/MSIE 6\\.0/) ? \"\": \" title image thumbnail\"),\n            render: function() {\n                var e = this.el.attr(\"id\", \"ds-thread\").append(J.waitingImg()),\n                t = e.width(),\n                n = e.data(\"url\") || !e.attr(\"data-thread-id\") && i(\"link[rel=canonical]\").attr(\"href\");\n                n ? e.data(\"url\", d(n)) : e.data(\"container-url\", r.href),\n                t && t <= 400 && e.addclass(\"ds-narrow\").data(\"max-depth\", 1) }, updatecounter: function(e) { var t=\"{\" duoshuo: [\"comments\", \"\\u8bc4\\u8bba\"], repost: [\"reposts\", \"\\u8f6c\\u8f7d\"], weibo: [\"weibo_reposts\", \"\\u65b0\\u6d6a\\u5fae\\u535a\"], qqt: [\"qqt_reposts\", \"\\u817e\\u8baf\\u5fae\\u535a\"] }; for (var n in t) if (!e || e=\"=\" n) r=\"this.data[t[n][0]];\" this.el.find(\".ds-comments-tab-\" + n).html(this.el.hasclass(\"ds-narrow\") ? '<span class=\"ds-service-icon ds-' + n + '\">' + r: (r ? '<span class=\"ds-highlight\">' + r + \"</span>\\u6761\": \"\") + t[n][1])\n                }\n            },\n            onError: function(e) {\n                this.el.html(\"\\u8bc4\\u8bba\\u6846\\u51fa\\u9519\\u5566(\" + e.code + \"): \" + e.errorMessage)\n            },\n            onload: function(t) {\n                var r = this,\n                s = r.threadId = t.thread.thread_id,\n                u = t.cursor,\n                a = r.options = t.options,\n                f = r.innerEl = _(i('<div id=\"ds-reset\"></div>').appendTo(r.el));\n                r.data = t.thread,\n                at(ot, t.parentPosts || t.relatedPosts),\n                at(ut, t.users),\n                r.el.find(\"#ds-waiting\").remove(),\n                a.like_thread_enabled && (r.meta = new H.Meta(r), r.meta.render().el.appendTo(f)),\n                a.hot_posts && t.hotPosts && t.hotPosts.length && (r.hotPosts = new H.HotPosts(i('<div class=\"ds-rounded\"></div>'), {\n                    max_depth: 1,\n                    show_context: a.show_context\n                }), r.hotPosts.thread = r, r.hotPosts.el.appendTo(f), r.hotPosts.onload({\n                    response: t.hotPosts,\n                    options: {}\n                })),\n                r.postListHead = new H.PostListHead(r),\n                r.postList = new P.PostList({\n                    embedThread: r,\n                    params: {\n                        source: \"duoshuo\",\n                        thread_id: s,\n                        max_depth: a.max_depth,\n                        order: a.order,\n                        limit: a.limit\n                    }\n                }),\n                r.postList.render().reset(t.response),\n                r.paginator = new H.Paginator({\n                    collection: r.postList\n                }),\n                r.paginator.reset(u);\n                var l = r.replybox = new H.Replybox(r),\n                c = l.render().el.find(\"textarea\");\n                l.postList = r.postList.el;\n                if (o) {\n                    var h = \"ds_draft_\" + s;\n                    c.bind(\"focus blur keyup\",\n                    function(e) {\n                        var t = i(e.currentTarget).val();\n                        try {\n                            o[h] = t\n                        } catch(e) {}\n                    }),\n                    o[h] && c.val(o[h])\n                }\n                if (ct()) {\n                    var p = i(J.loginButtons()).delegate(\"a.ds-more-services\", \"click\",\n                    function() {\n                        return p.find(\".ds-additional-services\").toggle(),\n                        !1\n                    });\n                    M(p)\n                } else r.toolbar = i(J.toolbar()).delegate(\".ds-account-control\", \"mouseenter\",\n                function() {\n                    i(this).addClass(\"ds-active\")\n                }).delegate(\".ds-account-control\", \"mouseleave\",\n                function() {\n                    i(this).removeClass(\"ds-active\")\n                }).delegate(\"a.ds-bind-more\", \"click\",\n                function() {\n                    var e = j(\"<h2>\\u7ed1\\u5b9a\\u66f4\\u591a\\u5e10\\u53f7</h2>\" + J.serviceList(1) + J.additionalServices(1) + '<div style=\"clear:both\"></div>').el.find(\".ds-dialog\").addClass(\"ds-dialog-bind-more\").css(\"width\", \"300px\");\n                    return M(e),\n                    !1\n                }).delegate(\"a.ds-unread-comments-count\", \"click\",\n                function(e) {\n                    return U(\"unread-comments\"),\n                    !1\n                });\n                r.postListHead.render().el.appendTo(f)[a.formPosition == \"top\" ? \"before\": \"after\"]('<a name=\"respond\"></a>', r.toolbar || p, l.el).after(r.postList.el, r.paginator.el),\n                r.updateCounter(),\n                t.alerts && i.each(t.alerts,\n                function(e, t) {\n                    i('<div class=\"ds-alert\">' + t + \"</div>\").insertBefore(r.toolbar || p)\n                }),\n                a.message && c.val(a.message).focus(),\n                i(J.poweredBy(a.poweredby_text)).appendTo(f),\n                it.on(\"reset\",\n                function() {\n                    var e = it.data.comments || 0;\n                    f.find(\"a.ds-unread-comments-count\").html(e).attr(\"title\", e ? \"\\u4f60\\u6709\" + e + \"\\u6761\\u65b0\\u56de\\u590d\": \"\\u4f60\\u6ca1\\u6709\\u65b0\\u56de\\u590d\").css(\"display\", e ? \"inline\": \"none\")\n                }),\n                a.mzadx_id && (w.require(\"mzadxN\",\n                function() {}), i('<div id=\"MZADX_' + a.mzadx_id + '\" style=\"margin:0 auto;\"></div>').appendTo(f), __mz_rpq = e.__mz_rpq || [], __mz_rpq.push({\n                    l: [a.mzadx_id],\n                    r: \"1\",\n                    _srv: \"MZADX\",\n                    _callback: function(e, t) {}\n                })),\n                w.thread = r,\n                it.data !== n && it.trigger(\"reset\"),\n                ct() || D({\n                    visit_thread_id: r.threadId\n                })\n            },\n            onMessage: function(e) {\n                dt(this.postList.el, e, this.options)\n            }\n        }),\n        J.hotPosts = function(e, t) {\n            return '<div class=\"ds-header ds-gradient-bg\">' + k.hot_posts_title + \"</div><ul>\" + i.map(e,\n            function(e) {\n                return ot[e] ? J.post(ot[e].data, t) : \"\"\n            }).join(\"\") + \"</ul>\"\n        },\n        H.HotPosts = R.extend({\n            params: \"show-quote\",\n            tmpl: \"hotPosts\",\n            render: function() {\n                return this.el.attr(\"id\", \"ds-hot-posts\"),\n                this\n            },\n            onload: function(e) {\n                R.prototype.onload.call(this, e),\n                vt.call(this.el.find(\"ul\"), this.thread, this.options)\n            }\n        }),\n        J.commentList = function(e, t) {\n            return i.map(e,\n            function(e) {\n                var n = K(e);\n                return '<li class=\"ds-comment' + (t.show_avatars ? \" ds-show-avatars\": \"\") + '\" data-post-id=\"' + e.post_id + '\">' + (t.show_avatars ? '<div class=\"ds-avatar\">' + J.avatar(n, t.avatar_size) + \"</div>\": \"\") + '<div class=\"ds-meta\">' + J.userAnchor(n) + (t.show_time ? J.timeHtml(e.created_at) : \"\") + \"</div>\" + (t.show_title ? '<div class=\"ds-thread-title\">\\u5728 <a href=\"' + p(e.thread.url + \" #comments\") + '\">' + p(e.thread.title) + '</a> \\u4e2d\\u8bc4\\u8bba</div><div class=\"ds-excerpt\">' + e.message + \"</div>\": '<a class=\"ds-excerpt\" title=\"' + p(e.thread.title) + ' \\u4e2d\\u7684\\u8bc4\\u8bba\" href=\"' + p(e.thread.url + \" #comments\") + '\">' + e.message + \"</a>\") + \"</li>\"\n            }).join(\"\")\n        },\n        H.RecentComments = R.extend({\n            uri: \"/api/sites/listRecentPosts\",\n            params: \"show-avatars show-time show-title avatar-size show-admin excerpt-length num-items channel-key\",\n            tmpl: \"commentList\",\n            render: function() {\n                this.el.attr(\"id\", \"ds-recent-comments\")\n            }\n        }),\n        J.recentVisitors = function(e, t) {\n            return i.map(e,\n            function(e) {\n                return '<div class=\"ds-avatar\">' + J.avatar(e, t.avatar_size) + \"</div>\"\n            }).join(\"\")\n        },\n        H.RecentVisitors = R.extend({\n            uri: \"/api/sites/listVisitors\",\n            params: \"show-time avatar-size num-items channel-key\",\n            tmpl: \"recentVisitors\",\n            render: function() {\n                this.el.children().detach(),\n                this.el.attr(\"id\", \"ds-recent-visitors\").append(this.waitingEl = i(J.waitingImg()))\n            }\n        }),\n        J.topUsers = function(e, t) {\n            return i.map(e,\n            function(e) {\n                return '<div class=\"ds-avatar\">' + J.avatar(e, t.avatar_size) + \"<h4>\" + e.name + \"</h4>\" + \"</div>\"\n            }).join(\"\")\n        },\n        H.TopUsers = R.extend({\n            uri: \"/api/sites/listTopUsers\",\n            params: \"show-time avatar-size num-items channel-key\",\n            tmpl: \"topUsers\",\n            render: function() {\n                this.el.children().detach(),\n                this.el.attr(\"id\", \"ds-top-users\").append(this.waitingEl = i(J.waitingImg()))\n            }\n        }),\n        J.topThreads = function(e, t) {\n            return i.map(e,\n            function(e) {\n                return '<li><a target=\"_blank\" href=\"' + p(e.url) + '\" title=\"' + e.title + '\">' + e.title + \"</a>\" + \"</li>\"\n            }).join(\"\")\n        },\n        H.TopThreads = R.extend({\n            uri: \"/api/sites/listTopThreads\",\n            params: \"range num-items channel-key\",\n            tmpl: \"topThreads\",\n            render: function() {\n                this.el.children().detach(),\n                this.el.attr(\"id\", \"ds-top-threads\").append(this.waitingEl = i(J.waitingImg()))\n            }\n        }),\n        J.loginWidget = function() {\n            var e = '<div class=\"ds-icons-32\">';\n            return i.each([\"weibo\", \"qq\", \"renren\", \"kaixin\", \"douban\", \"netease\", \"sohu\"],\n            function(t, n) {\n                e += '<a class=\"ds-' + n + '\" href=\"' + J.loginUrl(n) + '\">' + w.sourceName[n] + \"</a>\"\n            }),\n            e + \"</div>\"\n        },\n        H.LoginWidget = R.extend({\n            tmpl: \"loginWidget\",\n            render: function() {\n                var e = this.el;\n                e.attr(\"id\", \"ds-login\").html(J.loginWidget()),\n                M(e, \"a\"),\n                e.find(\"a.ds-logout\").attr(\"href\", J.logoutUrl())\n            }\n        }),\n        H.ThreadCount = R.extend({\n            onload: function(e) {\n                var t = this.el,\n                n = t.data(\"count-type\") || \"comments\",\n                r = e.data[n];\n                t[t.data(\"replace\") ? \"replaceWith\": \"html\"](k[n + \"_\" + (r ? r > 1 ? \"multiple\": \"one\": \"zero\")].replace(\"{num}\", r))\n            }\n        });\n        var yt = 0;\n        w.initSelector = function(e, t) {\n            var n = [];\n            V() && (i.isReady || !E) && i(e).each(function(e, r) {\n                var s = i(r);\n                if (s.data(\"initialized\")) return;\n                s.data(\"initialized\", !0);\n                var o = new H[t.type](s, t);\n                C.push(o);\n                if (t.type === \"ThreadCount\") {\n                    var u = s.attr(\"data-thread-key\");\n                    s.attr(\"data-channel-key\") && (u = s.attr(\"data-channel-key\") + \":\" + u),\n                    n.push(u),\n                    st[u] || (st[u] = new et({})),\n                    st[u].on(\"reset\",\n                    function() {\n                        o.onload(this)\n                    })\n                } else if (o.uri) {\n                    var a = {};\n                    i.each(o.params.split(\" \"),\n                    function(e, t) {\n                        a[t.replace(/-/g, \"_\")] = s.attr(\"data-\" + t) || s.data(t)\n                    }),\n                    L(o.uri, bt(a),\n                    function(e) {\n                        o.load(e)\n                    })\n                }\n            }),\n            n.length && L(\"/api/threads/counts\", bt({\n                threads: n.join(\",\")\n            }),\n            function(e) {\n                l(e),\n                ft(k, e.options),\n                at(st, e.response)\n            })\n        },\n        (w.initView = function() {\n            i.each(N, w.initSelector)\n        })(),\n        i(function() {\n            if (!V()) return I(\"\\u7f3a\\u5c11duoshuoQuery\\u7684\\u5b9a\\u4e49\");\n            setInterval(function() {\n                i(\".ds-time\").each(function() {\n                    var e = i(this).attr(\"datetime\");\n                    e && (this.innerHTML = w.elapsedTime(e))\n                })\n            },\n            2e4),\n            z.ondomready && z.ondomready(),\n            w.initView(),\n            !yt && z.short_name && L(\"/api/analytics/ping\", bt({}), l)\n        })\n    })\n})(window, document);\n</=></=></=></\":>","categories":[],"tags":[]}]